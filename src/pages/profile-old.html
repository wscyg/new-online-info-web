<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ªäººä¸­å¿ƒ - AIæœªæ¥å­¦é™¢</title>
    <meta name="description" content="ç®¡ç†æ‚¨çš„å­¦ä¹ è¿›åº¦ï¼ŒæŸ¥çœ‹æˆå°±å’Œæ•°æ®åˆ†æ">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #667eea;
            --primary-light: #764ba2;
            --secondary-color: #f093fb;
            --accent-color: #4facfe;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-bg: #0f0f23;
            --dark-surface: #16213e;
            --dark-card: #1a2332;
            --dark-border: #2d3748;
            --text-primary: #ffffff;
            --text-secondary: #a0aec0;
            --text-muted: #718096;
            --gradient-primary: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            --gradient-secondary: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            --gradient-success: linear-gradient(135deg, #10b981, #059669);
            --gradient-warning: linear-gradient(135deg, #f59e0b, #d97706);
            --box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            --box-shadow-hover: 0 20px 60px rgba(0, 0, 0, 0.15);
            --border-radius: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Background Effects */
        .profile-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(135deg, #0f0f23 0%, #16213e 100%);
        }

        .gradient-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.6;
            animation: float 8s ease-in-out infinite;
        }

        .orb-1 {
            width: 300px;
            height: 300px;
            background: var(--gradient-primary);
            top: 10%;
            right: 10%;
            animation-delay: 0s;
        }

        .orb-2 {
            width: 200px;
            height: 200px;
            background: var(--gradient-secondary);
            bottom: 20%;
            left: 15%;
            animation-delay: 2s;
        }

        .orb-3 {
            width: 150px;
            height: 150px;
            background: var(--gradient-success);
            top: 50%;
            left: 50%;
            animation-delay: 4s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -30px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
        }

        /* Navigation */
        .profile-nav {
            background: rgba(22, 33, 62, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--dark-border);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 0;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
        }

        .nav-brand .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            position: relative;
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--text-primary);
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -0.5rem;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--gradient-primary);
            border-radius: 1px;
        }

        .nav-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn-logout {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-logout:hover {
            transform: translateY(-1px);
            box-shadow: var(--box-shadow);
        }

        /* Main Content */
        .profile-main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Profile Header */
        .profile-header {
            background: var(--dark-card);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--dark-border);
            position: relative;
            overflow: hidden;
        }

        .profile-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: var(--gradient-primary);
            opacity: 0.1;
        }

        .profile-info {
            display: flex;
            gap: 2rem;
            align-items: center;
            position: relative;
        }

        .avatar-wrapper {
            position: relative;
        }

        .user-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.1);
            object-fit: cover;
        }

        .avatar-status {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--success-color);
            border: 3px solid var(--dark-card);
        }

        .user-details h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .user-title {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .user-stats {
            display: flex;
            gap: 2rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            display: block;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .profile-actions {
            margin-left: auto;
            display: flex;
            gap: 1rem;
        }

        .btn-edit-profile,
        .btn-share-profile {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            color: var(--text-primary);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-edit-profile:hover,
        .btn-share-profile:hover {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        /* Tabs */
        .profile-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: var(--dark-card);
            padding: 0.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--dark-border);
            overflow-x: auto;
        }

        .tab-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 1rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            font-weight: 500;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .tab-btn.active {
            background: var(--gradient-primary);
            color: white;
        }

        /* Content Panels */
        .profile-content {
            background: var(--dark-card);
            border-radius: var(--border-radius);
            border: 1px solid var(--dark-border);
            min-height: 600px;
        }

        .content-panel {
            display: none;
            padding: 2rem;
            animation: fadeIn 0.3s ease-in-out;
        }

        .content-panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Overview Panel */
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .overview-card {
            background: var(--dark-surface);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--dark-border);
            transition: var(--transition);
        }

        .overview-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--box-shadow);
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        /* Form Styles */
        .info-form {
            max-width: 800px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group textarea {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 8px;
            padding: 0.75rem;
            color: var(--text-primary);
            transition: var(--transition);
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group input[readonly] {
            background: rgba(255, 255, 255, 0.02);
            cursor: not-allowed;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn-save,
        .btn-cancel {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-save {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-cancel {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            color: var(--text-primary);
        }

        /* Orders */
        .orders-filter {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .filter-btn {
            background: none;
            border: 1px solid var(--dark-border);
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-btn.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        .order-item {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: var(--transition);
        }

        .order-item:hover {
            border-color: var(--primary-color);
        }

        .order-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .order-info {
            flex: 1;
        }

        .order-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .status-paid {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success-color);
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning-color);
        }

        /* Achievements */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .achievement-card {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .achievement-card.unlocked {
            border-color: var(--success-color);
        }

        .achievement-card.unlocked::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-success);
        }

        .achievement-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            filter: grayscale(100%);
        }

        .achievement-card.unlocked .achievement-icon {
            filter: none;
        }

        .achievement-info h4 {
            margin-bottom: 0.5rem;
        }

        /* Skills */
        .skills-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .skill-item {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .skill-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .skill-progress {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: var(--dark-border);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            transition: width 1s ease-in-out;
        }

        .skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag {
            background: rgba(102, 126, 234, 0.2);
            color: var(--primary-color);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
        }

        /* Settings */
        .settings-section {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 2rem;
        }

        .settings-sidebar {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .setting-nav-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            text-align: left;
        }

        .setting-nav-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
        }

        .setting-nav-btn.active {
            background: var(--gradient-primary);
            color: white;
        }

        .setting-panel {
            display: none;
        }

        .setting-panel.active {
            display: block;
        }

        /* Loading and Empty States */
        .loading-state,
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--dark-border);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-container {
                padding: 0 1rem;
            }

            .profile-main {
                padding: 1rem;
            }

            .profile-info {
                flex-direction: column;
                text-align: center;
            }

            .user-stats {
                justify-content: center;
            }

            .profile-actions {
                margin-left: 0;
                justify-content: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .overview-grid {
                grid-template-columns: 1fr;
            }

            .settings-section {
                grid-template-columns: 1fr;
            }

            .skills-section {
                grid-template-columns: 1fr;
            }
        }

        /* Utilities */
        .text-center { text-align: center; }
        .mb-2 { margin-bottom: 1rem; }
        .mt-2 { margin-top: 1rem; }
        .hidden { display: none !important; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 1rem; }
    </style>
</head>
<body>
    <!-- Background Effects -->
    <div class="profile-bg">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <!-- Navigation -->
    <nav class="profile-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <div class="logo">AIæœªæ¥å­¦é™¢</div>
            </div>
            <div class="nav-menu">
                <a href="/home.html" class="nav-link">é¦–é¡µ</a>
                <a href="/src/pages/courses.html" class="nav-link">è¯¾ç¨‹</a>
                <a href="/src/pages/dashboard.html" class="nav-link">å­¦ä¹ ä¸­å¿ƒ</a>
                <a href="/src/pages/profile.html" class="nav-link active">ä¸ªäººä¸­å¿ƒ</a>
            </div>
            <div class="nav-actions">
                <button class="btn-logout" onclick="handleLogout()">é€€å‡ºç™»å½•</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="profile-main">
        <!-- Profile Header -->
        <section class="profile-header">
            <div class="profile-info">
                <div class="avatar-wrapper">
                    <img src="/assets/avatar-default.svg" alt="ç”¨æˆ·å¤´åƒ" class="user-avatar" id="userAvatar">
                    <div class="avatar-status"></div>
                </div>
                <div class="user-details">
                    <h1 class="user-name" id="profileName">åŠ è½½ä¸­...</h1>
                    <p class="user-title" id="profileTitle">AIå­¦ä¹ è€…</p>
                    <div class="user-stats">
                        <div class="stat-item">
                            <span class="stat-value" id="studyDays">0</span>
                            <span class="stat-label">å­¦ä¹ å¤©æ•°</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="completedCourses">0</span>
                            <span class="stat-label">å®Œæˆè¯¾ç¨‹</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="avgRating">0.0</span>
                            <span class="stat-label">å¹³å‡è¯„åˆ†</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="certificates">0</span>
                            <span class="stat-label">è·å¾—è¯ä¹¦</span>
                        </div>
                    </div>
                </div>
                <div class="profile-actions">
                    <button class="btn-edit-profile" onclick="switchTab('personal-info')">
                        <span>âœï¸</span>
                        <span>ç¼–è¾‘èµ„æ–™</span>
                    </button>
                    <button class="btn-share-profile">
                        <span>ğŸ”—</span>
                        <span>åˆ†äº«ä¸»é¡µ</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Tabs Navigation -->
        <div class="profile-tabs">
            <button class="tab-btn active" data-tab="overview" onclick="switchTab('overview')">
                <span>ğŸ“Š</span>
                <span>å­¦ä¹ æ¦‚è§ˆ</span>
            </button>
            <button class="tab-btn" data-tab="personal-info" onclick="switchTab('personal-info')">
                <span>ğŸ‘¤</span>
                <span>ä¸ªäººä¿¡æ¯</span>
            </button>
            <button class="tab-btn" data-tab="orders" onclick="switchTab('orders')">
                <span>ğŸ“¦</span>
                <span>æˆ‘çš„è®¢å•</span>
            </button>
            <button class="tab-btn" data-tab="achievements" onclick="switchTab('achievements')">
                <span>ğŸ†</span>
                <span>æˆå°±å‹‹ç« </span>
            </button>
            <button class="tab-btn" data-tab="certificates" onclick="switchTab('certificates')">
                <span>ğŸ“œ</span>
                <span>è¯ä¹¦ç®¡ç†</span>
            </button>
            <button class="tab-btn" data-tab="skills" onclick="switchTab('skills')">
                <span>ğŸ’¡</span>
                <span>æŠ€èƒ½å›¾è°±</span>
            </button>
            <button class="tab-btn" data-tab="settings" onclick="switchTab('settings')">
                <span>âš™ï¸</span>
                <span>è´¦å·è®¾ç½®</span>
            </button>
        </div>

        <!-- Tab Content -->
        <div class="profile-content">
            <!-- Overview Panel -->
            <div class="content-panel active" id="overviewPanel">
                <div class="overview-grid">
                    <!-- Weekly Progress -->
                    <div class="overview-card">
                        <h3 class="card-title">æœ¬å‘¨å­¦ä¹ è¿›åº¦</h3>
                        <div id="weeklyProgressContent">
                            <div class="loading-state">
                                <div class="loading-spinner"></div>
                                <span>æ­£åœ¨åŠ è½½æ•°æ®...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Learning Paths -->
                    <div class="overview-card">
                        <h3 class="card-title">æˆ‘çš„å­¦ä¹ è·¯å¾„</h3>
                        <div id="learningPathsContent">
                            <div class="loading-state">
                                <div class="loading-spinner"></div>
                                <span>æ­£åœ¨åŠ è½½æ•°æ®...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Courses -->
                    <div class="overview-card">
                        <h3 class="card-title">æœ€è¿‘å­¦ä¹ </h3>
                        <div id="recentCoursesContent">
                            <div class="loading-state">
                                <div class="loading-spinner"></div>
                                <span>æ­£åœ¨åŠ è½½æ•°æ®...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Learning Calendar -->
                    <div class="overview-card" style="grid-column: 1 / -1;">
                        <h3 class="card-title">å­¦ä¹ æ—¥å†</h3>
                        <div id="learningCalendarContent">
                            <div class="loading-state">
                                <div class="loading-spinner"></div>
                                <span>æ­£åœ¨åŠ è½½æ•°æ®...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Personal Info Panel -->
            <div class="content-panel" id="personalInfoPanel">
                <div class="flex items-center justify-between mb-2">
                    <h3>ä¸ªäººèµ„æ–™</h3>
                    <button class="btn-edit-profile" onclick="toggleEditMode()" id="editToggleBtn">
                        <span id="editToggleText">ç¼–è¾‘</span>
                    </button>
                </div>

                <div class="info-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="displayName">æ˜¾ç¤ºåç§°</label>
                            <input type="text" id="displayName" readonly>
                        </div>
                        <div class="form-group">
                            <label for="username">ç”¨æˆ·å</label>
                            <input type="text" id="username" readonly>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">é‚®ç®±åœ°å€</label>
                            <input type="email" id="email" readonly>
                        </div>
                        <div class="form-group">
                            <label for="phone">æ‰‹æœºå·ç </label>
                            <input type="tel" id="phone" readonly>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">æ‰€åœ¨åŸå¸‚</label>
                            <input type="text" id="city" readonly>
                        </div>
                        <div class="form-group">
                            <label for="birthday">ç”Ÿæ—¥</label>
                            <input type="date" id="birthday" readonly>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="bio">ä¸ªäººç®€ä»‹</label>
                        <textarea id="bio" rows="3" readonly placeholder="ä»‹ç»ä¸€ä¸‹è‡ªå·±å§"></textarea>
                    </div>
                    
                    <div class="form-actions hidden" id="formActions">
                        <button class="btn-save" onclick="savePersonalInfo()">ä¿å­˜</button>
                        <button class="btn-cancel" onclick="cancelEdit()">å–æ¶ˆ</button>
                    </div>
                </div>

                <div class="user-stats mt-2">
                    <div class="stat-item">
                        <span class="stat-label">æ³¨å†Œæ—¶é—´</span>
                        <span class="stat-value" id="registrationDate">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">æœ€åç™»å½•</span>
                        <span class="stat-value" id="lastLoginDate">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">å­¦ä¹ æ€»æ—¶é•¿</span>
                        <span class="stat-value" id="totalStudyHours">0å°æ—¶</span>
                    </div>
                </div>
            </div>

            <!-- Orders Panel -->
            <div class="content-panel" id="ordersPanel">
                <div class="flex items-center justify-between mb-2">
                    <h3>æˆ‘çš„è®¢å•</h3>
                    <div class="orders-filter">
                        <button class="filter-btn active" data-status="all" onclick="filterOrders('all')">å…¨éƒ¨</button>
                        <button class="filter-btn" data-status="paid" onclick="filterOrders('paid')">å·²æ”¯ä»˜</button>
                        <button class="filter-btn" data-status="pending" onclick="filterOrders('pending')">å¾…æ”¯ä»˜</button>
                        <button class="filter-btn" data-status="completed" onclick="filterOrders('completed')">å·²å®Œæˆ</button>
                        <button class="filter-btn" data-status="refunded" onclick="filterOrders('refunded')">å·²é€€æ¬¾</button>
                    </div>
                </div>
                
                <div id="ordersList">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <span>æ­£åœ¨åŠ è½½è®¢å•æ•°æ®...</span>
                    </div>
                </div>
            </div>

            <!-- Achievements Panel -->
            <div class="content-panel" id="achievementsPanel">
                <h3 class="mb-2">æˆå°±å‹‹ç« </h3>
                <div id="achievementsContent">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <span>æ­£åœ¨åŠ è½½æˆå°±æ•°æ®...</span>
                    </div>
                </div>
            </div>

            <!-- Certificates Panel -->
            <div class="content-panel" id="certificatesPanel">
                <div class="flex items-center justify-between mb-2">
                    <h3>æˆ‘çš„è¯ä¹¦</h3>
                    <button class="btn-edit-profile">æ‰¹é‡ä¸‹è½½</button>
                </div>
                <div id="certificatesContent">
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <span>æ­£åœ¨åŠ è½½è¯ä¹¦æ•°æ®...</span>
                    </div>
                </div>
            </div>

            <!-- Skills Panel -->
            <div class="content-panel" id="skillsPanel">
                <h3 class="mb-2">æŠ€èƒ½å›¾è°±</h3>
                <div class="skills-section">
                    <div>
                        <h4 class="mb-2">æŠ€èƒ½é›·è¾¾å›¾</h4>
                        <div id="skillsRadarContainer">
                            <canvas id="skillsRadar" width="400" height="400"></canvas>
                        </div>
                    </div>
                    <div>
                        <h4 class="mb-2">æŠ€èƒ½è¯¦æƒ…</h4>
                        <div id="skillsListContent">
                            <div class="loading-state">
                                <div class="loading-spinner"></div>
                                <span>æ­£åœ¨åŠ è½½æŠ€èƒ½æ•°æ®...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Panel -->
            <div class="content-panel" id="settingsPanel">
                <div class="settings-section">
                    <div class="settings-sidebar">
                        <button class="setting-nav-btn active" onclick="showSettingSection('basic')">åŸºæœ¬ä¿¡æ¯</button>
                        <button class="setting-nav-btn" onclick="showSettingSection('security')">è´¦å·å®‰å…¨</button>
                        <button class="setting-nav-btn" onclick="showSettingSection('privacy')">éšç§è®¾ç½®</button>
                        <button class="setting-nav-btn" onclick="showSettingSection('notifications')">é€šçŸ¥è®¾ç½®</button>
                        <button class="setting-nav-btn" onclick="showSettingSection('preferences')">å­¦ä¹ åå¥½</button>
                    </div>
                    <div class="settings-content">
                        <div class="setting-panel active" id="basicSettingsPanel">
                            <h3 class="mb-2">åŸºæœ¬ä¿¡æ¯è®¾ç½®</h3>
                            <div class="info-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="settingsUsername">ç”¨æˆ·å</label>
                                        <input type="text" id="settingsUsername">
                                    </div>
                                    <div class="form-group">
                                        <label for="settingsDisplayName">æ˜¾ç¤ºæ˜µç§°</label>
                                        <input type="text" id="settingsDisplayName">
                                    </div>
                                </div>
                                <div class="form-group full-width">
                                    <label for="settingsBio">ä¸ªäººç®€ä»‹</label>
                                    <textarea id="settingsBio" rows="3"></textarea>
                                </div>
                                <div class="form-actions">
                                    <button class="btn-save" onclick="saveSettings('basic')">ä¿å­˜è®¾ç½®</button>
                                    <button class="btn-cancel" onclick="resetSettings('basic')">é‡ç½®</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="setting-panel" id="securitySettingsPanel">
                            <h3 class="mb-2">è´¦å·å®‰å…¨</h3>
                            <div class="info-form">
                                <div class="form-group">
                                    <label for="currentPassword">å½“å‰å¯†ç </label>
                                    <input type="password" id="currentPassword">
                                </div>
                                <div class="form-group">
                                    <label for="newPassword">æ–°å¯†ç </label>
                                    <input type="password" id="newPassword">
                                </div>
                                <div class="form-group">
                                    <label for="confirmPassword">ç¡®è®¤æ–°å¯†ç </label>
                                    <input type="password" id="confirmPassword">
                                </div>
                                <div class="form-actions">
                                    <button class="btn-save" onclick="changePassword()">ä¿®æ”¹å¯†ç </button>
                                    <button class="btn-cancel" onclick="resetPasswordForm()">é‡ç½®</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script type="module" src="../utils/api.js"></script>
    <script>
        // Global state
        let profileData = null;
        let isEditMode = false;
        let originalFormData = {};

        // Initialize page
        document.addEventListener('DOMContentLoaded', async () => {
            await checkAuth();
            await loadProfile();
            initializeTabs();
        });

        // Authentication check
        async function checkAuth() {
            const token = localStorage.getItem('token');
            if (!token) {
                window.location.href = '/src/pages/login.html?returnUrl=profile.html';
                return;
            }
        }

        // Load profile data
        async function loadProfile() {
            try {
                const response = await window.API.user.getProfile();
                if (response.success && response.data) {
                    profileData = response.data;
                    updateProfileDisplay();
                    loadTabContent('overview');
                }
            } catch (error) {
                console.error('Failed to load profile:', error);
                showNotification('åŠ è½½ç”¨æˆ·èµ„æ–™å¤±è´¥', 'error');
            }
        }

        // Update profile display
        function updateProfileDisplay() {
            if (!profileData) return;

            document.getElementById('profileName').textContent = profileData.displayName || profileData.username || 'ç”¨æˆ·';
            document.getElementById('profileTitle').textContent = profileData.bio || 'AIå­¦ä¹ è€…';
            
            // Update stats
            document.getElementById('studyDays').textContent = profileData.stats?.studyDays || 0;
            document.getElementById('completedCourses').textContent = profileData.stats?.completedCourses || 0;
            document.getElementById('avgRating').textContent = (profileData.stats?.avgRating || 0).toFixed(1);
            document.getElementById('certificates').textContent = profileData.stats?.certificates || 0;

            // Update personal info form
            document.getElementById('displayName').value = profileData.displayName || '';
            document.getElementById('username').value = profileData.username || '';
            document.getElementById('email').value = profileData.email || '';
            document.getElementById('phone').value = profileData.phone || '';
            document.getElementById('city').value = profileData.city || '';
            document.getElementById('birthday').value = profileData.birthday || '';
            document.getElementById('bio').value = profileData.bio || '';

            // Update account stats
            if (profileData.registrationDate) {
                document.getElementById('registrationDate').textContent = 
                    new Date(profileData.registrationDate).toLocaleDateString();
            }
            if (profileData.lastLoginDate) {
                document.getElementById('lastLoginDate').textContent = 
                    new Date(profileData.lastLoginDate).toLocaleDateString();
            }
            document.getElementById('totalStudyHours').textContent = 
                `${profileData.stats?.totalStudyHours || 0}å°æ—¶`;
        }

        // Tab switching
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Update content panels
            document.querySelectorAll('.content-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.getElementById(`${tabName}Panel`).classList.add('active');

            // Load tab content
            loadTabContent(tabName);
        }

        // Load tab-specific content
        async function loadTabContent(tabName) {
            switch (tabName) {
                case 'overview':
                    await loadOverviewData();
                    break;
                case 'orders':
                    await loadOrders();
                    break;
                case 'achievements':
                    await loadAchievements();
                    break;
                case 'certificates':
                    await loadCertificates();
                    break;
                case 'skills':
                    await loadSkills();
                    break;
            }
        }

        // Load overview data
        async function loadOverviewData() {
            try {
                const [weeklyProgress, learningPaths, recentCourses, calendar] = await Promise.all([
                    window.API.user.getWeeklyProgress(),
                    window.API.user.getLearningPaths(),
                    window.API.user.getRecentCourses(),
                    window.API.user.getLearningCalendar(new Date().getFullYear(), new Date().getMonth() + 1)
                ]);

                renderWeeklyProgress(weeklyProgress.data);
                renderLearningPaths(learningPaths.data);
                renderRecentCourses(recentCourses.data);
                renderLearningCalendar(calendar.data);
            } catch (error) {
                console.error('Failed to load overview data:', error);
                document.getElementById('weeklyProgressContent').innerHTML = '<div class="empty-state">æš‚æ— æ•°æ®</div>';
                document.getElementById('learningPathsContent').innerHTML = '<div class="empty-state">æš‚æ— æ•°æ®</div>';
                document.getElementById('recentCoursesContent').innerHTML = '<div class="empty-state">æš‚æ— æ•°æ®</div>';
                document.getElementById('learningCalendarContent').innerHTML = '<div class="empty-state">æš‚æ— æ•°æ®</div>';
            }
        }

        // Render weekly progress
        function renderWeeklyProgress(data) {
            const content = document.getElementById('weeklyProgressContent');
            if (!data) {
                content.innerHTML = '<div class="empty-state">æš‚æ— æ•°æ®</div>';
                return;
            }

            content.innerHTML = `
                <div class="progress-stats">
                    <div class="stat-item">
                        <span class="stat-label">æ€»å­¦ä¹ æ—¶é•¿</span>
                        <span class="stat-value">${data.totalHours || 0}å°æ—¶</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">å®Œæˆè¯¾æ—¶</span>
                        <span class="stat-value">${data.completedLessons || 0}èŠ‚</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">æäº¤ä½œä¸š</span>
                        <span class="stat-value">${data.submittedAssignments || 0}ä»½</span>
                    </div>
                </div>
            `;
        }

        // Render learning paths
        function renderLearningPaths(paths) {
            const content = document.getElementById('learningPathsContent');
            if (!paths || paths.length === 0) {
                content.innerHTML = '<div class="empty-state">æš‚æ— å­¦ä¹ è·¯å¾„</div>';
                return;
            }

            content.innerHTML = paths.map(path => `
                <div class="path-item ${path.isActive ? 'active' : ''}">
                    <div class="path-icon">${path.icon || 'ğŸ§ '}</div>
                    <div class="path-info">
                        <h4>${path.name}</h4>
                        <p>å·²å®Œæˆ ${path.progress || 0}%</p>
                        <div class="path-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${path.progress || 0}%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Render recent courses
        function renderRecentCourses(courses) {
            const content = document.getElementById('recentCoursesContent');
            if (!courses || courses.length === 0) {
                content.innerHTML = '<div class="empty-state">æš‚æ— æœ€è¿‘å­¦ä¹ è®°å½•</div>';
                return;
            }

            content.innerHTML = courses.map(course => `
                <div class="course-item">
                    <div class="course-thumb">
                        <div class="thumb-placeholder">${course.shortName || course.name.substring(0, 3)}</div>
                    </div>
                    <div class="course-info">
                        <h4>${course.name}</h4>
                        <p>ä¸Šæ¬¡å­¦ä¹ ï¼š${formatRelativeTime(course.lastStudyTime)}</p>
                        <div class="course-progress">
                            <span>è¿›åº¦ ${course.progress || 0}%</span>
                        </div>
                    </div>
                    <button class="btn-save" onclick="continueCourse(${course.id})">ç»§ç»­å­¦ä¹ </button>
                </div>
            `).join('');
        }

        // Render learning calendar
        function renderLearningCalendar(calendarData) {
            const content = document.getElementById('learningCalendarContent');
            if (!calendarData) {
                content.innerHTML = '<div class="empty-state">æš‚æ— å­¦ä¹ è®°å½•</div>';
                return;
            }

            // Simple calendar implementation
            content.innerHTML = `
                <div class="calendar-placeholder text-center" style="padding: 2rem; color: var(--text-secondary);">
                    ğŸ“… å­¦ä¹ æ—¥å†åŠŸèƒ½å¼€å‘ä¸­...
                    <br><small>æœ¬æœˆå­¦ä¹ å¤©æ•°: ${calendarData.studyDays || 0} å¤©</small>
                </div>
            `;
        }

        // Load orders
        async function loadOrders() {
            try {
                const response = await window.API.user.getOrders();
                renderOrders(response.data || []);
            } catch (error) {
                console.error('Failed to load orders:', error);
                document.getElementById('ordersList').innerHTML = '<div class="empty-state">æš‚æ— è®¢å•è®°å½•</div>';
            }
        }

        // Render orders
        function renderOrders(orders) {
            const content = document.getElementById('ordersList');
            if (!orders || orders.length === 0) {
                content.innerHTML = '<div class="empty-state">æš‚æ— è®¢å•è®°å½•<br><a href="../courses.html" class="btn-save mt-2">å»é€›é€›è¯¾ç¨‹</a></div>';
                return;
            }

            content.innerHTML = orders.map(order => `
                <div class="order-item">
                    <div class="order-header flex items-center justify-between">
                        <div class="order-info">
                            <h4>${order.courseName || order.itemName}</h4>
                            <p>è®¢å•å·: ${order.orderNo}</p>
                            <p>ä¸‹å•æ—¶é—´: ${new Date(order.createTime).toLocaleString()}</p>
                        </div>
                        <div class="order-status status-${order.status}">
                            ${getStatusText(order.status)}
                        </div>
                    </div>
                    <div class="flex items-center justify-between mt-2">
                        <span class="order-price">Â¥${order.amount}</span>
                        ${order.status === 'pending' ? `<button class="btn-save" onclick="payOrder('${order.orderNo}')">ç«‹å³æ”¯ä»˜</button>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Load achievements
        async function loadAchievements() {
            try {
                const response = await window.API.achievement.getUserAchievements();
                renderAchievements(response.data || []);
            } catch (error) {
                console.error('Failed to load achievements:', error);
                document.getElementById('achievementsContent').innerHTML = '<div class="empty-state">æš‚æ— æˆå°±æ•°æ®</div>';
            }
        }

        // Render achievements
        function renderAchievements(achievements) {
            const content = document.getElementById('achievementsContent');
            if (!achievements || achievements.length === 0) {
                content.innerHTML = '<div class="empty-state">æš‚æ— æˆå°±è®°å½•</div>';
                return;
            }

            content.innerHTML = `
                <div class="achievements-grid">
                    ${achievements.map(achievement => `
                        <div class="achievement-card ${achievement.unlocked ? 'unlocked' : 'locked'}">
                            <div class="achievement-icon">${achievement.icon || 'ğŸ†'}</div>
                            <div class="achievement-info">
                                <h4>${achievement.name}</h4>
                                <p>${achievement.description}</p>
                                ${achievement.unlocked ? 
                                    `<span class="unlock-date">${new Date(achievement.unlockedAt).toLocaleDateString()} è§£é”</span>` :
                                    `<span class="unlock-progress">è¿›åº¦: ${achievement.progress || 0}%</span>`
                                }
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Load certificates
        async function loadCertificates() {
            try {
                const response = await window.API.user.getCertificates();
                renderCertificates(response.data || []);
            } catch (error) {
                console.error('Failed to load certificates:', error);
                document.getElementById('certificatesContent').innerHTML = '<div class="empty-state">æš‚æ— è¯ä¹¦è®°å½•</div>';
            }
        }

        // Render certificates
        function renderCertificates(certificates) {
            const content = document.getElementById('certificatesContent');
            if (!certificates || certificates.length === 0) {
                content.innerHTML = '<div class="empty-state">æš‚æ— è¯ä¹¦è®°å½•</div>';
                return;
            }

            content.innerHTML = `
                <div class="achievements-grid">
                    ${certificates.map(cert => `
                        <div class="achievement-card unlocked">
                            <div class="achievement-icon">ğŸ“œ</div>
                            <div class="achievement-info">
                                <h4>${cert.courseName}</h4>
                                <p>è¯ä¹¦ç¼–å·: ${cert.certificateNo}</p>
                                <span class="unlock-date">é¢å‘æ—¥æœŸ: ${new Date(cert.issuedAt).toLocaleDateString()}</span>
                            </div>
                            <div class="flex gap-2 mt-2">
                                <button class="btn-save" onclick="downloadCertificate(${cert.id})">ä¸‹è½½</button>
                                <button class="btn-cancel" onclick="shareCertificate(${cert.id})">åˆ†äº«</button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Load skills
        async function loadSkills() {
            try {
                const response = await window.API.user.getSkills();
                renderSkills(response.data || []);
            } catch (error) {
                console.error('Failed to load skills:', error);
                document.getElementById('skillsListContent').innerHTML = '<div class="empty-state">æš‚æ— æŠ€èƒ½æ•°æ®</div>';
            }
        }

        // Render skills
        function renderSkills(skills) {
            const content = document.getElementById('skillsListContent');
            if (!skills || skills.length === 0) {
                content.innerHTML = '<div class="empty-state">æš‚æ— æŠ€èƒ½æ•°æ®</div>';
                return;
            }

            content.innerHTML = skills.map(skill => `
                <div class="skill-item">
                    <div class="skill-header">
                        <span class="skill-name">${skill.name}</span>
                        <span class="skill-level">${getSkillLevel(skill.score)}</span>
                    </div>
                    <div class="skill-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${skill.score}%;"></div>
                        </div>
                        <span class="skill-score">${skill.score}/100</span>
                    </div>
                    ${skill.tags ? `
                        <div class="skill-tags">
                            ${skill.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    ` : ''}
                </div>
            `).join('');

            // Render radar chart
            renderSkillsRadar(skills);
        }

        // Render skills radar chart
        function renderSkillsRadar(skills) {
            const canvas = document.getElementById('skillsRadar');
            const ctx = canvas.getContext('2d');
            
            // Simple radar chart implementation
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = '#667eea';
            ctx.fillStyle = 'rgba(102, 126, 234, 0.2)';
            ctx.lineWidth = 2;

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 120;

            // Draw background grid
            ctx.strokeStyle = '#2d3748';
            for (let i = 1; i <= 5; i++) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, (radius / 5) * i, 0, 2 * Math.PI);
                ctx.stroke();
            }

            if (skills.length > 0) {
                // Draw skill areas
                ctx.beginPath();
                ctx.strokeStyle = '#667eea';
                ctx.fillStyle = 'rgba(102, 126, 234, 0.2)';

                skills.forEach((skill, index) => {
                    const angle = (2 * Math.PI / skills.length) * index - Math.PI / 2;
                    const value = (skill.score / 100) * radius;
                    const x = centerX + Math.cos(angle) * value;
                    const y = centerY + Math.sin(angle) * value;

                    if (index === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });

                ctx.closePath();
                ctx.fill();
                ctx.stroke();

                // Draw skill labels
                ctx.fillStyle = '#ffffff';
                ctx.font = '12px Inter';
                ctx.textAlign = 'center';

                skills.forEach((skill, index) => {
                    const angle = (2 * Math.PI / skills.length) * index - Math.PI / 2;
                    const labelRadius = radius + 20;
                    const x = centerX + Math.cos(angle) * labelRadius;
                    const y = centerY + Math.sin(angle) * labelRadius;

                    ctx.fillText(skill.name, x, y);
                });
            }
        }

        // Edit mode functions
        function toggleEditMode() {
            isEditMode = !isEditMode;
            const inputs = document.querySelectorAll('#personalInfoPanel input, #personalInfoPanel textarea');
            const toggleBtn = document.getElementById('editToggleBtn');
            const formActions = document.getElementById('formActions');

            if (isEditMode) {
                // Store original data
                originalFormData = {};
                inputs.forEach(input => {
                    if (input.id !== 'username') { // Username should not be editable
                        input.removeAttribute('readonly');
                        originalFormData[input.id] = input.value;
                    }
                });
                toggleBtn.innerHTML = '<span>å–æ¶ˆ</span>';
                formActions.classList.remove('hidden');
            } else {
                inputs.forEach(input => {
                    input.setAttribute('readonly', true);
                });
                toggleBtn.innerHTML = '<span>ç¼–è¾‘</span>';
                formActions.classList.add('hidden');
                // Restore original data
                Object.keys(originalFormData).forEach(key => {
                    const input = document.getElementById(key);
                    if (input) input.value = originalFormData[key];
                });
            }
        }

        function cancelEdit() {
            toggleEditMode();
        }

        async function savePersonalInfo() {
            try {
                const formData = {
                    displayName: document.getElementById('displayName').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    city: document.getElementById('city').value,
                    birthday: document.getElementById('birthday').value,
                    bio: document.getElementById('bio').value
                };

                const response = await window.API.user.updateProfile(formData);
                if (response.success) {
                    showNotification('ä¸ªäººèµ„æ–™æ›´æ–°æˆåŠŸ', 'success');
                    toggleEditMode();
                    await loadProfile(); // Reload profile data
                }
            } catch (error) {
                console.error('Failed to save profile:', error);
                showNotification('ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
            }
        }

        // Settings functions
        function showSettingSection(section) {
            document.querySelectorAll('.setting-nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.setting-panel').forEach(panel => panel.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`${section}SettingsPanel`).classList.add('active');
        }

        async function saveSettings(section) {
            // Implementation depends on specific settings
            showNotification('è®¾ç½®ä¿å­˜æˆåŠŸ', 'success');
        }

        async function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                showNotification('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯', 'warning');
                return;
            }

            if (newPassword !== confirmPassword) {
                showNotification('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´', 'warning');
                return;
            }

            try {
                const response = await window.API.user.changePassword({
                    currentPassword,
                    newPassword
                });

                if (response.success) {
                    showNotification('å¯†ç ä¿®æ”¹æˆåŠŸ', 'success');
                    resetPasswordForm();
                }
            } catch (error) {
                console.error('Failed to change password:', error);
                showNotification('å¯†ç ä¿®æ”¹å¤±è´¥', 'error');
            }
        }

        function resetPasswordForm() {
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        // Order functions
        function filterOrders(status) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Re-load orders with filter
            loadOrders(status);
        }

        async function payOrder(orderNo) {
            try {
                const response = await window.API.payment.createPayment({ orderNo });
                if (response.success && response.data.payUrl) {
                    window.open(response.data.payUrl, '_blank');
                }
            } catch (error) {
                console.error('Failed to create payment:', error);
                showNotification('æ”¯ä»˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
            }
        }

        // Certificate functions
        async function downloadCertificate(certificateId) {
            try {
                await window.API.user.downloadCertificate(certificateId);
                showNotification('è¯ä¹¦ä¸‹è½½æˆåŠŸ', 'success');
            } catch (error) {
                console.error('Failed to download certificate:', error);
                showNotification('è¯ä¹¦ä¸‹è½½å¤±è´¥', 'error');
            }
        }

        function shareCertificate(certificateId) {
            // Implementation for sharing certificate
            showNotification('åˆ†äº«åŠŸèƒ½å¼€å‘ä¸­', 'info');
        }

        // Utility functions
        function formatRelativeTime(date) {
            const now = new Date();
            const diff = now - new Date(date);
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);

            if (days > 0) return `${days}å¤©å‰`;
            if (hours > 0) return `${hours}å°æ—¶å‰`;
            if (minutes > 0) return `${minutes}åˆ†é’Ÿå‰`;
            return 'åˆšåˆš';
        }

        function getStatusText(status) {
            const statusMap = {
                'pending': 'å¾…æ”¯ä»˜',
                'paid': 'å·²æ”¯ä»˜',
                'completed': 'å·²å®Œæˆ',
                'refunded': 'å·²é€€æ¬¾',
                'cancelled': 'å·²å–æ¶ˆ'
            };
            return statusMap[status] || 'æœªçŸ¥çŠ¶æ€';
        }

        function getSkillLevel(score) {
            if (score >= 90) return 'ä¸“å®¶';
            if (score >= 70) return 'é«˜çº§';
            if (score >= 50) return 'ä¸­çº§';
            if (score >= 30) return 'åˆçº§';
            return 'å…¥é—¨';
        }

        function continueCourse(courseId) {
            window.location.href = `/src/pages/course-detail.html?id=${courseId}`;
        }

        function showNotification(message, type = 'info') {
            // Simple notification implementation
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--dark-card);
                color: var(--text-primary);
                padding: 1rem 1.5rem;
                border-radius: 8px;
                border-left: 4px solid var(--${type === 'success' ? 'success' : type === 'error' ? 'danger' : type === 'warning' ? 'warning' : 'primary'}-color);
                box-shadow: var(--box-shadow);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        async function handleLogout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                localStorage.clear();
                window.location.href = '/src/pages/login.html';
            }
        }

        function initializeTabs() {
            // URL parameter handling
            const urlParams = new URLSearchParams(window.location.search);
            const tab = urlParams.get('tab');
            if (tab) {
                switchTab(tab);
            }
        }

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>