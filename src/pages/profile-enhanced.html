<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人中心 - AI 信息未来</title>
    <link rel="stylesheet" href="../styles/apple-design.css">
    <style>
        /* 页面布局 */
        body {
            padding-top: 48px;
            min-height: 100vh;
        }

        .page-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 22px;
        }

        /* 个人资料头部 */
        .profile-header {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: 48px 40px;
            margin-bottom: 32px;
            border: 1px solid var(--border-color);
        }

        .profile-header-content {
            display: flex;
            align-items: center;
            gap: 32px;
        }

        .avatar-wrapper {
            position: relative;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 48px;
            font-weight: 500;
            overflow: hidden;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .avatar-upload {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 36px;
            height: 36px;
            background: var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform var(--transition-fast);
            border: 3px solid var(--bg-card);
        }

        .avatar-upload:hover {
            transform: scale(1.1);
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .profile-title {
            font-size: 17px;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .profile-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .profile-badge {
            padding: 6px 12px;
            background: var(--bg-hover);
            border-radius: var(--radius-full);
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* 标签导航 */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            background: var(--bg-card);
            padding: 8px;
            border-radius: var(--radius-md);
            overflow-x: auto;
            border: 1px solid var(--border-color);
        }

        .tab {
            padding: 10px 20px;
            font-size: 15px;
            color: var(--text-secondary);
            background: transparent;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
            white-space: nowrap;
        }

        .tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--accent);
            color: #ffffff;
        }

        /* 内容区域 */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s var(--ease-out);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 统计卡片 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 24px;
            border: 1px solid var(--border-color);
            text-align: center;
            transition: transform var(--transition-fast);
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-card-value {
            font-size: 40px;
            font-weight: 700;
            color: var(--accent);
            letter-spacing: -0.02em;
            margin-bottom: 4px;
        }

        .stat-card-label {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* 表单部分 */
        .form-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 32px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
        }

        .section-title {
            font-size: 21px;
            font-weight: 600;
            margin-bottom: 24px;
            color: var(--text-primary);
            letter-spacing: -0.02em;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .form-grid-full {
            grid-column: span 2;
        }

        .form-field {
            display: flex;
            flex-direction: column;
        }

        .field-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .field-input, .field-select, .field-textarea {
            padding: 12px 14px;
            font-family: var(--font-sans);
            font-size: 15px;
            color: var(--text-primary);
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
        }

        .field-input:focus, .field-select:focus, .field-textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.15);
        }

        .field-input[readonly] {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .field-textarea {
            resize: vertical;
            min-height: 100px;
            font-family: var(--font-sans);
        }

        /* 时间线 */
        .timeline {
            position: relative;
            padding-left: 32px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 24px;
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            border: 1px solid var(--border-color);
            transition: transform var(--transition-fast);
        }

        .timeline-item:hover {
            transform: translateX(4px);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -28px;
            top: 24px;
            width: 12px;
            height: 12px;
            background: var(--accent);
            border-radius: 50%;
            border: 2px solid var(--bg-primary);
        }

        .timeline-date {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-bottom: 8px;
        }

        .timeline-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .timeline-desc {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* 成就网格 */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .achievement-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 24px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .achievement-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-card);
        }

        .achievement-card.unlocked {
            background: rgba(0, 113, 227, 0.05);
            border-color: var(--accent);
        }

        .achievement-icon {
            font-size: 40px;
            margin-bottom: 12px;
            opacity: 0.3;
            filter: grayscale(1);
        }

        .achievement-card.unlocked .achievement-icon {
            opacity: 1;
            filter: grayscale(0);
        }

        .achievement-name {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .achievement-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* 安全项 */
        .security-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .security-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: var(--bg-card);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
        }

        .security-info {
            flex: 1;
        }

        .security-item-title {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .security-item-desc {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .security-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #34c759;
        }

        .status-dot.inactive {
            background: #ff3b30;
        }

        .status-text {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* 证书网格 */
        .certificates-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .certificate-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 24px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .certificate-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-card);
        }

        .certificate-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .certificate-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .certificate-date {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        /* PK段位卡片 */
        .rank-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: var(--radius-lg);
            padding: 40px;
            color: white;
            display: flex;
            align-items: center;
            gap: 32px;
            margin-bottom: 24px;
        }

        .rank-icon {
            font-size: 80px;
        }

        .rank-details {
            flex: 1;
        }

        .rank-name {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .rank-elo {
            font-size: 17px;
            opacity: 0.9;
            margin-bottom: 16px;
        }

        .rank-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-full);
            overflow: hidden;
            margin-bottom: 8px;
        }

        .rank-progress-bar {
            height: 100%;
            background: white;
            border-radius: var(--radius-full);
            transition: width 0.5s var(--ease-out);
        }

        .rank-next {
            font-size: 13px;
            opacity: 0.8;
        }

        .rank-season {
            text-align: center;
        }

        .rank-season-label {
            font-size: 13px;
            opacity: 0.8;
            margin-bottom: 4px;
        }

        .rank-season-value {
            font-size: 40px;
            font-weight: 700;
        }

        /* PK详情卡片 */
        .pk-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .pk-stat-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 24px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .pk-stat-label {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .pk-stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--accent);
        }

        /* 对战列表 */
        .battle-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .battle-item {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 20px;
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .battle-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .battle-result {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
        }

        .battle-result.win {
            background: rgba(52, 199, 89, 0.1);
            color: #34c759;
        }

        .battle-result.loss {
            background: rgba(255, 59, 48, 0.1);
            color: #ff3b30;
        }

        .battle-details {
            flex: 1;
        }

        .battle-opponent {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .battle-time {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .battle-score {
            text-align: right;
        }

        .battle-score-value {
            font-size: 21px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .battle-mode {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* 按钮组 */
        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        /* 空状态 */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        /* 设置项 */
        .settings-section {
            margin-bottom: 32px;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-card);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-label {
            font-size: 15px;
            color: var(--text-primary);
            cursor: pointer;
        }

        /* 响应式 */
        @media (max-width: 768px) {
            .profile-header-content {
                flex-direction: column;
                text-align: center;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .form-grid-full {
                grid-column: span 1;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .achievements-grid, .certificates-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .pk-stats {
                grid-template-columns: 1fr;
            }

            .rank-card {
                flex-direction: column;
                text-align: center;
            }

            .battle-item {
                flex-direction: column;
                gap: 16px;
            }

            .battle-score {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="/src/pages/index.html" class="nav-logo">学习平台</a>
            <div class="nav-menu">
                <a href="/src/pages/index.html" class="nav-link">首页</a>
                <a href="/src/pages/courses.html" class="nav-link">课程</a>
                <a href="/src/pages/community.html" class="nav-link">社区</a>
                <a href="/src/pages/pk-arena-new.html" class="nav-link">PK竞技</a>
            </div>
            <div class="nav-actions">
                <button class="theme-toggle" onclick="toggleTheme()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <line x1="12" y1="1" x2="12" y2="3"/>
                        <line x1="12" y1="21" x2="12" y2="23"/>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                        <line x1="1" y1="12" x2="3" y2="12"/>
                        <line x1="21" y1="12" x2="23" y2="12"/>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                    </svg>
                </button>
                <div class="user-avatar" onclick="location.href='/src/pages/profile-enhanced.html'" id="navAvatar">U</div>
            </div>
        </div>
    </nav>

    <!-- 主容器 -->
    <div class="page-container">
        <!-- 个人资料头部 -->
        <div class="profile-header">
            <div class="profile-header-content">
                <div class="avatar-wrapper">
                    <div class="profile-avatar" id="profileAvatar">
                        <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                    </div>
                    <div class="avatar-upload" onclick="uploadAvatar()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                            <circle cx="12" cy="13" r="4"/>
                        </svg>
                    </div>
                    <input type="file" id="avatarInput" accept="image/*" style="display: none;">
                </div>
                <div class="profile-info">
                    <h1 class="profile-name" id="profileName">加载中...</h1>
                    <p class="profile-title">高级学员</p>
                    <div class="profile-badges">
                        <span class="profile-badge">荣誉学员</span>
                        <span class="profile-badge">完成50门课程</span>
                        <span class="profile-badge">5.0评分</span>
                        <span class="profile-badge">连续学习365天</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 标签导航 -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('basic')">基本信息</button>
            <button class="tab" onclick="switchTab('learning')">学习记录</button>
            <button class="tab" onclick="switchTab('pk')">PK战绩</button>
            <button class="tab" onclick="switchTab('achievements')">成就勋章</button>
            <button class="tab" onclick="switchTab('certificates')">我的证书</button>
            <button class="tab" onclick="switchTab('security')">账号安全</button>
            <button class="tab" onclick="switchTab('settings')">偏好设置</button>
        </div>

        <!-- 内容区域 -->
        <!-- 基本信息 -->
        <div class="tab-content active" id="basic">
            <!-- 统计概览 -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-value">156</div>
                    <div class="stat-card-label">学习天数</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value">42</div>
                    <div class="stat-card-label">完成课程</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value">580h</div>
                    <div class="stat-card-label">学习时长</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value">28</div>
                    <div class="stat-card-label">获得证书</div>
                </div>
            </div>

            <!-- 个人信息 -->
            <div class="form-section">
                <h2 class="section-title">个人信息</h2>
                <div class="form-grid">
                    <div class="form-field">
                        <label class="field-label">真实姓名</label>
                        <input type="text" class="field-input" id="realName" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">用户名</label>
                        <input type="text" class="field-input" id="username" value="" readonly>
                    </div>
                    <div class="form-field">
                        <label class="field-label">性别</label>
                        <select class="field-select" id="gender">
                            <option value="">请选择</option>
                            <option value="male">男</option>
                            <option value="female">女</option>
                            <option value="other">其他</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label class="field-label">出生日期</label>
                        <input type="date" class="field-input" id="birthday" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">手机号码</label>
                        <input type="tel" class="field-input" id="phone" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">电子邮箱</label>
                        <input type="email" class="field-input" id="email" value="">
                    </div>
                </div>
            </div>

            <!-- 教育信息 -->
            <div class="form-section">
                <h2 class="section-title">教育信息</h2>
                <div class="form-grid">
                    <div class="form-field">
                        <label class="field-label">学校/机构</label>
                        <input type="text" class="field-input" id="school" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">专业</label>
                        <input type="text" class="field-input" id="major" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">学历</label>
                        <select class="field-select" id="education">
                            <option value="">请选择</option>
                            <option value="high">高中及以下</option>
                            <option value="college">大专</option>
                            <option value="bachelor">本科</option>
                            <option value="master">硕士</option>
                            <option value="doctor">博士</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label class="field-label">入学年份</label>
                        <input type="number" class="field-input" id="enrollYear" value="" min="1970" max="2024">
                    </div>
                    <div class="form-field">
                        <label class="field-label">学生证号</label>
                        <input type="text" class="field-input" id="studentId" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">班级</label>
                        <input type="text" class="field-input" id="className" value="">
                    </div>
                </div>
            </div>

            <!-- 职业信息 -->
            <div class="form-section">
                <h2 class="section-title">职业信息</h2>
                <div class="form-grid">
                    <div class="form-field">
                        <label class="field-label">公司名称</label>
                        <input type="text" class="field-input" id="company" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">职位</label>
                        <input type="text" class="field-input" id="position" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">工作年限</label>
                        <select class="field-select" id="workYears">
                            <option value="">请选择</option>
                            <option value="0">应届生</option>
                            <option value="1-3">1-3年</option>
                            <option value="3-5">3-5年</option>
                            <option value="5-10">5-10年</option>
                            <option value="10+">10年以上</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label class="field-label">所在行业</label>
                        <select class="field-select" id="industry">
                            <option value="">请选择</option>
                            <option value="it">互联网/IT</option>
                            <option value="finance">金融</option>
                            <option value="education">教育</option>
                            <option value="medical">医疗</option>
                            <option value="other">其他</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 其他信息 -->
            <div class="form-section">
                <h2 class="section-title">其他信息</h2>
                <div class="form-grid">
                    <div class="form-field">
                        <label class="field-label">所在城市</label>
                        <input type="text" class="field-input" id="city" value="">
                    </div>
                    <div class="form-field">
                        <label class="field-label">详细地址</label>
                        <input type="text" class="field-input" id="address" value="">
                    </div>
                    <div class="form-field form-grid-full">
                        <label class="field-label">个人简介</label>
                        <textarea class="field-textarea" id="bio" rows="4"></textarea>
                    </div>
                    <div class="form-field form-grid-full">
                        <label class="field-label">兴趣标签</label>
                        <input type="text" class="field-input" id="interests" value="" placeholder="用逗号分隔多个标签">
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="saveProfile()">保存修改</button>
                <button class="btn btn-secondary" onclick="resetForm()">重置</button>
            </div>
        </div>

        <!-- 学习记录 -->
        <div class="tab-content" id="learning">
            <div class="form-section">
                <h2 class="section-title">学习时间线</h2>
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-date">2024年3月15日 14:30</div>
                        <div class="timeline-title">完成课程《Vue 3 高级开发》</div>
                        <div class="timeline-desc">学习时长：45小时 | 得分：98分 | 获得证书</div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">2024年3月10日 20:15</div>
                        <div class="timeline-title">参加直播课《前端性能优化》</div>
                        <div class="timeline-desc">参与互动：12次 | 获得讲师点赞</div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">2024年3月5日 18:00</div>
                        <div class="timeline-title">提交作业《React项目实战》</div>
                        <div class="timeline-desc">作业评分：95分 | 讲师评语：代码规范，思路清晰</div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-date">2024年3月1日 09:00</div>
                        <div class="timeline-title">开始学习《Node.js全栈开发》</div>
                        <div class="timeline-desc">预计学习时长：60小时 | 当前进度：35%</div>
                    </div>
                </div>
                <button class="btn btn-primary" style="margin-top: 24px;">查看全部记录</button>
            </div>
        </div>

        <!-- PK战绩 -->
        <div class="tab-content" id="pk">
            <!-- 统计卡片 -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-value" id="pkTotalBattles">0</div>
                    <div class="stat-card-label">总场次</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value" id="pkWins">0</div>
                    <div class="stat-card-label">胜利</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value" id="pkWinRate">0%</div>
                    <div class="stat-card-label">胜率</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-value" id="pkStreak">0</div>
                    <div class="stat-card-label">连胜</div>
                </div>
            </div>

            <!-- 段位信息 -->
            <div class="rank-card">
                <div class="rank-icon" id="pkRankIcon">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="8" r="7"/>
                        <path d="M8.21 13.89L7 23l5-3 5 3-1.21-9.12"/>
                    </svg>
                </div>
                <div class="rank-details">
                    <h2 class="rank-name" id="pkRankName">青铜</h2>
                    <p class="rank-elo">ELO积分: <span id="pkEloRating">1200</span></p>
                    <div class="rank-progress">
                        <div class="rank-progress-bar" id="pkRankProgress" style="width: 0%;"></div>
                    </div>
                    <p class="rank-next">距离下一段位还需 <span id="pkPointsToNext">300</span> 积分</p>
                </div>
                <div class="rank-season">
                    <div class="rank-season-label">本赛季排名</div>
                    <div class="rank-season-value" id="pkSeasonRank">-</div>
                </div>
            </div>

            <!-- 详细数据 -->
            <div class="pk-stats">
                <div class="pk-stat-card">
                    <div class="pk-stat-label">答题准确率</div>
                    <div class="pk-stat-value" id="pkAccuracy">0%</div>
                </div>
                <div class="pk-stat-card">
                    <div class="pk-stat-label">平均用时</div>
                    <div class="pk-stat-value" id="pkAvgTime">0s</div>
                </div>
                <div class="pk-stat-card">
                    <div class="pk-stat-label">最佳连胜</div>
                    <div class="pk-stat-value" id="pkBestStreak">0</div>
                </div>
            </div>

            <!-- 最近对战 -->
            <div class="form-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                    <h2 class="section-title" style="margin-bottom: 0;">最近对战</h2>
                    <a href="/src/pages/pk-arena-new.html" class="btn btn-primary btn-sm">前往PK竞技场</a>
                </div>
                <div id="pkRecentBattles" class="battle-list">
                    <div class="empty-state">暂无对战记录</div>
                </div>
            </div>
        </div>

        <!-- 成就勋章 -->
        <div class="tab-content" id="achievements">
            <div class="form-section">
                <h2 class="section-title">我的成就</h2>
                <div class="achievements-grid">
                    <div class="achievement-card unlocked">
                        <div class="achievement-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                        </div>
                        <div class="achievement-name">初学者</div>
                        <div class="achievement-desc">完成第一门课程</div>
                    </div>
                    <div class="achievement-card unlocked">
                        <div class="achievement-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                            </svg>
                        </div>
                        <div class="achievement-name">学习达人</div>
                        <div class="achievement-desc">连续学习7天</div>
                    </div>
                    <div class="achievement-card unlocked">
                        <div class="achievement-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                            </svg>
                        </div>
                        <div class="achievement-name">博学者</div>
                        <div class="achievement-desc">完成10门课程</div>
                    </div>
                    <div class="achievement-card unlocked">
                        <div class="achievement-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                            </svg>
                        </div>
                        <div class="achievement-name">优秀学员</div>
                        <div class="achievement-desc">平均分超过90分</div>
                    </div>
                    <div class="achievement-card">
                        <div class="achievement-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="8" r="7"/>
                                <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/>
                            </svg>
                        </div>
                        <div class="achievement-name">学霸</div>
                        <div class="achievement-desc">完成50门课程</div>
                    </div>
                    <div class="achievement-card">
                        <div class="achievement-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                        </div>
                        <div class="achievement-name">大师</div>
                        <div class="achievement-desc">完成100门课程</div>
                    </div>
                    <div class="achievement-card">
                        <div class="achievement-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/>
                                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/>
                                <path d="M4 22h16"/>
                                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/>
                                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/>
                                <path d="M18 2H6v7a6 6 0 0 0 12 0V2z"/>
                            </svg>
                        </div>
                        <div class="achievement-name">传奇</div>
                        <div class="achievement-desc">连续学习365天</div>
                    </div>
                    <div class="achievement-card">
                        <div class="achievement-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 16v-4"/>
                                <path d="M12 8h.01"/>
                            </svg>
                        </div>
                        <div class="achievement-name">导师</div>
                        <div class="achievement-desc">帮助100位学员</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 我的证书 -->
        <div class="tab-content" id="certificates">
            <div class="form-section">
                <h2 class="section-title">证书列表</h2>
                <div class="certificates-grid">
                    <div class="certificate-card">
                        <div class="certificate-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                                <line x1="16" y1="13" x2="8" y2="13"/>
                                <line x1="16" y1="17" x2="8" y2="17"/>
                                <polyline points="10 9 9 9 8 9"/>
                            </svg>
                        </div>
                        <h3 class="certificate-title">Vue 3 高级开发</h3>
                        <p class="certificate-date">颁发日期：2024-03-15</p>
                        <button class="btn btn-primary btn-sm">查看证书</button>
                    </div>
                    <div class="certificate-card">
                        <div class="certificate-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="8" r="7"/>
                                <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/>
                            </svg>
                        </div>
                        <h3 class="certificate-title">React实战项目</h3>
                        <p class="certificate-date">颁发日期：2024-02-20</p>
                        <button class="btn btn-primary btn-sm">查看证书</button>
                    </div>
                    <div class="certificate-card">
                        <div class="certificate-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                        </div>
                        <h3 class="certificate-title">前端工程化</h3>
                        <p class="certificate-date">颁发日期：2024-01-10</p>
                        <button class="btn btn-primary btn-sm">查看证书</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 账号安全 -->
        <div class="tab-content" id="security">
            <div class="form-section">
                <h2 class="section-title">安全设置</h2>
                <div class="security-list">
                    <div class="security-item">
                        <div class="security-info">
                            <div class="security-item-title">登录密码</div>
                            <div class="security-item-desc">定期更改密码可以提高账号安全性</div>
                        </div>
                        <div class="security-actions">
                            <span class="status-dot"></span>
                            <span class="status-text">已设置</span>
                            <button class="btn btn-secondary btn-sm">修改密码</button>
                        </div>
                    </div>
                    <div class="security-item">
                        <div class="security-info">
                            <div class="security-item-title">手机绑定</div>
                            <div class="security-item-desc">绑定手机号：138****8000</div>
                        </div>
                        <div class="security-actions">
                            <span class="status-dot"></span>
                            <span class="status-text">已绑定</span>
                            <button class="btn btn-secondary btn-sm">更换手机</button>
                        </div>
                    </div>
                    <div class="security-item">
                        <div class="security-info">
                            <div class="security-item-title">邮箱验证</div>
                            <div class="security-item-desc">验证邮箱：example@example.com</div>
                        </div>
                        <div class="security-actions">
                            <span class="status-dot"></span>
                            <span class="status-text">已验证</span>
                            <button class="btn btn-secondary btn-sm">更换邮箱</button>
                        </div>
                    </div>
                    <div class="security-item">
                        <div class="security-info">
                            <div class="security-item-title">两步验证</div>
                            <div class="security-item-desc">开启两步验证，让账号更安全</div>
                        </div>
                        <div class="security-actions">
                            <span class="status-dot inactive"></span>
                            <span class="status-text">未开启</span>
                            <button class="btn btn-primary btn-sm">立即开启</button>
                        </div>
                    </div>
                    <div class="security-item">
                        <div class="security-info">
                            <div class="security-item-title">登录设备管理</div>
                            <div class="security-item-desc">查看和管理登录设备</div>
                        </div>
                        <div class="security-actions">
                            <button class="btn btn-secondary btn-sm">管理设备</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-section" style="background: rgba(255, 59, 48, 0.05); border-color: #ff3b30;">
                <h2 class="section-title" style="color: #ff3b30;">危险操作</h2>
                <div class="security-item" style="background: transparent; border: none; padding: 0;">
                    <div class="security-info">
                        <div class="security-item-title" style="color: #ff3b30;">注销账号</div>
                        <div class="security-item-desc">删除账号后，所有数据将无法恢复</div>
                    </div>
                    <button class="btn btn-sm" style="background: #ff3b30; color: white;">注销账号</button>
                </div>
            </div>
        </div>

        <!-- 偏好设置 -->
        <div class="tab-content" id="settings">
            <div class="settings-section">
                <div class="form-section">
                    <h2 class="section-title">学习偏好</h2>
                    <div class="form-grid">
                        <div class="form-field">
                            <label class="field-label">学习提醒</label>
                            <select class="field-select">
                                <option value="daily">每日提醒</option>
                                <option value="weekly">每周提醒</option>
                                <option value="never">不提醒</option>
                            </select>
                        </div>
                        <div class="form-field">
                            <label class="field-label">提醒时间</label>
                            <input type="time" class="field-input" value="20:00">
                        </div>
                        <div class="form-field">
                            <label class="field-label">视频清晰度</label>
                            <select class="field-select">
                                <option value="auto">自动</option>
                                <option value="1080p">1080P</option>
                                <option value="720p">720P</option>
                                <option value="480p">480P</option>
                            </select>
                        </div>
                        <div class="form-field">
                            <label class="field-label">播放速度</label>
                            <select class="field-select">
                                <option value="0.5">0.5倍速</option>
                                <option value="1" selected>1倍速</option>
                                <option value="1.25">1.25倍速</option>
                                <option value="1.5">1.5倍速</option>
                                <option value="2">2倍速</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2 class="section-title">通知设置</h2>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="notif1" checked>
                            <label class="checkbox-label" for="notif1">课程更新通知</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="notif2" checked>
                            <label class="checkbox-label" for="notif2">作业批改通知</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="notif3" checked>
                            <label class="checkbox-label" for="notif3">直播开始提醒</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="notif4">
                            <label class="checkbox-label" for="notif4">营销推广信息</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="notif5" checked>
                            <label class="checkbox-label" for="notif5">系统公告</label>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2 class="section-title">界面设置</h2>
                    <div class="form-grid">
                        <div class="form-field">
                            <label class="field-label">主题模式</label>
                            <select class="field-select" id="themeSelect" onchange="setThemeFromSelect()">
                                <option value="light">浅色模式</option>
                                <option value="dark">深色模式</option>
                                <option value="auto">跟随系统</option>
                            </select>
                        </div>
                        <div class="form-field">
                            <label class="field-label">语言</label>
                            <select class="field-select">
                                <option value="zh-CN">简体中文</option>
                                <option value="zh-TW">繁体中文</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="saveSettings()">保存设置</button>
                    <button class="btn btn-secondary" onclick="resetSettings()">恢复默认</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/api';

        // 主题切换
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        function setThemeFromSelect() {
            const select = document.getElementById('themeSelect');
            const theme = select.value;
            if (theme === 'auto') {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
                localStorage.setItem('theme', 'auto');
            } else {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
            }
        }

        // 初始化主题
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'auto') {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
            } else {
                document.documentElement.setAttribute('data-theme', savedTheme);
            }
            const themeSelect = document.getElementById('themeSelect');
            if (themeSelect) {
                themeSelect.value = savedTheme;
            }
        }

        // 标签切换
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');

            if (tabName === 'pk') {
                loadPKStats();
            }
        }

        // 上传头像
        function uploadAvatar() {
            document.getElementById('avatarInput').click();
        }

        document.getElementById('avatarInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profileAvatar').innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: cover;">`;
                    const navAvatar = document.getElementById('navAvatar');
                    if (navAvatar) {
                        navAvatar.innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">`;
                    }
                };
                reader.readAsDataURL(file);
            }
        });

        // 保存个人资料
        async function saveProfile() {
            const profileData = {
                realName: document.getElementById('realName').value,
                gender: document.getElementById('gender').value,
                birthday: document.getElementById('birthday').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                school: document.getElementById('school').value,
                major: document.getElementById('major').value,
                education: document.getElementById('education').value,
                enrollYear: document.getElementById('enrollYear').value,
                studentId: document.getElementById('studentId').value,
                className: document.getElementById('className').value,
                company: document.getElementById('company').value,
                position: document.getElementById('position').value,
                workYears: document.getElementById('workYears').value,
                industry: document.getElementById('industry').value,
                city: document.getElementById('city').value,
                address: document.getElementById('address').value,
                bio: document.getElementById('bio').value,
                interests: document.getElementById('interests').value
            };

            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE}/user/profile`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(profileData)
                });

                if (response.ok) {
                    alert('个人资料保存成功！');
                } else {
                    alert('保存失败，请稍后再试');
                }
            } catch (error) {
                console.error('保存失败:', error);
                alert('保存失败，请稍后再试');
            }
        }

        // 重置表单
        function resetForm() {
            if (confirm('确定要重置所有修改吗？')) {
                location.reload();
            }
        }

        // 保存设置
        function saveSettings() {
            alert('设置保存成功！');
        }

        // 重置设置
        function resetSettings() {
            if (confirm('确定要恢复默认设置吗？')) {
                alert('已恢复默认设置！');
            }
        }

        // 加载用户资料
        async function loadUserProfile() {
            try {
                const token = localStorage.getItem('token');
                const user = JSON.parse(localStorage.getItem('user') || '{}');

                if (user.username) {
                    document.getElementById('profileName').textContent = user.username;
                    document.getElementById('username').value = user.username;
                    document.getElementById('realName').value = user.username;

                    const initial = user.username.charAt(0).toUpperCase();
                    const navAvatar = document.getElementById('navAvatar');
                    if (navAvatar) {
                        navAvatar.textContent = initial;
                    }
                }

                if (token) {
                    const response = await fetch(`${API_BASE}/user/profile`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    if (response.ok) {
                        const result = await response.json();
                        if (result.success && result.data) {
                            updateProfileDisplay(result.data);
                        }
                    }
                }
            } catch (error) {
                console.error('加载用户资料失败:', error);
            }
        }

        // 更新页面显示
        function updateProfileDisplay(data) {
            const fields = ['realName', 'username', 'gender', 'birthday', 'phone', 'email',
                          'school', 'major', 'education', 'enrollYear', 'studentId', 'className',
                          'company', 'position', 'workYears', 'industry', 'city', 'address', 'bio', 'interests'];

            fields.forEach(field => {
                const element = document.getElementById(field);
                if (element && data[field]) {
                    element.value = data[field];
                }
            });

            if (data.realName) {
                document.getElementById('profileName').textContent = data.realName;
            }
        }

        // 加载PK统计
        async function loadPKStats() {
            try {
                const token = localStorage.getItem('token');
                if (!token) {
                    console.warn('用户未登录');
                    return;
                }

                const response = await fetch(`${API_BASE}/pk/stats/my`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data) {
                        updatePKDisplay(result.data);
                    }
                }

                const battlesRes = await fetch(`${API_BASE}/pk/battles/recent?limit=5`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (battlesRes.ok) {
                    const battlesResult = await battlesRes.json();
                    if (battlesResult.success && battlesResult.data) {
                        displayRecentBattles(battlesResult.data);
                    }
                }
            } catch (error) {
                console.error('加载PK统计失败:', error);
            }
        }

        // 更新PK统计显示
        function updatePKDisplay(stats) {
            document.getElementById('pkTotalBattles').textContent = stats.totalBattles || 0;
            document.getElementById('pkWins').textContent = stats.wins || 0;
            document.getElementById('pkWinRate').textContent = (stats.winRate || 0).toFixed(1) + '%';
            document.getElementById('pkStreak').textContent = stats.currentStreak || 0;

            const rankInfo = getRankInfo(stats.rankTier || 'BRONZE');
            document.getElementById('pkRankName').textContent = rankInfo.name;
            document.getElementById('pkEloRating').textContent = stats.eloRating || 1200;

            const progress = calculateRankProgress(stats.eloRating || 1200, stats.rankTier || 'BRONZE');
            document.getElementById('pkRankProgress').style.width = progress.percent + '%';
            document.getElementById('pkPointsToNext').textContent = progress.pointsToNext;

            document.getElementById('pkSeasonRank').textContent = stats.seasonRank || '-';

            document.getElementById('pkAccuracy').textContent = (stats.accuracyRate || 0).toFixed(1) + '%';
            document.getElementById('pkAvgTime').textContent = (stats.avgAnswerTime || 0) + 's';
            document.getElementById('pkBestStreak').textContent = stats.bestStreak || 0;
        }

        // 显示最近对战
        function displayRecentBattles(battles) {
            const container = document.getElementById('pkRecentBattles');
            if (!battles || battles.length === 0) {
                container.innerHTML = '<div class="empty-state">暂无对战记录</div>';
                return;
            }

            const userId = JSON.parse(localStorage.getItem('user') || '{}').id;
            container.innerHTML = battles.map(battle => {
                const isWinner = battle.winnerId === userId;
                const opponent = battle.player1Id === userId ? battle.player2 : battle.player1;
                const myScore = battle.player1Id === userId ? battle.player1Score : battle.player2Score;
                const opponentScore = battle.player1Id === userId ? battle.player2Score : battle.player1Score;

                return `
                    <div class="battle-item">
                        <div class="battle-info">
                            <div class="battle-result ${isWinner ? 'win' : 'loss'}">
                                ${isWinner ? '✓' : '✗'}
                            </div>
                            <div class="battle-details">
                                <div class="battle-opponent">VS ${opponent.username}</div>
                                <div class="battle-time">${new Date(battle.createdAt).toLocaleString()}</div>
                            </div>
                        </div>
                        <div class="battle-score">
                            <div class="battle-score-value">${myScore} : ${opponentScore}</div>
                            <div class="battle-mode">${getModeText(battle.mode)}</div>
                        </div>
                        <a href="/src/pages/pk-replay.html?battleId=${battle.id}" class="btn btn-secondary btn-sm">查看回放</a>
                    </div>
                `;
            }).join('');
        }

        // 获取段位信息
        function getRankInfo(tier) {
            const ranks = {
                'BRONZE': { name: '青铜' },
                'SILVER': { name: '白银' },
                'GOLD': { name: '黄金' },
                'PLATINUM': { name: '铂金' },
                'DIAMOND': { name: '钻石' },
                'KING': { name: '王者' }
            };
            return ranks[tier] || ranks['BRONZE'];
        }

        // 计算段位进度
        function calculateRankProgress(elo, tier) {
            const ranges = {
                'BRONZE': { min: 0, max: 999 },
                'SILVER': { min: 1000, max: 1499 },
                'GOLD': { min: 1500, max: 1999 },
                'PLATINUM': { min: 2000, max: 2499 },
                'DIAMOND': { min: 2500, max: 2999 },
                'KING': { min: 3000, max: 9999 }
            };

            const range = ranges[tier] || ranges['BRONZE'];
            const current = elo - range.min;
            const total = range.max - range.min;
            const percent = Math.min(100, (current / total) * 100);
            const pointsToNext = tier === 'KING' ? 0 : range.max + 1 - elo;

            return { percent, pointsToNext };
        }

        // 模式文本
        function getModeText(mode) {
            const modes = {
                'QUICK': '快速模式',
                'STANDARD': '标准模式',
                'LONG': '长篇模式'
            };
            return modes[mode] || mode;
        }

        // 页面加载
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            loadUserProfile();

            const token = localStorage.getItem('token');
            if (!token) {
                alert('请先登录');
                window.location.href = '/src/pages/login.html';
            }
        });
    </script>
</body>
</html>
