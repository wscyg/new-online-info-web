<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ¬åœ°åº“æµ‹è¯•</title>
    <!-- ç›´æ¥ä½¿ç”¨æœ¬åœ°åº“ -->
    <link rel="stylesheet" href="/lib/highlightjs/github-dark.min.css">
    <link rel="stylesheet" href="/lib/katex/katex.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #f1f5f9;
            padding: 2rem;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            background: #1e293b;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #334155;
        }
        .status {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-weight: bold;
            margin: 0.5rem 0;
        }
        .status.success { background: #22c55e; color: white; }
        .status.error { background: #ef4444; color: white; }
        .status.loading { background: #f59e0b; color: white; }
        
        /* åŠ¨ç”»æµ‹è¯• */
        .animation-test {
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            margin: 1rem auto;
            animation: spin 2s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .interactive-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .interactive-button:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .math-demo {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª æœ¬åœ°åº“åŠŸèƒ½æµ‹è¯•</h1>
        <p>è¿™ä¸ªé¡µé¢ç›´æ¥æµ‹è¯•æœ¬åœ°åº“æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>

        <!-- 1. åº“åŠ è½½çŠ¶æ€æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ“¦ 1. åº“åŠ è½½çŠ¶æ€</h2>
            <div id="lib-status"></div>
        </div>

        <!-- 2. CSSåŠ¨ç”»æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ¨ 2. CSSåŠ¨ç”»æµ‹è¯•</h2>
            <p>å¦‚æœä½ çœ‹åˆ°ä¸‹é¢çš„åœ†åœˆåœ¨æ—‹è½¬ï¼Œè¯´æ˜CSSåŠ¨ç”»å·¥ä½œæ­£å¸¸ï¼š</p>
            <div class="animation-test"></div>
        </div>

        <!-- 3. JavaScriptäº¤äº’æµ‹è¯• -->
        <div class="test-section">
            <h2>âš¡ 3. JavaScriptäº¤äº’æµ‹è¯•</h2>
            <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•JavaScriptäº¤äº’ï¼š</p>
            <button class="interactive-button" onclick="testInteraction()">ç‚¹å‡»æµ‹è¯•</button>
            <div id="interaction-result" style="margin-top: 1rem;"></div>
        </div>

        <!-- 4. ä»£ç é«˜äº®æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ¯ 4. ä»£ç é«˜äº®æµ‹è¯• (highlight.js)</h2>
            <div id="highlight-status" class="status loading">æ­£åœ¨æµ‹è¯•...</div>
            <pre><code class="language-javascript" id="test-code">
function multiHeadAttention(query, key, value) {
    const numHeads = 8;
    const dModel = 512;
    const dK = dModel / numHeads;
    
    // åˆ†å¤´å¤„ç†
    const heads = [];
    for (let i = 0; i < numHeads; i++) {
        const head = attention(
            query.slice(i * dK, (i + 1) * dK),
            key.slice(i * dK, (i + 1) * dK),
            value.slice(i * dK, (i + 1) * dK)
        );
        heads.push(head);
    }
    
    // æ‹¼æ¥å¤šå¤´ç»“æœ
    return concat(heads).matmul(WO);
}
            </code></pre>
        </div>

        <!-- 5. æ•°å­¦å…¬å¼æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ“ 5. æ•°å­¦å…¬å¼æµ‹è¯• (KaTeX)</h2>
            <div id="katex-status" class="status loading">æ­£åœ¨æµ‹è¯•...</div>
            <div class="math-demo">
                <p>å¤šå¤´æ³¨æ„åŠ›å…¬å¼ï¼š</p>
                <div id="math-formula">
                    MultiHead(Q,K,V) = Concat(head_1, ..., head_h)W^O
                </div>
                <div id="math-formula-2">
                    head_i = Attention(QW_i^Q, KW_i^K, VW_i^V)
                </div>
            </div>
        </div>

        <!-- 6. ç»¼åˆæµ‹è¯•ç»“æœ -->
        <div class="test-section">
            <h2>ğŸ“Š 6. æµ‹è¯•æ€»ç»“</h2>
            <div id="test-summary"></div>
        </div>
    </div>

    <!-- åŠ è½½æœ¬åœ°JavaScriptåº“ -->
    <script src="/lib/highlightjs/highlight.min.js"></script>
    <script src="/lib/katex/katex.min.js"></script>
    <script src="/lib/katex/auto-render.min.js"></script>

    <script>
        let testResults = {
            css: false,
            javascript: false,
            highlight: false,
            katex: false
        };

        // æ£€æŸ¥åº“æ˜¯å¦åŠ è½½
        function checkLibraries() {
            const statusDiv = document.getElementById('lib-status');
            let html = '';

            // æ£€æŸ¥highlight.js
            if (typeof hljs !== 'undefined') {
                html += '<div class="status success">âœ… highlight.js å·²åŠ è½½</div>';
                testResults.highlight = true;
            } else {
                html += '<div class="status error">âŒ highlight.js åŠ è½½å¤±è´¥</div>';
            }

            // æ£€æŸ¥KaTeX
            if (typeof katex !== 'undefined') {
                html += '<div class="status success">âœ… KaTeX å·²åŠ è½½</div>';
                testResults.katex = true;
            } else {
                html += '<div class="status error">âŒ KaTeX åŠ è½½å¤±è´¥</div>';
            }

            // æ£€æŸ¥auto-render
            if (typeof renderMathInElement !== 'undefined') {
                html += '<div class="status success">âœ… KaTeX auto-render å·²åŠ è½½</div>';
            } else {
                html += '<div class="status error">âŒ KaTeX auto-render åŠ è½½å¤±è´¥</div>';
            }

            statusDiv.innerHTML = html;
        }

        // æµ‹è¯•ä»£ç é«˜äº®
        function testHighlight() {
            const statusDiv = document.getElementById('highlight-status');
            
            if (typeof hljs !== 'undefined') {
                try {
                    hljs.highlightAll();
                    statusDiv.className = 'status success';
                    statusDiv.textContent = 'âœ… ä»£ç é«˜äº®æ­£å¸¸å·¥ä½œ';
                    testResults.highlight = true;
                } catch (error) {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = 'âŒ ä»£ç é«˜äº®å‡ºé”™: ' + error.message;
                }
            } else {
                statusDiv.className = 'status error';
                statusDiv.textContent = 'âŒ highlight.js æœªåŠ è½½';
            }
        }

        // æµ‹è¯•æ•°å­¦å…¬å¼æ¸²æŸ“
        function testKaTeX() {
            const statusDiv = document.getElementById('katex-status');
            
            if (typeof katex !== 'undefined') {
                try {
                    // æ¸²æŸ“ç¬¬ä¸€ä¸ªå…¬å¼
                    katex.render('\\text{MultiHead}(Q,K,V) = \\text{Concat}(\\text{head}_1, \\ldots, \\text{head}_h)W^O', 
                                document.getElementById('math-formula'));
                    
                    // æ¸²æŸ“ç¬¬äºŒä¸ªå…¬å¼
                    katex.render('\\text{head}_i = \\text{Attention}(QW_i^Q, KW_i^K, VW_i^V)', 
                                document.getElementById('math-formula-2'));
                    
                    statusDiv.className = 'status success';
                    statusDiv.textContent = 'âœ… æ•°å­¦å…¬å¼æ¸²æŸ“æ­£å¸¸';
                    testResults.katex = true;
                } catch (error) {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = 'âŒ KaTeX æ¸²æŸ“å‡ºé”™: ' + error.message;
                }
            } else {
                statusDiv.className = 'status error';
                statusDiv.textContent = 'âŒ KaTeX æœªåŠ è½½';
            }
        }

        // æµ‹è¯•JavaScriptäº¤äº’
        function testInteraction() {
            const resultDiv = document.getElementById('interaction-result');
            resultDiv.innerHTML = '<div class="status success">âœ… JavaScriptäº¤äº’æ­£å¸¸ï¼ç‚¹å‡»æˆåŠŸ</div>';
            testResults.javascript = true;
            updateSummary();
        }

        // æ›´æ–°æµ‹è¯•æ€»ç»“
        function updateSummary() {
            const summaryDiv = document.getElementById('test-summary');
            const total = Object.keys(testResults).length;
            const passed = Object.values(testResults).filter(r => r).length;
            
            let html = `<h3>æµ‹è¯•ç»“æœï¼š${passed}/${total} é¡¹é€šè¿‡</h3>`;
            
            for (const [test, result] of Object.entries(testResults)) {
                const status = result ? 'success' : 'error';
                const icon = result ? 'âœ…' : 'âŒ';
                const testNames = {
                    css: 'CSSæ ·å¼å’ŒåŠ¨ç”»',
                    javascript: 'JavaScriptäº¤äº’',
                    highlight: 'ä»£ç é«˜äº® (highlight.js)',
                    katex: 'æ•°å­¦å…¬å¼ (KaTeX)'
                };
                html += `<div class="status ${status}">${icon} ${testNames[test]}</div>`;
            }

            if (passed === total) {
                html += '<div class="status success" style="margin-top: 1rem;">ğŸ‰ æ‰€æœ‰åŠŸèƒ½æ­£å¸¸ï¼æœ¬åœ°åº“å·¥ä½œå®Œç¾ï¼</div>';
            } else {
                html += '<div class="status error" style="margin-top: 1rem;">âš ï¸ éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥åº“æ–‡ä»¶</div>';
            }

            summaryDiv.innerHTML = html;
        }

        // CSSæµ‹è¯•ï¼ˆé€šè¿‡æ£€æŸ¥æ ·å¼æ˜¯å¦åº”ç”¨æ¥åˆ¤æ–­ï¼‰
        function testCSS() {
            // å¦‚æœé¡µé¢æ­£ç¡®æ˜¾ç¤ºäº†æ ·å¼ï¼Œè¯´æ˜CSSå·¥ä½œæ­£å¸¸
            const body = document.body;
            const computedStyle = window.getComputedStyle(body);
            if (computedStyle.backgroundColor === 'rgb(15, 23, 42)') {
                testResults.css = true;
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œæµ‹è¯•
        window.addEventListener('load', function() {
            setTimeout(() => {
                testCSS();
                checkLibraries();
                testHighlight();
                testKaTeX();
                updateSummary();
            }, 500);
        });

        // é”™è¯¯ç›‘æ§
        window.addEventListener('error', function(event) {
            console.error('é¡µé¢é”™è¯¯:', event.error);
        });
    </script>
</body>
</html>