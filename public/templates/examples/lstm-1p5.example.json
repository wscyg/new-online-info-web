{
  "version": "2.0",
  "id": "lstm-chapter-1-5",
  "title": "从 RNN 到 LSTM：为什么序列建模这么难？",
  "subtitle": "",
  "templateId": "lstm-1p5",
  "accent": "purple",
  "pages": [
    {
      "id": "p-hero",
      "page": 0,
      "kind": "hero",
      "accent": "purple",
      "dataTitle": "从 RNN 到 LSTM",
      "dataSub": "",
      "className": "hero- active",
      "rawHtml": "<div class=\"hero-bg\">\n      <div class=\"hero-light-main\"></div>\n      <div class=\"hero-light-purple\"></div>\n      <div class=\"hero-light-pink\"></div>\n      <div class=\"hero-light-blue\"></div>\n    </div>\n    <div class=\"hero-content\">\n      <div class=\"hero-badge\">\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\"/><path d=\"M12 6v6l4 2\"/></svg>\n        深度学习基础\n      </div>\n      <h1 class=\"hero-title\">从 RNN 到 LSTM</h1>\n      <p class=\"hero-subtitle\"><span class=\"typing-text\" data-text=\"为什么序列建模这么难？RNN 为什么会遗忘？\"></span><span class=\"typing-cursor\"></span></p>\n\n      <div class=\"hero-features\">\n        <div class=\"hero-feature\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M13 2L3 14h9l-1 8 10-12h-9l1-8z\"/></svg>\n          <span>递归状态传递</span>\n        </div>\n        <div class=\"hero-feature\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><path d=\"M9 9h6v6H9z\"/></svg>\n          <span>门控记忆机制</span>\n        </div>\n        <div class=\"hero-feature\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M12 2v20M2 12h20\"/><circle cx=\"12\" cy=\"12\" r=\"4\"/></svg>\n          <span>梯度高速公路</span>\n        </div>\n      </div>\n\n      <div class=\"hero-cta-group\">\n        <button class=\"hero-cta-primary\" onclick=\"showPage(1)\">\n          <span>开始学习</span>\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M5 12h14M12 5l7 7-7 7\"/></svg>\n        </button>\n        <button class=\"hero-cta-secondary\" onclick=\"openToc()\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M4 6h16M4 12h16M4 18h16\"/></svg>\n          <span>查看目录</span>\n        </button>\n      </div>\n    </div>\n\n    <div class=\"hero-stats-bar\">\n      <div class=\"hero-stat\">\n        <div class=\"hero-stat-value\">11</div>\n        <div class=\"hero-stat-label\">知识模块</div>\n      </div>\n      <div class=\"hero-stat\">\n        <div class=\"hero-stat-value\">8</div>\n        <div class=\"hero-stat-label\">可视化图解</div>\n      </div>\n      <div class=\"hero-stat\">\n        <div class=\"hero-stat-value\">10+</div>\n        <div class=\"hero-stat-label\">代码示例</div>\n      </div>\n      <div class=\"hero-stat\">\n        <div class=\"hero-stat-value\">1</div>\n        <div class=\"hero-stat-label\">互动实验</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-data-types",
      "page": 1,
      "kind": "section",
      "accent": "purple",
      "dataTitle": "数据类型对比",
      "dataSub": "为什么序列需要特殊对待？",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\" id=\"chaptersNav1\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"为什么序列数据需要特殊对待？\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 01</span>\n      <h2 class=\"section-title\">不同数据类型有什么区别？</h2>\n      <div class=\"prose\">\n        <p>神经网络的结构设计本质上是<span class=\"hl hl-purple\">对数据特点的先验假设</span>。卷积神经网络（CNN）假设\"相邻像素具有强相关性\"，因此使用局部感受野；多层感知机（MLP）假设\"每个输入维度都可能重要\"，因此全连接所有输入。那么，<span class=\"em em-cyan\">序列数据有什么独特性？我们应该做出怎样的假设？</span></p>\n      </div>\n\n      <div class=\"cards-grid\">\n        <div class=\"glass-card\" data-delay=\"100\">\n          <div class=\"card-icon purple\">T</div>\n          <h3 class=\"card-title\">表格数据</h3>\n          <p class=\"card-subtitle\">Tabular Data</p>\n          <p class=\"card-text\"><span class=\"hl hl-purple\">特征维度固定</span>，各列之间无明确顺序依赖，每行样本相互独立。例如用户画像、商品属性等。<br/><br/>适用模型：<span class=\"em em-purple\">MLP / 树模型</span></p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"200\">\n          <div class=\"card-icon pink\">I</div>\n          <h3 class=\"card-title\">图片数据</h3>\n          <p class=\"card-subtitle\">Image Data</p>\n          <p class=\"card-text\"><span class=\"hl hl-pink\">空间尺寸固定</span>，相邻像素高度相关，具有平移不变性。例如图像分类、目标检测等。<br/><br/>适用模型：<span class=\"em em-pink\">CNN</span></p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"300\">\n          <div class=\"card-icon cyan\">S</div>\n          <h3 class=\"card-title\">序列数据</h3>\n          <p class=\"card-subtitle\">Sequential Data</p>\n          <p class=\"card-text\"><span class=\"hl hl-cyan\">长度可变</span>，元素顺序携带关键信息，远距离元素可能存在强依赖。例如文本、语音、时间序列等。<br/><br/>适用模型：<span class=\"em em-cyan\">RNN / LSTM / Transformer</span></p>\n        </div>\n      </div>\n\n      <div class=\"example-box\" data-delay=\"400\">\n        <div class=\"example-head\">\n          <div class=\"example-icon\">Ex</div>\n          <div class=\"example-title\">一个爱情故事：顺序如何改变一切</div>\n        </div>\n        <div class=\"example-body\">\n          <div class=\"example-code\">\n            <span class=\"comment\">// 同样的三个字，上演截然不同的剧情...</span><br/><br/>\n            <span class=\"string\">\"我 爱 你\"</span> → 😊 深情告白，等待回应...<br/>\n            <span class=\"string\">\"你 爱 我\"</span> → 🤔 小心翼翼地试探对方心意...<br/>\n            <span class=\"string\">\"爱 你 我\"</span> → 😌 像古诗一样，把最重要的放在最前面<br/><br/>\n            <span class=\"comment\">// 😱 词袋模型看到的：{我:1, 爱:1, 你:1} —— 三个故事变成了同一个！</span>\n          </div>\n          <div class=\"example-note\">🤓 <span class=\"hl hl-red\">这就是为什么我们需要序列模型</span>：忽略顺序 = 丢失故事。想象一下，如果 AI 分不清\"我爱你\"和\"你爱我\"，那它永远无法真正理解人类的语言。</div>\n        </div>\n      </div>\n\n      <div class=\"math-block\" data-delay=\"500\">\n        <div class=\"math-title\">数学表示对比</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">表格数据:</span>\n          <span class=\"math-var\">x</span> <span class=\"math-eq\">=</span> [x<sub>1</sub>, x<sub>2</sub>, ..., x<sub>d</sub>] <span class=\"math-comment\">// 固定 d 维向量</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">图片数据:</span>\n          <span class=\"math-var\">X</span> <span class=\"math-eq\">=</span> R<sup>H×W×C</sup> <span class=\"math-comment\">// 固定高宽通道的张量</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">序列数据:</span>\n          <span class=\"math-var\">x</span> <span class=\"math-eq\">=</span> [x<sub>1</sub>, x<sub>2</sub>, ..., x<sub>T</sub>] <span class=\"math-comment\">// T 是可变的！</span>\n        </div>\n        <div class=\"math-result\">问题：神经网络的输入层维度是固定的，如何处理可变长度 T？</div>\n      </div>\n\n      <div class=\"keyline\" data-delay=\"600\">\n        <div class=\"kdot\">Q</div>\n        <div class=\"ktext\"><span class=\"print-text\" data-text=\"序列数据究竟有哪些\"硬约束\"？这些约束对模型设计有什么具体要求？下一节我们逐一分析。\"></span></div>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"700\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">明确了序列数据的独特性后，接下来我们深入分析序列的<span class=\"em em-cyan\">三个核心约束</span>，理解为什么传统方法无法胜任。</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-constraints",
      "page": 2,
      "kind": "section",
      "accent": "cyan",
      "dataTitle": "序列的三个硬约束",
      "dataSub": "变长 + 顺序 + 远依赖",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"变长 · 顺序敏感 · 长距离依赖\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 02</span>\n      <h2 class=\"section-title\">序列数据的三个核心约束</h2>\n      <div class=\"prose\">\n        <p>任何序列模型的设计都必须解决以下三个根本性问题。理解这些约束，才能理解为什么需要 RNN，以及为什么 RNN 还不够。</p>\n      </div>\n\n      <div class=\"cards-grid\">\n        <div class=\"glass-card\" data-delay=\"100\">\n          <div class=\"card-icon green\">L</div>\n          <h3 class=\"card-title\">约束一：变长输入</h3>\n          <p class=\"card-subtitle\">Variable Length</p>\n          <p class=\"card-text\">想象一个翻译官，他可能要翻译一句话\"Hi\"，也可能要翻译一整本书。神经网络的\"耳朵\"大小是固定的，怎么办？<br/><br/>难度：<span class=\"em em-green\">😊 还好，有解</span></p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"200\">\n          <div class=\"card-icon amber\">O</div>\n          <h3 class=\"card-title\">约束二：顺序敏感</h3>\n          <p class=\"card-subtitle\">Order Matters</p>\n          <p class=\"card-text\">😲 \"人咬狗\" → 头条新闻！<br/>😐 \"狗咬人\" → 日常事件...<br/>同样的词，打乱顺序后语义天翻地覆。<br/><br/>难度：<span class=\"em em-amber\">🤔 有点棘手</span></p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"300\">\n          <div class=\"card-icon pink\">D</div>\n          <h3 class=\"card-title\">约束三：长距离依赖</h3>\n          <p class=\"card-subtitle\">Long-range Dependency</p>\n          <p class=\"card-text\">就像跨城传话游戏：第一个人说的话，经过 50 个人，还能完整传到最后吗？通常结果是面目全非 😵<br/><br/>难度：<span class=\"em em-pink\">😰 这才是大Boss！</span></p>\n        </div>\n      </div>\n\n      <div class=\"example-box pink\" data-delay=\"400\">\n        <div class=\"example-head\">\n          <div class=\"example-icon\">Ex</div>\n          <div class=\"example-title\">语法考试：你能通过吗？🤔</div>\n        </div>\n        <div class=\"example-body\">\n          <div class=\"example-code\">\n            <span class=\"comment\">// 来做一道英语填空题：</span><br/><br/>\n            The <span class=\"variable\">cat</span>, which was sitting on the mat, <span class=\"keyword\">___</span> sleeping.<br/><br/>\n            <span class=\"comment\">// 🧐 人类解题思路：</span><br/>\n            <span class=\"comment\">// Step 1: 找主语 → \"cat\" 是单数 ✓</span><br/>\n            <span class=\"comment\">// Step 2: 跳过一大堆干扰词 → \"which was sitting...\"</span><br/>\n            <span class=\"comment\">// Step 3: 用单数动词 → \"was\" ✓✓</span><br/><br/>\n            <span class=\"keyword\">😎 答案</span>：\"was\"（不是 \"were\"）<br/>\n            <span class=\"keyword\">🤯 难点</span>：模型需要\"记住\" 9 个词之前的信息！\n          </div>\n        </div>\n      </div>\n\n      <div class=\"math-block\" data-delay=\"500\">\n        <div class=\"math-title\">依赖距离的量化分析</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">句子结构:</span>\n          [The] [cat] [,] [which] [was] [sitting] [on] [the] [mat] [,] [<span class=\"math-var\">___</span>] [sleeping]\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">位置索引:</span>\n          &nbsp;&nbsp;1 &nbsp;&nbsp;&nbsp; 2 &nbsp;&nbsp; 3 &nbsp;&nbsp;&nbsp; 4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7 &nbsp;&nbsp;&nbsp; 8 &nbsp;&nbsp;&nbsp; 9 &nbsp;&nbsp; 10 &nbsp;&nbsp;&nbsp; <span class=\"math-num\">11</span> &nbsp;&nbsp;&nbsp;&nbsp; 12\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">依赖距离:</span>\n          d = 11 - 2 = <span class=\"math-num\">9</span> 个位置\n        </div>\n        <div class=\"math-result\">模型需要将位置 2 的语法特征（单数）传递到位置 11，跨越 9 个 token！</div>\n      </div>\n\n      <!-- SVG: Long-range Dependency Visualization -->\n      <div class=\"diagram-container\" data-delay=\"550\">\n        <svg viewBox=\"0 0 800 140\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <defs>\n            <linearGradient id=\"depGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop offset=\"0%\" stop-color=\"#f093fb\"/><stop offset=\"100%\" stop-color=\"#4facfe\"/>\n            </linearGradient>\n          </defs>\n          <!-- Words -->\n          <g class=\"svg-fade d1\">\n            <rect x=\"20\" y=\"60\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(240,147,251,0.2)\" stroke=\"#f093fb\" stroke-width=\"1.5\"/>\n            <text x=\"45\" y=\"82\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"11\">The</text>\n          </g>\n          <g class=\"svg-fade d1\">\n            <rect x=\"80\" y=\"60\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(240,147,251,0.3)\" stroke=\"#f093fb\" stroke-width=\"2\"/>\n            <text x=\"105\" y=\"82\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"11\" font-weight=\"600\">cat</text>\n            <text x=\"105\" y=\"110\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"9\">单数</text>\n          </g>\n          <g class=\"svg-fade d2\">\n            <rect x=\"140\" y=\"60\" width=\"280\" height=\"35\" rx=\"6\" fill=\"rgba(255,255,255,0.03)\" stroke=\"rgba(255,255,255,0.15)\" stroke-width=\"1\" stroke-dasharray=\"4,4\"/>\n            <text x=\"280\" y=\"82\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"11\">, which was sitting on the mat ,</text>\n            <text x=\"280\" y=\"50\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.3)\" font-size=\"9\">定语从句（7个词）</text>\n          </g>\n          <g class=\"svg-fade d3\">\n            <rect x=\"430\" y=\"60\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(79,172,254,0.3)\" stroke=\"#4facfe\" stroke-width=\"2\"/>\n            <text x=\"455\" y=\"82\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"11\" font-weight=\"600\">was</text>\n            <text x=\"455\" y=\"110\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"9\">单数</text>\n          </g>\n          <g class=\"svg-fade d3\">\n            <rect x=\"490\" y=\"60\" width=\"70\" height=\"35\" rx=\"6\" fill=\"rgba(255,255,255,0.03)\" stroke=\"rgba(255,255,255,0.15)\" stroke-width=\"1\"/>\n            <text x=\"525\" y=\"82\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"11\">sleeping</text>\n          </g>\n          <!-- Dependency Arc -->\n          <path d=\"M105 60 Q280 0 455 60\" stroke=\"url(#depGrad)\" stroke-width=\"2\" fill=\"none\" stroke-dasharray=\"6,3\" class=\"svg-path d2\"/>\n          <g class=\"svg-fade d4\">\n            <circle cx=\"280\" cy=\"20\" r=\"14\" fill=\"rgba(240,147,251,0.15)\" stroke=\"#f093fb\" stroke-width=\"1.5\"/>\n            <text x=\"280\" y=\"25\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"10\" font-weight=\"600\">9</text>\n            <text x=\"320\" y=\"25\" fill=\"rgba(255,255,255,0.5)\" font-size=\"9\">token 距离</text>\n          </g>\n          <!-- Legend -->\n          <g class=\"svg-fade d5\">\n            <text x=\"620\" y=\"50\" fill=\"rgba(255,255,255,0.6)\" font-size=\"11\">信息传递路径：</text>\n            <text x=\"620\" y=\"70\" fill=\"#f9a8d4\" font-size=\"10\">cat (位置2)</text>\n            <text x=\"620\" y=\"85\" fill=\"rgba(255,255,255,0.4)\" font-size=\"10\">→ 跨越 9 个位置</text>\n            <text x=\"620\" y=\"100\" fill=\"#67e8f9\" font-size=\"10\">→ was (位置11)</text>\n          </g>\n        </svg>\n      </div>\n\n      <div class=\"keyline\" data-delay=\"600\">\n        <div class=\"kdot\">*</div>\n        <div class=\"ktext\"><span class=\"print-text\" data-text=\"长距离依赖是序列建模的核心难题——它要求模型不仅能\"记住\"远处的信息，还能在需要时准确\"调用\"。这正是后面我们要解决的问题。\"></span></div>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"700\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">既然知道了问题，先看看<span class=\"em em-amber\">传统方法为什么失败</span>。理解失败的原因，才能理解 RNN 的设计动机。</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-dead-ends",
      "page": 3,
      "kind": "section",
      "accent": "pink",
      "dataTitle": "三条死路",
      "dataSub": "传统方法为什么失败",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"Padding · BoW · N-gram 都失败了\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 03</span>\n      <h2 class=\"section-title\">传统方法为什么行不通？</h2>\n      <div class=\"prose\">\n        <p>在 RNN 出现之前，人们尝试过很多\"工程补丁\"来处理序列数据。理解这些方法的局限性，能帮助我们更深刻地理解 RNN 的设计动机。</p>\n      </div>\n\n      <div class=\"cards-grid\">\n        <div class=\"glass-card\" data-delay=\"100\">\n          <div class=\"card-icon pink\">P</div>\n          <h3 class=\"card-title\">方法一：Padding / Truncation</h3>\n          <p class=\"card-subtitle\">强制统一长度</p>\n          <p class=\"card-text\">把所有序列填充或截断到相同长度，然后用 MLP 处理。<br/><br/><span class=\"hl hl-pink\">致命问题：</span>短序列填充 PAD token 浪费计算资源；长序列截断会丢失关键信息。本质上是回避问题，而非解决问题。</p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"200\">\n          <div class=\"card-icon amber\">B</div>\n          <h3 class=\"card-title\">方法二：词袋模型 BoW</h3>\n          <p class=\"card-subtitle\">忽略顺序，只统计词频</p>\n          <p class=\"card-text\">将文本表示为词频向量，完全忽略词的顺序。<br/><br/><span class=\"hl hl-amber\">致命问题：</span>\"人咬狗\"和\"狗咬人\"的词袋表示完全相同。直接放弃了\"顺序\"这一核心约束。</p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"300\">\n          <div class=\"card-icon purple\">N</div>\n          <h3 class=\"card-title\">方法三：N-gram 模型</h3>\n          <p class=\"card-subtitle\">固定窗口捕捉局部模式</p>\n          <p class=\"card-text\">将连续 n 个词作为一个单元，捕捉局部上下文。<br/><br/><span class=\"hl hl-purple\">致命问题：</span>窗口太小无法捕捉长距离依赖；窗口太大则特征空间指数爆炸，稀疏性严重。</p>\n        </div>\n      </div>\n\n      <!-- SVG: Traditional Methods Failure Visualization -->\n      <div class=\"diagram-container\" data-delay=\"380\">\n        <svg viewBox=\"0 0 800 160\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <defs>\n            <linearGradient id=\"failGrad1\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#f093fb\"/><stop offset=\"100%\" stop-color=\"#f5576c\"/>\n            </linearGradient>\n            <linearGradient id=\"failGrad2\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#fbbf24\"/><stop offset=\"100%\" stop-color=\"#f97316\"/>\n            </linearGradient>\n            <linearGradient id=\"failGrad3\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#667eea\"/><stop offset=\"100%\" stop-color=\"#764ba2\"/>\n            </linearGradient>\n          </defs>\n          <!-- Method 1: Padding -->\n          <g class=\"svg-fade d1\">\n            <rect x=\"30\" y=\"30\" width=\"200\" height=\"100\" rx=\"12\" fill=\"rgba(240,147,251,0.1)\" stroke=\"url(#failGrad1)\" stroke-width=\"2\"/>\n            <text x=\"130\" y=\"55\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"12\" font-weight=\"600\">Padding/Truncation</text>\n            <g>\n              <rect x=\"50\" y=\"70\" width=\"30\" height=\"20\" rx=\"4\" fill=\"rgba(240,147,251,0.3)\"/>\n              <text x=\"65\" y=\"84\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"9\">词1</text>\n              <rect x=\"85\" y=\"70\" width=\"30\" height=\"20\" rx=\"4\" fill=\"rgba(240,147,251,0.3)\"/>\n              <text x=\"100\" y=\"84\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"9\">词2</text>\n              <rect x=\"120\" y=\"70\" width=\"30\" height=\"20\" rx=\"4\" fill=\"rgba(255,255,255,0.1)\" stroke=\"rgba(255,255,255,0.2)\" stroke-dasharray=\"3,2\"/>\n              <text x=\"135\" y=\"84\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"8\">PAD</text>\n              <rect x=\"155\" y=\"70\" width=\"30\" height=\"20\" rx=\"4\" fill=\"rgba(255,255,255,0.1)\" stroke=\"rgba(255,255,255,0.2)\" stroke-dasharray=\"3,2\"/>\n              <text x=\"170\" y=\"84\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"8\">PAD</text>\n              <rect x=\"190\" y=\"70\" width=\"30\" height=\"20\" rx=\"4\" fill=\"rgba(255,255,255,0.1)\" stroke=\"rgba(255,255,255,0.2)\" stroke-dasharray=\"3,2\"/>\n              <text x=\"205\" y=\"84\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"8\">PAD</text>\n            </g>\n            <text x=\"130\" y=\"115\" text-anchor=\"middle\" fill=\"#f87171\" font-size=\"10\">✗ 浪费资源 / 丢失信息</text>\n          </g>\n          <!-- Method 2: BoW -->\n          <g class=\"svg-fade d2\">\n            <rect x=\"280\" y=\"30\" width=\"200\" height=\"100\" rx=\"12\" fill=\"rgba(251,191,36,0.1)\" stroke=\"url(#failGrad2)\" stroke-width=\"2\"/>\n            <text x=\"380\" y=\"55\" text-anchor=\"middle\" fill=\"#fcd34d\" font-size=\"12\" font-weight=\"600\">Bag of Words</text>\n            <g>\n              <text x=\"310\" y=\"78\" fill=\"rgba(255,255,255,0.6)\" font-size=\"10\">\"我 爱 你\"</text>\n              <text x=\"380\" y=\"78\" fill=\"rgba(255,255,255,0.4)\" font-size=\"10\">→</text>\n              <text x=\"430\" y=\"78\" fill=\"#fcd34d\" font-size=\"10\">{我:1, 爱:1, 你:1}</text>\n            </g>\n            <g>\n              <text x=\"310\" y=\"96\" fill=\"rgba(255,255,255,0.6)\" font-size=\"10\">\"你 爱 我\"</text>\n              <text x=\"380\" y=\"96\" fill=\"rgba(255,255,255,0.4)\" font-size=\"10\">→</text>\n              <text x=\"430\" y=\"96\" fill=\"#fcd34d\" font-size=\"10\">{我:1, 爱:1, 你:1}</text>\n            </g>\n            <text x=\"380\" y=\"115\" text-anchor=\"middle\" fill=\"#f87171\" font-size=\"10\">✗ 完全相同！丢失顺序</text>\n          </g>\n          <!-- Method 3: N-gram -->\n          <g class=\"svg-fade d3\">\n            <rect x=\"530\" y=\"30\" width=\"230\" height=\"100\" rx=\"12\" fill=\"rgba(102,126,234,0.1)\" stroke=\"url(#failGrad3)\" stroke-width=\"2\"/>\n            <text x=\"645\" y=\"55\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"12\" font-weight=\"600\">N-gram (n=3)</text>\n            <g>\n              <text x=\"560\" y=\"80\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">窗口大小 = 3</text>\n              <text x=\"560\" y=\"96\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">依赖距离 = 9</text>\n            </g>\n            <g>\n              <rect x=\"680\" y=\"68\" width=\"60\" height=\"30\" rx=\"6\" fill=\"rgba(248,113,113,0.2)\" stroke=\"#f87171\" stroke-width=\"1.5\"/>\n              <text x=\"710\" y=\"78\" text-anchor=\"middle\" fill=\"#fca5a5\" font-size=\"9\">无法捕捉</text>\n              <text x=\"710\" y=\"90\" text-anchor=\"middle\" fill=\"#fca5a5\" font-size=\"9\">长距离</text>\n            </g>\n            <text x=\"645\" y=\"115\" text-anchor=\"middle\" fill=\"#f87171\" font-size=\"10\">✗ 特征空间指数爆炸</text>\n          </g>\n        </svg>\n      </div>\n\n      <div class=\"math-block\" data-delay=\"400\">\n        <div class=\"math-title\">N-gram 特征空间爆炸的数学分析</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">词表大小:</span>\n          <span class=\"math-var\">V</span> <span class=\"math-eq\">=</span> <span class=\"math-num\">50,000</span> <span class=\"math-comment\">// 典型英文词表</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">1-gram:</span>\n          特征数 <span class=\"math-eq\">=</span> V <span class=\"math-eq\">=</span> 5×10<sup>4</sup>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">2-gram:</span>\n          特征数 <span class=\"math-eq\">=</span> V<sup>2</sup> <span class=\"math-eq\">=</span> 2.5×10<sup>9</sup>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">3-gram:</span>\n          特征数 <span class=\"math-eq\">=</span> V<sup>3</sup> <span class=\"math-eq\">=</span> 1.25×10<sup>14</sup>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">10-gram:</span>\n          特征数 <span class=\"math-eq\">=</span> V<sup>10</sup> <span class=\"math-eq\">=</span> <span class=\"math-num\">10<sup>47</sup></span> <span class=\"math-comment\">// 比宇宙原子数还多！</span>\n        </div>\n        <div class=\"math-result\">N-gram 无法扩展到长距离依赖，这是根本性的数学限制</div>\n      </div>\n\n      <div class=\"example-box amber\" data-delay=\"500\">\n        <div class=\"example-head\">\n          <div class=\"example-icon\">X</div>\n          <div class=\"example-title\">N-gram 的局限性分析</div>\n        </div>\n        <div class=\"example-body\">\n          <div class=\"example-code\">\n            <span class=\"comment\">// 假设使用 3-gram 模型</span><br/><br/>\n            <span class=\"string\">\"The cat was\"</span><br/>\n            → 3-gram 可以看到 (The, cat, was) 这个组合<br/><br/>\n            <span class=\"string\">\"The cat, which was sitting on the mat, was sleeping.\"</span><br/>\n            → 主语 cat 和谓语 was 之间隔了 7 个词<br/>\n            → <span class=\"variable\">3-gram 完全无法捕捉这个依赖关系</span><br/><br/>\n            <span class=\"comment\">// 结论：固定窗口永远无法适应可变的依赖距离</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"sticky-note pink\" data-delay=\"600\">\n        <div class=\"sticky-title\">关键转折点</div>\n        <p class=\"sticky-text\">既然无法\"一次性看完全部\"，那就模仿人类阅读的方式：<b>逐个读取，边读边更新理解</b>。这个简单而深刻的想法，正是 RNN 的核心思想。</p>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"700\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">传统方法都失败了。接下来，让我们看看 RNN 是如何通过<span class=\"em em-purple\">\"状态递归\"</span>这一优雅的设计来解决变长和顺序问题的。</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-rnn-intro",
      "page": 4,
      "kind": "section",
      "accent": "purple",
      "dataTitle": "RNN 引入",
      "dataSub": "状态随时间更新",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"边读边更新，状态随时间递归\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 04</span>\n      <h2 class=\"section-title\">RNN：递归神经网络的核心思想</h2>\n      <div class=\"prose\">\n        <p>RNN 的核心设计非常优雅：使用一个<span class=\"hl hl-purple\">隐状态向量 h<sub>t</sub></span>来累积\"到目前为止读到的所有信息\"。每处理一个新的输入元素，就基于当前输入和历史状态更新这个隐状态。这种\"边读边更新\"的机制完美模拟了人类阅读的过程。</p>\n      </div>\n\n      <div class=\"formula-box\" data-delay=\"100\">\n        <div class=\"formula-label\">RNN 核心递推公式</div>\n        <div class=\"formula-main\">$$h_t = \\tanh(W_{xh} \\cdot x_t + W_{hh} \\cdot h_{t-1} + b_h)$$</div>\n        <p class=\"formula-desc\">\n          <span class=\"hl hl-cyan\">h<sub>t</sub></span> = 时刻 t 的隐状态，编码了从序列开始到当前位置的所有信息<br/>\n          <span class=\"hl hl-green\">x<sub>t</sub></span> = 时刻 t 的输入（如当前词的词向量 embedding）<br/>\n          <span class=\"hl hl-amber\">h<sub>t-1</sub></span> = 上一时刻的隐状态，携带历史信息<br/>\n          <span class=\"hl hl-purple\">W<sub>xh</sub>, W<sub>hh</sub></span> = 可学习的权重矩阵，在所有时刻共享\n        </p>\n      </div>\n\n      <div class=\"think-box\" data-delay=\"150\">\n        <div class=\"think-icon\">🤔</div>\n        <div class=\"think-content\">\n          <div class=\"think-title\">为什么使用 tanh 而不是其他激活函数？</div>\n          <p class=\"think-text\">\n            <b>1. 输出范围 [-1, 1]</b>：tanh 的输出以 0 为中心，可以表示正向和负向的信息变化，比 sigmoid [0,1] 更适合隐状态表示。<br/>\n            <b>2. 梯度饱和特性</b>：在输入绝对值较大时梯度接近 0，可以稳定长序列的训练，但这也是导致梯度消失的原因之一。<br/>\n            <b>3. 历史原因</b>：早期 RNN 设计时 ReLU 尚未流行，tanh 是当时的首选非线性函数。\n          </p>\n        </div>\n      </div>\n\n      <!-- Code + Diagram: RNN Implementation -->\n      <div class=\"annotation-hint\" data-delay=\"175\">\n        <span class=\"annotation-hint-icon\">?</span>\n        <span>悬停代码行左侧的数字标记查看对应图解说明；图中相同数字标记与代码对应</span>\n      </div>\n      <div class=\"code-diagram-split\" data-delay=\"180\">\n        <div class=\"code-panel\">\n          <div class=\"code-panel-header\">\n            <div class=\"code-panel-dots\"><span></span><span></span><span></span></div>\n            <span class=\"code-panel-title\">rnn_cell.py</span>\n          </div>\n          <div class=\"code-panel-body\" style=\"padding-left:32px;\">\n<span class=\"keyword\">import</span> torch<br/>\n<span class=\"keyword\">import</span> torch.nn <span class=\"keyword\">as</span> nn<br/><br/>\n<span class=\"keyword\">class</span> <span class=\"function\">SimpleRNN</span>(nn.Module):<br/>\n&nbsp;&nbsp;<span class=\"keyword\">def</span> <span class=\"function\">__init__</span>(<span class=\"variable\">self</span>, input_size, hidden_size):<br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-cyan\">1</span><span class=\"variable\">self</span>.W_xh <span class=\"operator\">=</span> nn.Linear(input_size, hidden_size)<span class=\"code-annotation-tip\">→ 对应图中 x_t → tanh 的连线</span></span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-amber\">2</span><span class=\"variable\">self</span>.W_hh <span class=\"operator\">=</span> nn.Linear(hidden_size, hidden_size)<span class=\"code-annotation-tip\">→ 对应图中 h_{t-1} → tanh 的连线</span></span><br/><br/>\n&nbsp;&nbsp;<span class=\"keyword\">def</span> <span class=\"function\">forward</span>(<span class=\"variable\">self</span>, x_t, h_prev):<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\"># 核心递推公式</span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-purple\">3</span>h_t <span class=\"operator\">=</span> torch.<span class=\"function\">tanh</span>(<span class=\"code-annotation-tip\">→ 对应图中 tanh 激活框</span></span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-cyan\" style=\"opacity:0.5\">1</span><span class=\"variable\">self</span>.W_xh(x_t) <span class=\"operator\">+</span> <span style=\"position:relative;\"><span class=\"code-marker m-amber\" style=\"left:auto; position:relative; display:inline-flex; margin-left:4px; margin-right:4px;\">2</span></span><span class=\"variable\">self</span>.W_hh(h_prev)</span><br/>\n&nbsp;&nbsp;&nbsp;&nbsp;)<br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-green\">4</span><span class=\"keyword\">return</span> h_t<span class=\"code-annotation-tip\">→ 对应图中右侧 h_t 输出</span></span>\n          </div>\n        </div>\n        <div class=\"diagram-panel\">\n          <svg viewBox=\"0 0 280 200\" fill=\"none\">\n            <defs>\n              <linearGradient id=\"rnnCellGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                <stop offset=\"0%\" stop-color=\"#667eea\"/><stop offset=\"100%\" stop-color=\"#764ba2\"/>\n              </linearGradient>\n            </defs>\n            <!-- RNN Cell -->\n            <rect x=\"90\" y=\"60\" width=\"100\" height=\"80\" rx=\"12\" fill=\"rgba(102,126,234,0.15)\" stroke=\"url(#rnnCellGrad)\" stroke-width=\"2\"/>\n            <text x=\"140\" y=\"95\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"14\" font-weight=\"600\">tanh</text>\n            <text x=\"140\" y=\"115\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">h_t = tanh(...)</text>\n            <!-- 标注 3: tanh 框 -->\n            <circle cx=\"90\" cy=\"60\" r=\"10\" fill=\"url(#rnnCellGrad)\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"90\" y=\"64\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"9\" font-weight=\"700\">3</text>\n            <!-- Input x_t -->\n            <rect x=\"10\" y=\"85\" width=\"50\" height=\"30\" rx=\"6\" fill=\"rgba(79,172,254,0.2)\" stroke=\"#4facfe\" stroke-width=\"1.5\"/>\n            <text x=\"35\" y=\"105\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"11\">x_t</text>\n            <path d=\"M60 100 L90 100\" stroke=\"#4facfe\" stroke-width=\"2\" marker-end=\"url(#rnnArrow)\"/>\n            <!-- 标注 1: x_t 输入 -->\n            <circle cx=\"10\" cy=\"85\" r=\"10\" fill=\"linear-gradient(135deg, #06b6d4, #22d3ee)\" style=\"fill:#06b6d4\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"10\" y=\"89\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"9\" font-weight=\"700\">1</text>\n            <!-- Previous hidden h_{t-1} -->\n            <rect x=\"115\" y=\"160\" width=\"50\" height=\"30\" rx=\"6\" fill=\"rgba(251,191,36,0.2)\" stroke=\"#fbbf24\" stroke-width=\"1.5\"/>\n            <text x=\"140\" y=\"180\" text-anchor=\"middle\" fill=\"#fcd34d\" font-size=\"10\">h_{t-1}</text>\n            <path d=\"M140 160 L140 140\" stroke=\"#fbbf24\" stroke-width=\"2\" marker-end=\"url(#rnnArrow)\"/>\n            <!-- 标注 2: h_{t-1} -->\n            <circle cx=\"115\" cy=\"160\" r=\"10\" fill=\"#f59e0b\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"115\" y=\"164\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"9\" font-weight=\"700\">2</text>\n            <!-- Output h_t -->\n            <rect x=\"220\" y=\"85\" width=\"50\" height=\"30\" rx=\"6\" fill=\"rgba(52,211,153,0.2)\" stroke=\"#34d399\" stroke-width=\"1.5\"/>\n            <text x=\"245\" y=\"105\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"11\">h_t</text>\n            <path d=\"M190 100 L220 100\" stroke=\"#34d399\" stroke-width=\"2\" marker-end=\"url(#rnnArrow)\"/>\n            <!-- 标注 4: h_t 输出 -->\n            <circle cx=\"270\" cy=\"85\" r=\"10\" fill=\"#10b981\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"270\" y=\"89\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"9\" font-weight=\"700\">4</text>\n            <!-- Recurrent arrow -->\n            <path d=\"M245 115 L245 180 L165 180\" stroke=\"rgba(251,191,36,0.5)\" stroke-width=\"1.5\" stroke-dasharray=\"4,3\"/>\n            <text x=\"210\" y=\"175\" fill=\"rgba(255,255,255,0.4)\" font-size=\"9\">递归</text>\n          </svg>\n        </div>\n      </div>\n\n      <div class=\"math-block\" data-delay=\"200\">\n        <div class=\"math-title\">🧐 具体数值计算示例</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">假设:</span>\n          $h_t \\in \\mathbb{R}^3, x_t \\in \\mathbb{R}^2$，即隐状态3维，输入2维\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">参数:</span>\n          $W_{xh} \\in \\mathbb{R}^{3 \\times 2}, W_{hh} \\in \\mathbb{R}^{3 \\times 3}, b \\in \\mathbb{R}^3$\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">输入:</span>\n          $x_1 = [0.5, 0.3], h_0 = [0, 0, 0]$\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">计算:</span>\n          $z = W_{xh} \\cdot x_1 + W_{hh} \\cdot h_0 + b = [0.4, -0.2, 0.6]$\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">激活:</span>\n          $h_1 = \\tanh(z) = [0.38, -0.20, 0.54]$\n        </div>\n        <div class=\"math-result\">😎 $h_1$ 现在编码了第一个输入 $x_1$ 的信息！</div>\n      </div>\n\n      <!-- SVG: RNN Unrolled Visualization -->\n      <div class=\"diagram-container\" data-delay=\"250\">\n        <svg viewBox=\"0 0 800 180\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <defs>\n            <linearGradient id=\"rnnGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#667eea\"/><stop offset=\"100%\" stop-color=\"#764ba2\"/>\n            </linearGradient>\n            <linearGradient id=\"inputGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#4facfe\"/><stop offset=\"100%\" stop-color=\"#00f2fe\"/>\n            </linearGradient>\n            <linearGradient id=\"outputGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#34d399\"/><stop offset=\"100%\" stop-color=\"#4facfe\"/>\n            </linearGradient>\n            <marker id=\"rnnArrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\" markerUnits=\"strokeWidth\">\n              <path d=\"M0,0 L0,6 L9,3 z\" fill=\"#a5b4fc\"/>\n            </marker>\n          </defs>\n          <!-- Input Layer -->\n          <g class=\"svg-fade d1\">\n            <text x=\"40\" y=\"160\" fill=\"rgba(255,255,255,0.5)\" font-size=\"11\">输入</text>\n            <rect x=\"100\" y=\"140\" width=\"50\" height=\"30\" rx=\"6\" fill=\"rgba(79,172,254,0.2)\" stroke=\"url(#inputGrad)\" stroke-width=\"1.5\"/>\n            <text x=\"125\" y=\"160\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"11\" font-weight=\"500\">x₁</text>\n            <rect x=\"250\" y=\"140\" width=\"50\" height=\"30\" rx=\"6\" fill=\"rgba(79,172,254,0.2)\" stroke=\"url(#inputGrad)\" stroke-width=\"1.5\"/>\n            <text x=\"275\" y=\"160\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"11\" font-weight=\"500\">x₂</text>\n            <rect x=\"400\" y=\"140\" width=\"50\" height=\"30\" rx=\"6\" fill=\"rgba(79,172,254,0.2)\" stroke=\"url(#inputGrad)\" stroke-width=\"1.5\"/>\n            <text x=\"425\" y=\"160\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"11\" font-weight=\"500\">x₃</text>\n            <text x=\"530\" y=\"160\" fill=\"rgba(255,255,255,0.4)\" font-size=\"14\">...</text>\n            <rect x=\"600\" y=\"140\" width=\"50\" height=\"30\" rx=\"6\" fill=\"rgba(79,172,254,0.2)\" stroke=\"url(#inputGrad)\" stroke-width=\"1.5\"/>\n            <text x=\"625\" y=\"160\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"11\" font-weight=\"500\">x<tspan baseline-shift=\"sub\" font-size=\"8\">T</tspan></text>\n          </g>\n          <!-- Hidden Layer (RNN cells) -->\n          <g class=\"svg-fade d2\">\n            <text x=\"40\" y=\"90\" fill=\"rgba(255,255,255,0.5)\" font-size=\"11\">隐状态</text>\n            <rect x=\"90\" y=\"65\" width=\"70\" height=\"50\" rx=\"10\" fill=\"rgba(102,126,234,0.15)\" stroke=\"url(#rnnGrad)\" stroke-width=\"2\"/>\n            <text x=\"125\" y=\"95\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"14\" font-weight=\"600\">h₁</text>\n            <rect x=\"240\" y=\"65\" width=\"70\" height=\"50\" rx=\"10\" fill=\"rgba(102,126,234,0.15)\" stroke=\"url(#rnnGrad)\" stroke-width=\"2\"/>\n            <text x=\"275\" y=\"95\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"14\" font-weight=\"600\">h₂</text>\n            <rect x=\"390\" y=\"65\" width=\"70\" height=\"50\" rx=\"10\" fill=\"rgba(102,126,234,0.15)\" stroke=\"url(#rnnGrad)\" stroke-width=\"2\"/>\n            <text x=\"425\" y=\"95\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"14\" font-weight=\"600\">h₃</text>\n            <text x=\"530\" y=\"90\" fill=\"rgba(255,255,255,0.4)\" font-size=\"14\">...</text>\n            <rect x=\"590\" y=\"65\" width=\"70\" height=\"50\" rx=\"10\" fill=\"rgba(102,126,234,0.15)\" stroke=\"url(#rnnGrad)\" stroke-width=\"2\"/>\n            <text x=\"625\" y=\"95\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"14\" font-weight=\"600\">h<tspan baseline-shift=\"sub\" font-size=\"10\">T</tspan></text>\n          </g>\n          <!-- Arrows: input to hidden -->\n          <g class=\"svg-fade d3\">\n            <path d=\"M125 140 L125 115\" stroke=\"url(#inputGrad)\" stroke-width=\"1.5\" marker-end=\"url(#rnnArrow)\"/>\n            <path d=\"M275 140 L275 115\" stroke=\"url(#inputGrad)\" stroke-width=\"1.5\" marker-end=\"url(#rnnArrow)\"/>\n            <path d=\"M425 140 L425 115\" stroke=\"url(#inputGrad)\" stroke-width=\"1.5\" marker-end=\"url(#rnnArrow)\"/>\n            <path d=\"M625 140 L625 115\" stroke=\"url(#inputGrad)\" stroke-width=\"1.5\" marker-end=\"url(#rnnArrow)\"/>\n          </g>\n          <!-- Arrows: hidden to hidden (recurrent connections) -->\n          <path d=\"M160 90 L240 90\" stroke=\"url(#rnnGrad)\" stroke-width=\"2\" marker-end=\"url(#rnnArrow)\" class=\"svg-path d2\"/>\n          <path d=\"M310 90 L390 90\" stroke=\"url(#rnnGrad)\" stroke-width=\"2\" marker-end=\"url(#rnnArrow)\" class=\"svg-path d3\"/>\n          <path d=\"M460 90 L520 90\" stroke=\"url(#rnnGrad)\" stroke-width=\"2\" stroke-dasharray=\"4,3\" class=\"svg-path d4\"/>\n          <path d=\"M540 90 L590 90\" stroke=\"url(#rnnGrad)\" stroke-width=\"2\" marker-end=\"url(#rnnArrow)\" class=\"svg-path d4\"/>\n          <!-- Weight sharing annotation -->\n          <g class=\"svg-fade d4\">\n            <text x=\"200\" y=\"55\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"9\">W<tspan baseline-shift=\"sub\" font-size=\"7\">hh</tspan></text>\n            <text x=\"350\" y=\"55\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"9\">W<tspan baseline-shift=\"sub\" font-size=\"7\">hh</tspan></text>\n          </g>\n          <!-- Output annotation -->\n          <g class=\"svg-fade d5\">\n            <path d=\"M625 65 L625 35\" stroke=\"url(#outputGrad)\" stroke-width=\"1.5\" marker-end=\"url(#rnnArrow)\"/>\n            <text x=\"625\" y=\"25\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"11\">输出</text>\n            <text x=\"720\" y=\"90\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">权重共享</text>\n            <text x=\"720\" y=\"105\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">时间展开</text>\n          </g>\n        </svg>\n      </div>\n\n      <!-- 信息流动画：渐变衰减可视化 -->\n      <div class=\"diagram-container\" data-delay=\"280\">\n        <div style=\"text-align:center; margin-bottom:12px; color:rgba(255,255,255,0.6); font-size:13px;\">\n          🤔 信息如何在时间步之间流动？（颜色越浅 = 信息越少）\n        </div>\n        <svg viewBox=\"0 0 800 120\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <defs>\n            <!-- 信息衰减渐变 -->\n            <linearGradient id=\"flowDecay\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop offset=\"0%\" stop-color=\"#a78bfa\"/>\n              <stop offset=\"30%\" stop-color=\"#c4b5fd\"/>\n              <stop offset=\"60%\" stop-color=\"#e9d5ff\"/>\n              <stop offset=\"100%\" stop-color=\"rgba(233,213,255,0.2)\"/>\n            </linearGradient>\n            <!-- 动画流动路径 -->\n            <linearGradient id=\"flowAnim\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop offset=\"0%\" stop-color=\"#8b5cf6\">\n                <animate attributeName=\"stop-color\" values=\"#8b5cf6;#c4b5fd;#8b5cf6\" dur=\"2s\" repeatCount=\"indefinite\"/>\n              </stop>\n              <stop offset=\"50%\" stop-color=\"#c4b5fd\">\n                <animate attributeName=\"stop-color\" values=\"#c4b5fd;#e9d5ff;#c4b5fd\" dur=\"2s\" repeatCount=\"indefinite\"/>\n              </stop>\n              <stop offset=\"100%\" stop-color=\"#e9d5ff\">\n                <animate attributeName=\"stop-color\" values=\"#e9d5ff;rgba(233,213,255,0.3);#e9d5ff\" dur=\"2s\" repeatCount=\"indefinite\"/>\n              </stop>\n            </linearGradient>\n          </defs>\n\n          <!-- 信息块 -->\n          <g class=\"svg-fade d1\">\n            <rect x=\"50\" y=\"35\" width=\"80\" height=\"50\" rx=\"10\" fill=\"rgba(139,92,246,0.3)\" stroke=\"#a78bfa\" stroke-width=\"2\"/>\n            <text x=\"90\" y=\"65\" text-anchor=\"middle\" fill=\"#c4b5fd\" font-size=\"14\" font-weight=\"600\">h₁</text>\n            <text x=\"90\" y=\"100\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">100%</text>\n          </g>\n\n          <g class=\"svg-fade d2\">\n            <rect x=\"200\" y=\"35\" width=\"80\" height=\"50\" rx=\"10\" fill=\"rgba(139,92,246,0.2)\" stroke=\"#c4b5fd\" stroke-width=\"2\"/>\n            <text x=\"240\" y=\"65\" text-anchor=\"middle\" fill=\"rgba(196,181,253,0.8)\" font-size=\"14\" font-weight=\"600\">h₂</text>\n            <text x=\"240\" y=\"100\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">~80%</text>\n          </g>\n\n          <g class=\"svg-fade d3\">\n            <rect x=\"350\" y=\"35\" width=\"80\" height=\"50\" rx=\"10\" fill=\"rgba(139,92,246,0.12)\" stroke=\"rgba(196,181,253,0.5)\" stroke-width=\"2\"/>\n            <text x=\"390\" y=\"65\" text-anchor=\"middle\" fill=\"rgba(196,181,253,0.5)\" font-size=\"14\" font-weight=\"600\">h₃</text>\n            <text x=\"390\" y=\"100\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">~50%</text>\n          </g>\n\n          <g class=\"svg-fade d4\">\n            <rect x=\"500\" y=\"35\" width=\"80\" height=\"50\" rx=\"10\" fill=\"rgba(139,92,246,0.06)\" stroke=\"rgba(196,181,253,0.3)\" stroke-width=\"1.5\" stroke-dasharray=\"4,3\"/>\n            <text x=\"540\" y=\"65\" text-anchor=\"middle\" fill=\"rgba(196,181,253,0.3)\" font-size=\"14\" font-weight=\"600\">h<tspan baseline-shift=\"sub\" font-size=\"10\">t</tspan></text>\n            <text x=\"540\" y=\"100\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"10\">≈0% 😢</text>\n          </g>\n\n          <!-- 流动曲线 -->\n          <path d=\"M130 60 Q165 40 200 60\" stroke=\"url(#flowAnim)\" stroke-width=\"3\" fill=\"none\" class=\"svg-path d1\">\n            <animate attributeName=\"stroke-dashoffset\" from=\"100\" to=\"0\" dur=\"1.5s\" repeatCount=\"indefinite\"/>\n          </path>\n          <path d=\"M280 60 Q315 40 350 60\" stroke=\"url(#flowAnim)\" stroke-width=\"2.5\" fill=\"none\" class=\"svg-path d2\" opacity=\"0.7\">\n            <animate attributeName=\"stroke-dashoffset\" from=\"100\" to=\"0\" dur=\"1.5s\" repeatCount=\"indefinite\"/>\n          </path>\n          <path d=\"M430 60 Q465 40 500 60\" stroke=\"url(#flowAnim)\" stroke-width=\"2\" fill=\"none\" class=\"svg-path d3\" opacity=\"0.4\">\n            <animate attributeName=\"stroke-dashoffset\" from=\"100\" to=\"0\" dur=\"1.5s\" repeatCount=\"indefinite\"/>\n          </path>\n\n          <!-- 省略号和衰减提示 -->\n          <text x=\"620\" y=\"65\" fill=\"rgba(255,255,255,0.3)\" font-size=\"24\">...</text>\n          <text x=\"680\" y=\"55\" fill=\"#f87171\" font-size=\"11\" font-weight=\"500\">信息逐渐丢失</text>\n          <text x=\"680\" y=\"72\" fill=\"rgba(255,255,255,0.4)\" font-size=\"10\">远距离依赖无法捕捉</text>\n        </svg>\n      </div>\n\n      <div class=\"example-box green\" data-delay=\"300\">\n        <div class=\"example-head\">\n          <div class=\"example-icon\">R</div>\n          <div class=\"example-title\">RNN 处理 \"I love NLP\" 的完整过程</div>\n        </div>\n        <div class=\"example-body\">\n          <div class=\"example-code\">\n            <span class=\"keyword\">输入序列：</span><span class=\"string\">\"I love NLP\"</span> → 3个词向量<br/><br/>\n            <span class=\"comment\">// 初始化：h_0 = 零向量</span><br/>\n            h<sub>0</sub> = [0, 0, ..., 0]<br/><br/>\n            <span class=\"comment\">// Step 1: x_1 = Embedding(\"I\")</span><br/>\n            h<sub>1</sub> = tanh(W<sub>xh</sub>·x<sub>1</sub> + W<sub>hh</sub>·h<sub>0</sub>) <span class=\"comment\">// 编码\"主语=我\"</span><br/><br/>\n            <span class=\"comment\">// Step 2: x_2 = Embedding(\"love\")</span><br/>\n            h<sub>2</sub> = tanh(W<sub>xh</sub>·x<sub>2</sub> + W<sub>hh</sub>·<span class=\"variable\">h<sub>1</sub></span>) <span class=\"comment\">// 融合\"我+喜欢\"</span><br/><br/>\n            <span class=\"comment\">// Step 3: x_3 = Embedding(\"NLP\")</span><br/>\n            h<sub>3</sub> = tanh(W<sub>xh</sub>·x<sub>3</sub> + W<sub>hh</sub>·<span class=\"variable\">h<sub>2</sub></span>) <span class=\"comment\">// 完整语义表示</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"callout\" data-delay=\"400\">\n        <div class=\"callout-head\"><div class=\"callout-title\">RNN 的三大优势</div><span class=\"tag\">Advantages</span></div>\n        <div class=\"callout-body\">\n          <ul>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(52,211,153,.2);border-color:rgba(52,211,153,.3);\">1</span><span><span class=\"hl hl-green\">解决变长问题</span>：无论序列多长，网络结构保持不变，只是递归执行更多步</span></li>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(79,172,254,.2);border-color:rgba(79,172,254,.3);\">2</span><span><span class=\"hl hl-cyan\">保留顺序信息</span>：状态按时间顺序依次更新，位置信息自然编码在递归过程中</span></li>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(167,139,250,.2);border-color:rgba(167,139,250,.3);\">3</span><span><span class=\"hl hl-purple\">参数高效</span>：权重矩阵在所有时间步共享，参数量为 O(d<sup>2</sup>)，与序列长度无关</span></li>\n          </ul>\n        </div>\n      </div>\n\n      <div class=\"keyline\" data-delay=\"500\">\n        <div class=\"kdot\">!</div>\n        <div class=\"ktext\"><span class=\"print-text\" data-text=\"RNN 看起来很完美，但它有一个致命的训练问题：当序列很长时，梯度在反向传播过程中会指数级衰减或增长。这就是著名的\"梯度消失/爆炸\"问题。\"></span></div>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"600\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">RNN 在理论上能处理任意长度序列，但实际训练时会遇到严重障碍。下一节我们用<span class=\"em em-pink\">详细的代数推导</span>分析梯度消失问题。</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-gradient",
      "page": 5,
      "kind": "section",
      "accent": "amber",
      "dataTitle": "梯度消失",
      "dataSub": "RNN 的致命伤",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"0.9^100 ≈ 0 — 梯度指数衰减\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 05</span>\n      <h2 class=\"section-title\">梯度消失：RNN 的致命缺陷</h2>\n      <div class=\"prose\">\n        <p>RNN 的训练使用反向传播算法（BPTT，Backpropagation Through Time）。梯度需要从最后一个时间步 h<sub>T</sub> 一路传回到第一个时间步 h<sub>1</sub>。问题在于：<span class=\"hl hl-amber\">每经过一个时间步，梯度就要乘以一个系数</span>。当这个系数小于 1 时，连乘 100 次会发生什么？</p>\n      </div>\n\n      <div class=\"math-block\" data-delay=\"50\">\n        <div class=\"math-title\">BPTT 梯度传播公式推导</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">前向传播:</span>\n          $h_t = \\tanh(W_{hh} h_{t-1} + W_{xh} x_t + b)$\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">链式法则:</span>\n          $\\frac{\\partial L}{\\partial h_1} = \\frac{\\partial L}{\\partial h_T} \\times \\frac{\\partial h_T}{\\partial h_{T-1}} \\times \\cdots \\times \\frac{\\partial h_2}{\\partial h_1}$\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">关键项:</span>\n          $\\frac{\\partial h_t}{\\partial h_{t-1}} = \\text{diag}(\\tanh'(z_t)) \\times W_{hh}$\n          <span class=\"math-comment\">// $z_t$ 是激活前的值</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">范围约束:</span>\n          $\\tanh'(x) = 1 - \\tanh^2(x) \\in (0, 1]$\n          <span class=\"math-comment\">// 导数恒小于等于 1</span>\n        </div>\n        <div class=\"math-result\">\n          连乘 T 个小于 1 的数：当 T 很大时，乘积趋近于 0，梯度\"消失\"。\n        </div>\n      </div>\n\n      <div class=\"example-box amber\" data-delay=\"100\">\n        <div class=\"example-head\">\n          <div class=\"example-icon\">G</div>\n          <div class=\"example-title\">😱 悲剧的数学证明：信号是如何消失的</div>\n        </div>\n        <div class=\"example-body\">\n          <div class=\"example-code\">\n            <span class=\"comment\">// 想象一个传话游戏，每传一次，声音变成原来的 90%...</span><br/><br/>\n            <span class=\"number\">$0.9^{10}$</span> = <span class=\"variable\">0.349</span> &nbsp;&nbsp;&nbsp; <span class=\"comment\">// 10人后：还能听清 35% 😊</span><br/>\n            <span class=\"number\">$0.9^{50}$</span> = <span class=\"variable\">0.005</span> &nbsp;&nbsp;&nbsp; <span class=\"comment\">// 50人后：只剩下 0.5%... 😰</span><br/>\n            <span class=\"number\">$0.9^{100}$</span> = <span class=\"variable\">0.00003</span> <span class=\"comment\">// 100人后：彻底听不见了 😵</span><br/><br/>\n            <span class=\"keyword\">😭 悲剧结局</span>：100 步之前发生的事，模型<span class=\"variable\">完全忘记</span>\n          </div>\n          <div class=\"example-note\">😢 <span class=\"hl hl-red\">这就是 RNN 的阿喀琉斯之踵</span>：它能\"听见\"最近发生的事，但对很久之前的事\"失聪\"了。这就是为什么 RNN 无法处理长文档——它记不住开头的内容！</div>\n        </div>\n      </div>\n\n      <div class=\"diagram-container\" data-delay=\"200\">\n        <svg viewBox=\"0 0 800 140\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\">\n          <defs>\n            <linearGradient id=\"gradFade\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\">\n              <stop offset=\"0%\" stop-color=\"#f87171\"/>\n              <stop offset=\"100%\" stop-color=\"#fbbf24\" stop-opacity=\"0.1\"/>\n            </linearGradient>\n          </defs>\n          <g class=\"svg-fade d1\"><text x=\"40\" y=\"28\" fill=\"rgba(255,255,255,.7)\" font-size=\"13\" font-family=\"Noto Sans SC\">梯度反向传播方向（从损失函数向序列起点传递）</text></g>\n          <g class=\"svg-fade d2\">\n            <rect x=\"620\" y=\"50\" width=\"60\" height=\"40\" rx=\"8\" fill=\"rgba(248,113,113,.2)\" stroke=\"#f87171\" stroke-width=\"2\"/>\n            <text x=\"650\" y=\"75\" text-anchor=\"middle\" fill=\"#fca5a5\" font-size=\"12\" font-family=\"JetBrains Mono\">h<tspan baseline-shift=\"sub\" font-size=\"9\">100</tspan></text>\n          </g>\n          <path class=\"svg-path\" d=\"M620 70 L120 70\" stroke=\"url(#gradFade)\" stroke-width=\"3\" stroke-dasharray=\"8,4\"/>\n          <g class=\"svg-fade d3\">\n            <rect x=\"60\" y=\"50\" width=\"60\" height=\"40\" rx=\"8\" fill=\"rgba(251,191,36,.1)\" stroke=\"rgba(251,191,36,.3)\" stroke-width=\"2\"/>\n            <text x=\"90\" y=\"75\" text-anchor=\"middle\" fill=\"rgba(251,191,36,.5)\" font-size=\"12\" font-family=\"JetBrains Mono\">h<tspan baseline-shift=\"sub\" font-size=\"9\">1</tspan></text>\n          </g>\n          <g class=\"svg-fade d4\"><text x=\"350\" y=\"115\" text-anchor=\"middle\" fill=\"rgba(255,255,255,.5)\" font-size=\"12\" font-family=\"Noto Sans SC\">梯度随时间步指数衰减，到达 h_1 时已近乎消失</text></g>\n        </svg>\n      </div>\n\n      <div class=\"callout\" data-delay=\"300\">\n        <div class=\"callout-head\"><div class=\"callout-title\">关键区分：表达能力 vs 训练能力</div><span class=\"tag\">Key Insight</span></div>\n        <div class=\"callout-body\">\n          <ul>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(240,147,251,.2);border-color:rgba(240,147,251,.3);\">1</span><span><span class=\"hl hl-pink\">表达能力问题</span>：隐状态向量维度不够，装不下所有信息？解决方案：增大隐层维度</span></li>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(248,113,113,.2);border-color:rgba(248,113,113,.3);\">2</span><span><span class=\"hl hl-red\">训练能力问题（更致命）</span>：即使有足够的表达能力，模型也学不会如何正确地存储和利用远距离信息</span></li>\n          </ul>\n          <p style=\"margin-top:12px;\">打个比方：问题不在于<span class=\"em em-amber\">仓库太小装不下货物</span>，而在于<span class=\"em em-red\">运输通道太窄货物送不进去</span>。</p>\n        </div>\n      </div>\n\n      <div class=\"think-box\" data-delay=\"400\">\n        <div class=\"think-icon\">?</div>\n        <div class=\"think-meta\">\n          <div class=\"think-title\">关键思考</div>\n          <div class=\"think-text\">连乘（multiplication）会导致指数级衰减。那如果把信息传递的方式改成<span class=\"hl hl-green\">连加（addition）</span>呢？0.9 + 0.9 + 0.9 + ... 会消失吗？这个思考将引出 LSTM 的核心设计。</div>\n        </div>\n      </div>\n\n      <!-- 梯度对比曲线动画 -->\n      <div class=\"diagram-container\" data-delay=\"450\">\n        <div style=\"text-align:center; margin-bottom:12px; color:rgba(255,255,255,0.6); font-size:13px;\">\n          RNN vs LSTM：梯度传播效果对比\n        </div>\n        <svg viewBox=\"0 0 800 160\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <defs>\n            <!-- RNN 衰减曲线渐变 -->\n            <linearGradient id=\"rnnCurveGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop offset=\"0%\" stop-color=\"#f87171\"/>\n              <stop offset=\"40%\" stop-color=\"#fca5a5\"/>\n              <stop offset=\"100%\" stop-color=\"rgba(248,113,113,0.1)\"/>\n            </linearGradient>\n            <!-- LSTM 保持曲线渐变 -->\n            <linearGradient id=\"lstmCurveGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop offset=\"0%\" stop-color=\"#34d399\"/>\n              <stop offset=\"100%\" stop-color=\"#6ee7b7\"/>\n            </linearGradient>\n            <!-- 发光滤镜 -->\n            <filter id=\"glowGreen\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"3\" result=\"blur\"/>\n              <feMerge><feMergeNode in=\"blur\"/><feMergeNode in=\"SourceGraphic\"/></feMerge>\n            </filter>\n          </defs>\n\n          <!-- 坐标轴 -->\n          <g class=\"svg-fade d1\">\n            <line x1=\"80\" y1=\"130\" x2=\"720\" y2=\"130\" stroke=\"rgba(255,255,255,0.2)\" stroke-width=\"1\"/>\n            <line x1=\"80\" y1=\"130\" x2=\"80\" y2=\"30\" stroke=\"rgba(255,255,255,0.2)\" stroke-width=\"1\"/>\n            <text x=\"400\" y=\"150\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"11\">时间步 t →</text>\n            <text x=\"60\" y=\"80\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"11\" transform=\"rotate(-90, 60, 80)\">梯度强度</text>\n          </g>\n\n          <!-- RNN 指数衰减曲线 -->\n          <path d=\"M80 40 Q150 42 200 60 Q300 90 400 115 Q500 125 600 128 L720 130\"\n                stroke=\"url(#rnnCurveGrad)\" stroke-width=\"3\" fill=\"none\" class=\"svg-path d2\">\n            <animate attributeName=\"stroke-dashoffset\" from=\"800\" to=\"0\" dur=\"2s\" fill=\"freeze\"/>\n          </path>\n          <g class=\"svg-fade d3\">\n            <circle cx=\"80\" cy=\"40\" r=\"6\" fill=\"#f87171\"/>\n            <text x=\"95\" y=\"35\" fill=\"#fca5a5\" font-size=\"11\">RNN: 起点 100%</text>\n            <circle cx=\"720\" cy=\"130\" r=\"4\" fill=\"rgba(248,113,113,0.3)\"/>\n            <text x=\"620\" y=\"115\" fill=\"rgba(248,113,113,0.6)\" font-size=\"10\">≈ 0% 😵</text>\n          </g>\n\n          <!-- LSTM 保持曲线 -->\n          <path d=\"M80 45 Q200 48 400 50 Q600 52 720 55\"\n                stroke=\"url(#lstmCurveGrad)\" stroke-width=\"3\" fill=\"none\" filter=\"url(#glowGreen)\" class=\"svg-path d3\">\n            <animate attributeName=\"stroke-dashoffset\" from=\"800\" to=\"0\" dur=\"2s\" fill=\"freeze\"/>\n          </path>\n          <g class=\"svg-fade d4\">\n            <circle cx=\"80\" cy=\"45\" r=\"6\" fill=\"#34d399\"/>\n            <text x=\"95\" y=\"60\" fill=\"#6ee7b7\" font-size=\"11\">LSTM: 起点 100%</text>\n            <circle cx=\"720\" cy=\"55\" r=\"6\" fill=\"#34d399\"/>\n            <text x=\"620\" y=\"75\" fill=\"#6ee7b7\" font-size=\"10\">≈ 95% 😎</text>\n          </g>\n\n          <!-- 图例 -->\n          <g class=\"svg-fade d5\">\n            <rect x=\"560\" y=\"20\" width=\"12\" height=\"3\" fill=\"#f87171\" rx=\"1\"/>\n            <text x=\"578\" y=\"24\" fill=\"rgba(255,255,255,0.6)\" font-size=\"10\">RNN 乘法链</text>\n            <rect x=\"660\" y=\"20\" width=\"12\" height=\"3\" fill=\"#34d399\" rx=\"1\"/>\n            <text x=\"678\" y=\"24\" fill=\"rgba(255,255,255,0.6)\" font-size=\"10\">LSTM 加法链</text>\n          </g>\n        </svg>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"500\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">梯度消失的根源在于\"乘法传递\"。下一节我们将看到 LSTM 如何通过<span class=\"em em-green\">\"加法高速公路\"</span>这一巧妙设计来解决这个问题。</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-lstm-motivation",
      "page": 6,
      "kind": "section",
      "accent": "green",
      "dataTitle": "LSTM 动机",
      "dataSub": "加法高速公路",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"乘法 → 加法：梯度不再消失\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 06</span>\n      <h2 class=\"section-title\">LSTM 的核心思想：加法高速公路</h2>\n\n      <details class=\"accordion answer\" data-delay=\"50\">\n        <summary><span>上一节思考题的答案：连加会消失吗？</span><span class=\"accordion-badge\">Answer</span><span class=\"accordion-caret\">v</span></summary>\n        <div class=\"accordion-content\">\n          <p><span class=\"hl hl-green\">不会消失！</span>加法链不会产生指数级衰减。即使每一步只增加一点点贡献，经过 100 步累加后信息依然存在。</p>\n          <p>这个简单的观察启发了 LSTM 的核心设计思路：<span class=\"em em-green\">让信息通过加法通道传递，而不是乘法通道</span>。这就是所谓的\"Constant Error Carousel\"（恒定误差流）。</p>\n        </div>\n      </details>\n\n      <div class=\"math-block\" data-delay=\"80\">\n        <div class=\"math-title\">乘法 vs 加法：梯度传播对比</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">RNN 乘法链:</span>\n          $g_1 = g_T \\times 0.9^{T-1}$\n          <span class=\"math-comment\">// g 是梯度</span>\n        </div>\n        <div class=\"math-row\" style=\"padding-left:100px;\">\n          <span class=\"math-comment\">T=10:</span> $0.9^9 = 0.387$\n          <span class=\"math-comment\">T=50:</span> $0.9^{49} = 0.005$\n          <span class=\"math-comment\">T=100:</span> $0.9^{99} \\approx 0$\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">LSTM 加法链:</span>\n          $\\frac{\\partial c_t}{\\partial c_{t-1}} = f_t$\n          <span class=\"math-comment\">// 遗忘门值</span>\n        </div>\n        <div class=\"math-row\" style=\"padding-left:100px;\">\n          当 $f_t \\approx 1$ 时，梯度可以无损传递！\n        </div>\n        <div class=\"math-result\">\n          关键洞察：把信息更新从 $h_t = f(W \\cdot h_{t-1})$ 改为 $c_t = c_{t-1} + ...$，梯度不再连乘。\n        </div>\n      </div>\n\n      <!-- SVG: Multiplication vs Addition Chain Comparison -->\n      <div class=\"diagram-container\" data-delay=\"90\">\n        <svg viewBox=\"0 0 800 180\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <defs>\n            <linearGradient id=\"mulGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop offset=\"0%\" stop-color=\"#f87171\"/><stop offset=\"100%\" stop-color=\"rgba(248,113,113,0.2)\"/>\n            </linearGradient>\n            <linearGradient id=\"addGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n              <stop offset=\"0%\" stop-color=\"#34d399\"/><stop offset=\"100%\" stop-color=\"#34d399\"/>\n            </linearGradient>\n          </defs>\n          <!-- RNN Multiplication Chain (top) -->\n          <g class=\"svg-fade d1\">\n            <text x=\"40\" y=\"40\" fill=\"#fca5a5\" font-size=\"12\" font-weight=\"600\">RNN 乘法链</text>\n            <rect x=\"130\" y=\"25\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(248,113,113,0.2)\" stroke=\"#f87171\" stroke-width=\"1.5\"/>\n            <text x=\"155\" y=\"48\" text-anchor=\"middle\" fill=\"#fca5a5\" font-size=\"11\">h₁</text>\n            <text x=\"195\" y=\"48\" fill=\"#f87171\" font-size=\"14\" font-weight=\"700\">×</text>\n            <rect x=\"215\" y=\"25\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(248,113,113,0.18)\" stroke=\"#f87171\" stroke-width=\"1.5\"/>\n            <text x=\"240\" y=\"48\" text-anchor=\"middle\" fill=\"rgba(252,165,165,0.8)\" font-size=\"11\">h₂</text>\n            <text x=\"280\" y=\"48\" fill=\"#f87171\" font-size=\"14\" font-weight=\"700\">×</text>\n            <rect x=\"300\" y=\"25\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(248,113,113,0.12)\" stroke=\"rgba(248,113,113,0.5)\" stroke-width=\"1.5\"/>\n            <text x=\"325\" y=\"48\" text-anchor=\"middle\" fill=\"rgba(252,165,165,0.5)\" font-size=\"11\">h₃</text>\n            <text x=\"365\" y=\"48\" fill=\"rgba(255,255,255,0.3)\" font-size=\"14\">...</text>\n            <rect x=\"400\" y=\"25\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(248,113,113,0.05)\" stroke=\"rgba(248,113,113,0.2)\" stroke-width=\"1\" stroke-dasharray=\"3,2\"/>\n            <text x=\"425\" y=\"48\" text-anchor=\"middle\" fill=\"rgba(252,165,165,0.2)\" font-size=\"11\">h<tspan baseline-shift=\"sub\" font-size=\"8\">T</tspan></text>\n            <path d=\"M130 42 L450 42\" stroke=\"url(#mulGrad)\" stroke-width=\"3\" stroke-linecap=\"round\" opacity=\"0.4\"/>\n            <text x=\"520\" y=\"35\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">0.9 × 0.9 × 0.9 × ...</text>\n            <text x=\"520\" y=\"52\" fill=\"#f87171\" font-size=\"11\" font-weight=\"600\">→ 指数衰减到 0</text>\n          </g>\n          <!-- LSTM Addition Chain (bottom) -->\n          <g class=\"svg-fade d2\">\n            <text x=\"40\" y=\"130\" fill=\"#6ee7b7\" font-size=\"12\" font-weight=\"600\">LSTM 加法链</text>\n            <rect x=\"130\" y=\"115\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(52,211,153,0.2)\" stroke=\"#34d399\" stroke-width=\"1.5\"/>\n            <text x=\"155\" y=\"138\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"11\">c₁</text>\n            <text x=\"195\" y=\"138\" fill=\"#34d399\" font-size=\"14\" font-weight=\"700\">+</text>\n            <rect x=\"215\" y=\"115\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(52,211,153,0.2)\" stroke=\"#34d399\" stroke-width=\"1.5\"/>\n            <text x=\"240\" y=\"138\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"11\">c₂</text>\n            <text x=\"280\" y=\"138\" fill=\"#34d399\" font-size=\"14\" font-weight=\"700\">+</text>\n            <rect x=\"300\" y=\"115\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(52,211,153,0.2)\" stroke=\"#34d399\" stroke-width=\"1.5\"/>\n            <text x=\"325\" y=\"138\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"11\">c₃</text>\n            <text x=\"365\" y=\"138\" fill=\"rgba(255,255,255,0.3)\" font-size=\"14\">...</text>\n            <rect x=\"400\" y=\"115\" width=\"50\" height=\"35\" rx=\"6\" fill=\"rgba(52,211,153,0.2)\" stroke=\"#34d399\" stroke-width=\"1.5\"/>\n            <text x=\"425\" y=\"138\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"11\">c<tspan baseline-shift=\"sub\" font-size=\"8\">T</tspan></text>\n            <path d=\"M130 132 L450 132\" stroke=\"url(#addGrad)\" stroke-width=\"3\" stroke-linecap=\"round\" opacity=\"0.4\"/>\n            <text x=\"520\" y=\"125\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">f ≈ 1 时梯度保持</text>\n            <text x=\"520\" y=\"142\" fill=\"#6ee7b7\" font-size=\"11\" font-weight=\"600\">→ 信息近乎无损传递</text>\n          </g>\n          <!-- Center comparison -->\n          <g class=\"svg-fade d3\">\n            <rect x=\"680\" y=\"60\" width=\"100\" height=\"60\" rx=\"10\" fill=\"rgba(255,255,255,0.03)\" stroke=\"rgba(255,255,255,0.1)\" stroke-width=\"1\"/>\n            <text x=\"730\" y=\"85\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.7)\" font-size=\"10\">关键区别</text>\n            <text x=\"730\" y=\"105\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"11\" font-weight=\"600\">× → +</text>\n          </g>\n        </svg>\n      </div>\n\n      <div class=\"formula-box\" data-delay=\"100\">\n        <div class=\"formula-label\">LSTM 细胞状态更新公式（核心）</div>\n        <div class=\"formula-main\">$$c_t = f_t \\odot c_{t-1} \\textcolor{#6ee7b7}{+} i_t \\odot \\tilde{c}_t$$</div>\n        <p class=\"formula-desc\">\n          <span class=\"hl hl-green\">关键在于那个加号</span>：不是 $\\tanh(W \\cdot c_{t-1}+...)$，而是直接用 $c_{t-1}$ 加上新内容<br/><br/>\n          <span class=\"hl hl-amber\">$f_t$</span>（遗忘门）：控制旧记忆 $c_{t-1}$ 保留多少，取值范围 $[0,1]$<br/>\n          <span class=\"hl hl-cyan\">$i_t$</span>（输入门）：控制新信息 $\\tilde{c}_t$ 写入多少，取值范围 $[0,1]$<br/>\n          <span class=\"hl hl-purple\">$\\tilde{c}_t$</span>（候选记忆）：当前时刻准备写入的新信息内容\n        </p>\n      </div>\n\n      <div class=\"example-box green\" data-delay=\"200\">\n        <div class=\"example-head\">\n          <div class=\"example-icon\">H</div>\n          <div class=\"example-title\">高速公路类比：理解加法通道</div>\n        </div>\n        <div class=\"example-body\">\n          <div class=\"example-code\">\n            <span class=\"comment\">// RNN 像普通公路：每个路口都必须减速、转弯（经过 tanh 非线性变换）</span><br/>\n            $h_t = \\tanh(W_{hh} \\cdot h_{t-1} + W_{xh} \\cdot x_t)$<br/>\n            <span class=\"comment\">// 信号每过一个路口就衰减一次</span><br/><br/>\n            <span class=\"comment\">// LSTM 细胞状态 $c_t$ 像高速公路：信息可以直接通过</span><br/>\n            $c_t = f_t \\cdot c_{t-1}$ <span class=\"keyword\">+</span> $i_t \\cdot \\tilde{c}_t$<br/>\n            <span class=\"comment\">// 当 $f_t \\approx 1$ 时，$c_{t-1}$ 几乎原样传递到 $c_t$</span>\n          </div>\n          <div class=\"example-note\">\n            门控机制的作用：<br/>\n            - <span class=\"hl hl-cyan\">输入门 $i$</span> 决定哪些新信息\"驶入高速\"<br/>\n            - <span class=\"hl hl-pink\">输出门 $o$</span> 决定哪些记忆\"驶出高速\"供外界使用<br/>\n            - <span class=\"hl hl-amber\">遗忘门 $f$</span> 决定哪些旧信息\"继续在高速上行驶\"\n          </div>\n        </div>\n      </div>\n\n      <div class=\"keyline\" data-delay=\"300\">\n        <div class=\"kdot\">*</div>\n        <div class=\"ktext\"><span class=\"print-text\" data-text=\"细胞状态的更新是加法操作。反向传播时，梯度可以沿着这条\"加法高速公路\"近乎无损地传递——当遗忘门接近 1 时，梯度几乎不衰减。\"></span></div>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"400\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">理解了加法通道的核心思想后，接下来让我们完整地看看 <span class=\"em em-green\">LSTM 的四个门控公式</span>，以及它们各自的作用。</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-lstm-formula",
      "page": 7,
      "kind": "section",
      "accent": "green",
      "dataTitle": "LSTM 公式",
      "dataSub": "四个门 + 两条路径",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"遗忘门 · 输入门 · 候选记忆 · 输出门\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 07</span>\n      <h2 class=\"section-title\">LSTM 的完整计算流程</h2>\n      <div class=\"prose\">\n        <p>LSTM 在每个时间步执行以下六个计算步骤。理解每一步的作用和它们之间的协作关系，是掌握 LSTM 的关键。</p>\n      </div>\n\n      <div class=\"math-block\" data-delay=\"50\">\n        <div class=\"math-title\">参数维度分析（假设隐层维度 d=256）</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">输入:</span>\n          $x_t \\in \\mathbb{R}^n$\n          <span class=\"math-comment\">// n 是输入特征维度，如词向量维度 512</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">拼接向量:</span>\n          $[h_{t-1}, x_t] \\in \\mathbb{R}^{n+d}$\n          <span class=\"math-comment\">// 512+256 = 768 维</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">权重矩阵:</span>\n          $W_f, W_i, W_c, W_o \\in \\mathbb{R}^{d \\times (n+d)}$\n          <span class=\"math-comment\">// 每个门有独立的权重矩阵</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">参数总量:</span>\n          $4 \\times d \\times (n+d) + 4 \\times d$\n          <span class=\"math-comment\">// 4个门的权重 + 4个偏置</span>\n        </div>\n        <div class=\"math-result\">\n          示例计算：$4 \\times 256 \\times 768 + 4 \\times 256 = 787,456 + 1,024 = 788,480$ 个参数/层\n        </div>\n      </div>\n\n      <div class=\"formula-box\" data-delay=\"100\">\n        <div class=\"formula-label\">LSTM 完整公式（按计算顺序）</div>\n        <div class=\"formula-main\" style=\"font-size:14px; line-height:2.4;\">\n          <span class=\"hl hl-amber\">Step 1 遗忘门:</span> $f_t = \\sigma(W_f \\cdot [h_{t-1}, x_t] + b_f)$<br/>\n          <span class=\"hl hl-cyan\">Step 2 输入门:</span> $i_t = \\sigma(W_i \\cdot [h_{t-1}, x_t] + b_i)$<br/>\n          <span class=\"hl hl-purple\">Step 3 候选记忆:</span> $\\tilde{c}_t = \\tanh(W_c \\cdot [h_{t-1}, x_t] + b_c)$<br/>\n          <span class=\"hl hl-green\">Step 4 更新细胞状态:</span> $c_t = f_t \\odot c_{t-1} + i_t \\odot \\tilde{c}_t$<br/>\n          <span class=\"hl hl-pink\">Step 5 输出门:</span> $o_t = \\sigma(W_o \\cdot [h_{t-1}, x_t] + b_o)$<br/>\n          <span class=\"hl hl-red\">Step 6 隐状态输出:</span> $h_t = o_t \\odot \\tanh(c_t)$\n        </div>\n      </div>\n\n      <!-- Code + Diagram: LSTM Implementation -->\n      <div class=\"annotation-hint\" data-delay=\"105\">\n        <span class=\"annotation-hint-icon\">?</span>\n        <span>悬停代码行左侧的数字标记查看说明 | 数字对应右侧图解中的相同标记</span>\n      </div>\n      <div class=\"code-diagram-split\" data-delay=\"110\">\n        <div class=\"code-panel\">\n          <div class=\"code-panel-header\">\n            <div class=\"code-panel-dots\"><span></span><span></span><span></span></div>\n            <span class=\"code-panel-title\">lstm_cell.py</span>\n          </div>\n          <div class=\"code-panel-body\" style=\"padding-left:32px;\">\n<span class=\"keyword\">class</span> <span class=\"function\">LSTMCell</span>(nn.Module):<br/>\n&nbsp;&nbsp;<span class=\"keyword\">def</span> <span class=\"function\">forward</span>(<span class=\"variable\">self</span>, x_t, h_prev, c_prev):<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\"># 拼接输入</span><br/>\n&nbsp;&nbsp;&nbsp;&nbsp;combined <span class=\"operator\">=</span> torch.<span class=\"function\">cat</span>([h_prev, x_t], dim<span class=\"operator\">=</span><span class=\"number\">1</span>)<br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\"># 四个门的计算</span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-amber\">1</span>f_t <span class=\"operator\">=</span> torch.<span class=\"function\">sigmoid</span>(<span class=\"variable\">self</span>.W_f(combined))<span class=\"code-annotation-tip\">→ 遗忘门 f_t：决定保留多少旧记忆</span></span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-cyan\">2</span>i_t <span class=\"operator\">=</span> torch.<span class=\"function\">sigmoid</span>(<span class=\"variable\">self</span>.W_i(combined))<span class=\"code-annotation-tip\">→ 输入门 i_t：决定写入多少新信息</span></span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-purple\">3</span>c_tilde <span class=\"operator\">=</span> torch.<span class=\"function\">tanh</span>(<span class=\"variable\">self</span>.W_c(combined))<span class=\"code-annotation-tip\">→ 候选记忆 c̃_t：待写入的新内容</span></span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-pink\">4</span>o_t <span class=\"operator\">=</span> torch.<span class=\"function\">sigmoid</span>(<span class=\"variable\">self</span>.W_o(combined))<span class=\"code-annotation-tip\">→ 输出门 o_t：决定输出多少信息</span></span><br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"comment\"># 核心：加法更新细胞状态</span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-green\">5</span>c_t <span class=\"operator\">=</span> f_t <span class=\"operator\">*</span> c_prev <span class=\"operator\">+</span> i_t <span class=\"operator\">*</span> c_tilde<span class=\"code-annotation-tip\">→ 信息高速公路！加法保持梯度</span></span><br/>\n<span class=\"code-line-annotated\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"code-marker m-purple\" style=\"background:linear-gradient(135deg, #667eea, #a5b4fc);\">6</span>h_t <span class=\"operator\">=</span> o_t <span class=\"operator\">*</span> torch.<span class=\"function\">tanh</span>(c_t)<span class=\"code-annotation-tip\">→ 最终隐状态输出 h_t</span></span><br/><br/>\n&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"keyword\">return</span> h_t, c_t\n          </div>\n        </div>\n        <div class=\"diagram-panel\">\n          <svg viewBox=\"0 0 300 260\" fill=\"none\">\n            <defs>\n              <!-- 高速公路动画渐变 -->\n              <linearGradient id=\"highwayFlow\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                <stop offset=\"0%\" stop-color=\"#34d399\">\n                  <animate attributeName=\"stop-color\" values=\"#34d399;#6ee7b7;#34d399\" dur=\"2s\" repeatCount=\"indefinite\"/>\n                </stop>\n                <stop offset=\"100%\" stop-color=\"#6ee7b7\">\n                  <animate attributeName=\"stop-color\" values=\"#6ee7b7;#34d399;#6ee7b7\" dur=\"2s\" repeatCount=\"indefinite\"/>\n                </stop>\n              </linearGradient>\n              <!-- 发光效果 -->\n              <filter id=\"glow2\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n                <feGaussianBlur stdDeviation=\"2\" result=\"blur\"/>\n                <feMerge><feMergeNode in=\"blur\"/><feMergeNode in=\"SourceGraphic\"/></feMerge>\n              </filter>\n            </defs>\n\n            <!-- 细胞状态高速公路（核心！） 标注5 -->\n            <path d=\"M20 35 L280 35\" stroke=\"url(#highwayFlow)\" stroke-width=\"5\" stroke-linecap=\"round\" filter=\"url(#glow2)\"/>\n            <text x=\"8\" y=\"40\" fill=\"rgba(255,255,255,0.6)\" font-size=\"10\">c<tspan baseline-shift=\"sub\" font-size=\"7\">t-1</tspan></text>\n            <text x=\"255\" y=\"50\" fill=\"#6ee7b7\" font-size=\"10\" font-weight=\"600\">c<tspan baseline-shift=\"sub\" font-size=\"7\">t</tspan></text>\n            <text x=\"150\" y=\"22\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"9\">🛣️ 信息高速公路</text>\n            <!-- 标注5: 高速公路 -->\n            <circle cx=\"20\" cy=\"22\" r=\"9\" fill=\"#10b981\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"20\" y=\"26\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"8\" font-weight=\"700\">5</text>\n\n            <!-- 遗忘门 标注1 -->\n            <rect x=\"55\" y=\"55\" width=\"45\" height=\"35\" rx=\"6\" fill=\"rgba(251,191,36,0.2)\" stroke=\"#fbbf24\" stroke-width=\"1.5\"/>\n            <text x=\"77\" y=\"77\" text-anchor=\"middle\" fill=\"#fcd34d\" font-size=\"11\" font-weight=\"600\">f<tspan baseline-shift=\"sub\" font-size=\"8\">t</tspan></text>\n            <circle cx=\"77\" cy=\"35\" r=\"10\" fill=\"rgba(251,191,36,0.4)\" stroke=\"#fbbf24\" stroke-width=\"1.5\">\n              <animate attributeName=\"fill-opacity\" values=\"0.3;0.6;0.3\" dur=\"2s\" repeatCount=\"indefinite\"/>\n            </circle>\n            <text x=\"77\" y=\"39\" text-anchor=\"middle\" fill=\"#fcd34d\" font-size=\"10\" font-weight=\"bold\">×</text>\n            <path d=\"M77 45 L77 55\" stroke=\"#fbbf24\" stroke-width=\"1.5\"/>\n            <text x=\"77\" y=\"103\" text-anchor=\"middle\" fill=\"rgba(251,191,36,0.7)\" font-size=\"8\">遗忘门</text>\n            <!-- 标注1 -->\n            <circle cx=\"55\" cy=\"55\" r=\"9\" fill=\"#f59e0b\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"55\" y=\"59\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"8\" font-weight=\"700\">1</text>\n\n            <!-- 输入门 + 候选 标注2,3 -->\n            <rect x=\"125\" y=\"55\" width=\"45\" height=\"35\" rx=\"6\" fill=\"rgba(79,172,254,0.2)\" stroke=\"#4facfe\" stroke-width=\"1.5\"/>\n            <text x=\"147\" y=\"77\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"11\" font-weight=\"600\">i<tspan baseline-shift=\"sub\" font-size=\"8\">t</tspan></text>\n            <!-- 标注2 -->\n            <circle cx=\"125\" cy=\"55\" r=\"9\" fill=\"#06b6d4\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"125\" y=\"59\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"8\" font-weight=\"700\">2</text>\n            <rect x=\"125\" y=\"110\" width=\"45\" height=\"35\" rx=\"6\" fill=\"rgba(167,139,250,0.2)\" stroke=\"#a78bfa\" stroke-width=\"1.5\"/>\n            <text x=\"147\" y=\"132\" text-anchor=\"middle\" fill=\"#c4b5fd\" font-size=\"11\" font-weight=\"600\">c̃<tspan baseline-shift=\"sub\" font-size=\"8\">t</tspan></text>\n            <!-- 标注3 -->\n            <circle cx=\"125\" cy=\"110\" r=\"9\" fill=\"#8b5cf6\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"125\" y=\"114\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"8\" font-weight=\"700\">3</text>\n            <text x=\"147\" y=\"158\" text-anchor=\"middle\" fill=\"rgba(167,139,250,0.7)\" font-size=\"8\">输入门 × 候选</text>\n\n            <!-- 加法节点（核心） -->\n            <circle cx=\"147\" cy=\"35\" r=\"12\" fill=\"rgba(52,211,153,0.5)\" stroke=\"#34d399\" stroke-width=\"2\">\n              <animate attributeName=\"r\" values=\"11;13;11\" dur=\"1.5s\" repeatCount=\"indefinite\"/>\n            </circle>\n            <text x=\"147\" y=\"40\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"14\" font-weight=\"bold\">+</text>\n            <path d=\"M147 47 L147 55\" stroke=\"#4facfe\" stroke-width=\"1.5\"/>\n            <path d=\"M147 90 L147 110\" stroke=\"#a78bfa\" stroke-width=\"1\"/>\n\n            <!-- 输出门 标注4 -->\n            <rect x=\"205\" y=\"55\" width=\"45\" height=\"35\" rx=\"6\" fill=\"rgba(240,147,251,0.2)\" stroke=\"#f093fb\" stroke-width=\"1.5\"/>\n            <text x=\"227\" y=\"77\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"11\" font-weight=\"600\">o<tspan baseline-shift=\"sub\" font-size=\"8\">t</tspan></text>\n            <text x=\"227\" y=\"103\" text-anchor=\"middle\" fill=\"rgba(240,147,251,0.7)\" font-size=\"8\">输出门</text>\n            <!-- 标注4 -->\n            <circle cx=\"250\" cy=\"55\" r=\"9\" fill=\"#ec4899\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"250\" y=\"59\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"8\" font-weight=\"700\">4</text>\n\n            <!-- tanh 和输出 h_t -->\n            <circle cx=\"227\" cy=\"135\" r=\"10\" fill=\"rgba(255,255,255,0.1)\" stroke=\"rgba(255,255,255,0.3)\"/>\n            <text x=\"227\" y=\"139\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.6)\" font-size=\"8\">tanh</text>\n            <path d=\"M245 35 Q260 35 260 60 L260 135 L237 135\" stroke=\"rgba(255,255,255,0.3)\" stroke-width=\"1\" fill=\"none\"/>\n            <circle cx=\"227\" cy=\"165\" r=\"10\" fill=\"rgba(240,147,251,0.3)\" stroke=\"#f093fb\"/>\n            <text x=\"227\" y=\"169\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"9\">×</text>\n            <path d=\"M227 90 L227 120\" stroke=\"#f093fb\" stroke-width=\"1\"/>\n\n            <!-- 输出 标注6 -->\n            <rect x=\"195\" y=\"190\" width=\"65\" height=\"30\" rx=\"6\" fill=\"rgba(102,126,234,0.2)\" stroke=\"#667eea\" stroke-width=\"1.5\"/>\n            <text x=\"227\" y=\"210\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"11\" font-weight=\"600\">h<tspan baseline-shift=\"sub\" font-size=\"8\">t</tspan></text>\n            <path d=\"M227 175 L227 190\" stroke=\"#667eea\" stroke-width=\"1.5\"/>\n            <!-- 标注6 -->\n            <circle cx=\"260\" cy=\"190\" r=\"9\" fill=\"#667eea\" class=\"diagram-marker\"><animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\"/></circle>\n            <text x=\"260\" y=\"194\" text-anchor=\"middle\" fill=\"#fff\" font-size=\"8\" font-weight=\"700\">6</text>\n\n            <!-- 底部说明 -->\n            <text x=\"150\" y=\"245\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"9\">✨ 加法保持梯度 | 门控选择信息</text>\n          </svg>\n        </div>\n      </div>\n\n      <!-- SVG: LSTM Cell Architecture Diagram -->\n      <div class=\"diagram-container\" data-delay=\"120\">\n        <svg viewBox=\"0 0 800 220\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <defs>\n            <linearGradient id=\"forgetGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#fbbf24\"/><stop offset=\"100%\" stop-color=\"#f97316\"/>\n            </linearGradient>\n            <linearGradient id=\"inputGateGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#4facfe\"/><stop offset=\"100%\" stop-color=\"#00f2fe\"/>\n            </linearGradient>\n            <linearGradient id=\"cellGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#34d399\"/><stop offset=\"100%\" stop-color=\"#4facfe\"/>\n            </linearGradient>\n            <linearGradient id=\"outputGateGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#f093fb\"/><stop offset=\"100%\" stop-color=\"#f5576c\"/>\n            </linearGradient>\n            <marker id=\"lstmArrow\" markerWidth=\"8\" markerHeight=\"8\" refX=\"7\" refY=\"3\" orient=\"auto\" markerUnits=\"strokeWidth\">\n              <path d=\"M0,0 L0,6 L8,3 z\" fill=\"rgba(255,255,255,0.5)\"/>\n            </marker>\n          </defs>\n          <!-- Cell State Highway (top) -->\n          <g class=\"svg-fade d1\">\n            <text x=\"80\" y=\"30\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">细胞状态 c</text>\n            <path d=\"M120 40 L680 40\" stroke=\"url(#cellGrad)\" stroke-width=\"4\" stroke-linecap=\"round\"/>\n            <text x=\"720\" y=\"45\" fill=\"#6ee7b7\" font-size=\"11\">c<tspan baseline-shift=\"sub\" font-size=\"8\">t</tspan></text>\n            <text x=\"100\" y=\"45\" fill=\"#6ee7b7\" font-size=\"11\">c<tspan baseline-shift=\"sub\" font-size=\"8\">t-1</tspan></text>\n          </g>\n          <!-- Forget Gate -->\n          <g class=\"svg-fade d2\">\n            <rect x=\"180\" y=\"70\" width=\"60\" height=\"50\" rx=\"8\" fill=\"rgba(251,191,36,0.15)\" stroke=\"url(#forgetGrad)\" stroke-width=\"2\"/>\n            <text x=\"210\" y=\"90\" text-anchor=\"middle\" fill=\"#fcd34d\" font-size=\"10\" font-weight=\"600\">遗忘门</text>\n            <text x=\"210\" y=\"108\" text-anchor=\"middle\" fill=\"#fcd34d\" font-size=\"14\" font-weight=\"700\">f<tspan baseline-shift=\"sub\" font-size=\"10\">t</tspan></text>\n            <circle cx=\"210\" cy=\"40\" r=\"10\" fill=\"rgba(251,191,36,0.3)\" stroke=\"#fbbf24\" stroke-width=\"1.5\"/>\n            <text x=\"210\" y=\"44\" text-anchor=\"middle\" fill=\"#fcd34d\" font-size=\"10\">×</text>\n            <path d=\"M210 60 L210 70\" stroke=\"#fbbf24\" stroke-width=\"1.5\"/>\n          </g>\n          <!-- Input Gate + Candidate -->\n          <g class=\"svg-fade d3\">\n            <rect x=\"320\" y=\"70\" width=\"60\" height=\"50\" rx=\"8\" fill=\"rgba(79,172,254,0.15)\" stroke=\"url(#inputGateGrad)\" stroke-width=\"2\"/>\n            <text x=\"350\" y=\"90\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"10\" font-weight=\"600\">输入门</text>\n            <text x=\"350\" y=\"108\" text-anchor=\"middle\" fill=\"#67e8f9\" font-size=\"14\" font-weight=\"700\">i<tspan baseline-shift=\"sub\" font-size=\"10\">t</tspan></text>\n            <rect x=\"320\" y=\"135\" width=\"60\" height=\"40\" rx=\"8\" fill=\"rgba(167,139,250,0.15)\" stroke=\"#a78bfa\" stroke-width=\"2\"/>\n            <text x=\"350\" y=\"155\" text-anchor=\"middle\" fill=\"#c4b5fd\" font-size=\"10\" font-weight=\"600\">候选</text>\n            <text x=\"350\" y=\"170\" text-anchor=\"middle\" fill=\"#c4b5fd\" font-size=\"12\" font-weight=\"700\">c̃<tspan baseline-shift=\"sub\" font-size=\"9\">t</tspan></text>\n            <circle cx=\"350\" cy=\"40\" r=\"10\" fill=\"rgba(52,211,153,0.3)\" stroke=\"#34d399\" stroke-width=\"1.5\"/>\n            <text x=\"350\" y=\"44\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"10\">+</text>\n            <path d=\"M350 50 L350 70\" stroke=\"#67e8f9\" stroke-width=\"1.5\"/>\n          </g>\n          <!-- Output Gate -->\n          <g class=\"svg-fade d4\">\n            <rect x=\"490\" y=\"70\" width=\"60\" height=\"50\" rx=\"8\" fill=\"rgba(240,147,251,0.15)\" stroke=\"url(#outputGateGrad)\" stroke-width=\"2\"/>\n            <text x=\"520\" y=\"90\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"10\" font-weight=\"600\">输出门</text>\n            <text x=\"520\" y=\"108\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"14\" font-weight=\"700\">o<tspan baseline-shift=\"sub\" font-size=\"10\">t</tspan></text>\n            <circle cx=\"520\" cy=\"145\" r=\"10\" fill=\"rgba(240,147,251,0.3)\" stroke=\"#f093fb\" stroke-width=\"1.5\"/>\n            <text x=\"520\" y=\"149\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"10\">×</text>\n            <path d=\"M520 120 L520 135\" stroke=\"#f093fb\" stroke-width=\"1.5\"/>\n            <rect x=\"470\" y=\"165\" width=\"100\" height=\"30\" rx=\"6\" fill=\"rgba(102,126,234,0.1)\" stroke=\"#667eea\" stroke-width=\"1.5\"/>\n            <text x=\"520\" y=\"185\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"12\" font-weight=\"600\">h<tspan baseline-shift=\"sub\" font-size=\"9\">t</tspan> = o × tanh(c)</text>\n          </g>\n          <!-- tanh block -->\n          <g class=\"svg-fade d4\">\n            <rect x=\"600\" y=\"25\" width=\"50\" height=\"30\" rx=\"6\" fill=\"rgba(52,211,153,0.1)\" stroke=\"rgba(52,211,153,0.5)\" stroke-width=\"1\"/>\n            <text x=\"625\" y=\"45\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"10\">tanh</text>\n            <path d=\"M600 40 L560 40 L560 145 L530 145\" stroke=\"rgba(52,211,153,0.5)\" stroke-width=\"1.5\" marker-end=\"url(#lstmArrow)\"/>\n          </g>\n          <!-- Input arrows -->\n          <g class=\"svg-fade d5\">\n            <path d=\"M150 200 L150 145 L180 145 L180 120\" stroke=\"rgba(255,255,255,0.3)\" stroke-width=\"1.5\" marker-end=\"url(#lstmArrow)\"/>\n            <text x=\"100\" y=\"210\" fill=\"rgba(255,255,255,0.5)\" font-size=\"10\">[h<tspan baseline-shift=\"sub\" font-size=\"7\">t-1</tspan>, x<tspan baseline-shift=\"sub\" font-size=\"7\">t</tspan>]</text>\n            <path d=\"M200 200 L200 155 L275 155 L275 95 L320 95\" stroke=\"rgba(255,255,255,0.3)\" stroke-width=\"1.5\" stroke-dasharray=\"4,3\"/>\n            <path d=\"M250 200 L250 165 L320 165\" stroke=\"rgba(255,255,255,0.3)\" stroke-width=\"1.5\" stroke-dasharray=\"4,3\"/>\n            <path d=\"M300 200 L300 140 L430 140 L430 95 L490 95\" stroke=\"rgba(255,255,255,0.3)\" stroke-width=\"1.5\" stroke-dasharray=\"4,3\"/>\n          </g>\n          <!-- Legend -->\n          <g class=\"svg-fade d5\">\n            <text x=\"700\" y=\"90\" fill=\"rgba(255,255,255,0.4)\" font-size=\"9\">σ = sigmoid</text>\n            <text x=\"700\" y=\"105\" fill=\"rgba(255,255,255,0.4)\" font-size=\"9\">× = 逐元素乘</text>\n            <text x=\"700\" y=\"120\" fill=\"rgba(255,255,255,0.4)\" font-size=\"9\">+ = 逐元素加</text>\n          </g>\n        </svg>\n      </div>\n\n      <div class=\"cards-grid cards-grid-2\" style=\"margin-top:20px;\">\n        <div class=\"glass-card\" data-delay=\"0\">\n          <div class=\"card-icon amber\">f</div>\n          <h3 class=\"card-title\">遗忘门 Forget Gate</h3>\n          <p class=\"card-text\">根据当前输入 x<sub>t</sub> 和上一时刻隐状态 h<sub>t-1</sub>，决定<span class=\"hl hl-amber\">旧记忆 c<sub>t-1</sub> 中哪些部分需要保留</span>。sigmoid 输出范围 [0,1]，0 表示完全遗忘，1 表示完全保留。</p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"100\">\n          <div class=\"card-icon cyan\">i</div>\n          <h3 class=\"card-title\">输入门 Input Gate</h3>\n          <p class=\"card-text\">决定<span class=\"hl hl-cyan\">候选记忆 c̃<sub>t</sub> 中哪些部分应该写入细胞状态</span>。与遗忘门配合，实现对记忆的选择性更新——可以同时遗忘一部分旧信息，写入一部分新信息。</p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"200\">\n          <div class=\"card-icon purple\">c</div>\n          <h3 class=\"card-title\">候选记忆 Candidate</h3>\n          <p class=\"card-text\">基于当前输入和历史状态，生成<span class=\"hl hl-purple\">当前时刻准备写入的新信息内容</span>。使用 tanh 激活，输出范围 [-1, 1]，可以表示正向和负向的信息更新。</p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"300\">\n          <div class=\"card-icon pink\">o</div>\n          <h3 class=\"card-title\">输出门 Output Gate</h3>\n          <p class=\"card-text\">决定<span class=\"hl hl-pink\">细胞状态 c<sub>t</sub> 中哪些部分应该输出给外界</span>。有些信息可能需要长期存储但当前不需要输出。这实现了\"存储\"和\"使用\"的解耦。</p>\n        </div>\n      </div>\n\n      <div class=\"keyline\" data-delay=\"400\">\n        <div class=\"kdot\">*</div>\n        <div class=\"ktext\">核心公式 c<sub>t</sub> = f<sub>t</sub> ⊙ c<sub>t-1</sub> <span class=\"em em-green\">+</span> i<sub>t</sub> ⊙ c̃<sub>t</sub> 中的<span class=\"em em-green\">加号</span>是 LSTM 能学习长距离依赖的数学基础。遗忘门 f<sub>t</sub> 接近 1 时，梯度可以几乎无损地向前传播。</div>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"500\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">公式理解后，让我们通过一个<span class=\"em em-cyan\">互动演示</span>来建立直觉：调节各门控的值，观察细胞状态如何变化。</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-lstm-demo",
      "page": 8,
      "kind": "section",
      "accent": "cyan",
      "dataTitle": "互动演示",
      "dataSub": "调节参数，观察效果",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"调节门控值，观察细胞状态变化\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 08</span>\n      <h2 class=\"section-title\">互动实验：理解门控机制</h2>\n      <div class=\"prose\"><p>通过调节各个参数的值，观察细胞状态 c<sub>t</sub> 如何根据门控值的不同而变化。这个实验将帮助你建立对 LSTM 门控机制的直觉理解。</p></div>\n\n      <div class=\"math-block\" data-delay=\"50\">\n        <div class=\"math-title\">细胞状态更新的数学直觉</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">公式:</span>\n          <span class=\"math-var\">c<sub>t</sub></span> <span class=\"math-eq\">=</span> <span class=\"math-var\">f<sub>t</sub></span> <span class=\"math-eq\">×</span> <span class=\"math-var\">c<sub>t-1</sub></span> <span class=\"math-eq\">+</span> <span class=\"math-var\">i<sub>t</sub></span> <span class=\"math-eq\">×</span> <span class=\"math-var\">c̃<sub>t</sub></span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">f=1, i=0:</span>\n          <span class=\"math-var\">c<sub>t</sub></span> = <span class=\"math-num\">1</span> × <span class=\"math-var\">c<sub>t-1</sub></span> + <span class=\"math-num\">0</span> × <span class=\"math-var\">c̃<sub>t</sub></span> = <span class=\"math-var\">c<sub>t-1</sub></span>\n          <span class=\"math-comment\">// 完全保留</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">f=0, i=1:</span>\n          <span class=\"math-var\">c<sub>t</sub></span> = <span class=\"math-num\">0</span> × <span class=\"math-var\">c<sub>t-1</sub></span> + <span class=\"math-num\">1</span> × <span class=\"math-var\">c̃<sub>t</sub></span> = <span class=\"math-var\">c̃<sub>t</sub></span>\n          <span class=\"math-comment\">// 完全替换</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">f=0.5, i=0.5:</span>\n          <span class=\"math-var\">c<sub>t</sub></span> = <span class=\"math-num\">0.5</span> × <span class=\"math-var\">c<sub>t-1</sub></span> + <span class=\"math-num\">0.5</span> × <span class=\"math-var\">c̃<sub>t</sub></span>\n          <span class=\"math-comment\">// 各取一半</span>\n        </div>\n        <div class=\"math-result\">\n          门控值决定了新旧信息的混合比例，模型通过学习来决定何时保留、何时更新。\n        </div>\n      </div>\n\n      <div class=\"lab-grid\" data-delay=\"100\">\n        <div class=\"lab-card\">\n          <div class=\"lab-head\">\n            <div><div class=\"lab-title\">LSTM 细胞状态计算器</div><div class=\"lab-sub\">公式：c<sub>t</sub> = f<sub>t</sub> × c<sub>t-1</sub> + i<sub>t</sub> × c̃<sub>t</sub></div></div>\n          </div>\n          <div class=\"lab-body\">\n            <div class=\"lab-controls\">\n              <div class=\"lab-control\"><label>c<sub>t-1</sub> (上一时刻细胞状态)</label><input type=\"range\" id=\"slider-cprev\" min=\"-1\" max=\"1\" step=\"0.1\" value=\"0.8\"/><div class=\"lab-control-value\" id=\"val-cprev\">0.8</div></div>\n              <div class=\"lab-control\"><label>f<sub>t</sub> (遗忘门输出)</label><input type=\"range\" id=\"slider-f\" min=\"0\" max=\"1\" step=\"0.1\" value=\"0.9\"/><div class=\"lab-control-value\" id=\"val-f\">0.9</div></div>\n              <div class=\"lab-control\"><label>i<sub>t</sub> (输入门输出)</label><input type=\"range\" id=\"slider-i\" min=\"0\" max=\"1\" step=\"0.1\" value=\"0.3\"/><div class=\"lab-control-value\" id=\"val-i\">0.3</div></div>\n              <div class=\"lab-control\"><label>c̃<sub>t</sub> (候选记忆值)</label><input type=\"range\" id=\"slider-ctilde\" min=\"-1\" max=\"1\" step=\"0.1\" value=\"0.5\"/><div class=\"lab-control-value\" id=\"val-ctilde\">0.5</div></div>\n            </div>\n            <div class=\"formula-box\" style=\"margin-top:16px; background: rgba(52,211,153,.08); border-color: rgba(52,211,153,.20);\">\n              <div class=\"formula-label\" style=\"color: rgba(52,211,153,.75);\">实时计算结果</div>\n              <div class=\"formula-main\" style=\"font-size:16px;\">c<sub>t</sub> = <span id=\"calc-f\">0.9</span> × <span id=\"calc-cprev\">0.8</span> + <span id=\"calc-i\">0.3</span> × <span id=\"calc-ctilde\">0.5</span> = <span id=\"calc-result\" style=\"color: #6ee7b7; font-weight:700;\">0.87</span></div>\n            </div>\n            <div class=\"lab-hint\"><span id=\"hint-text\">旧记忆保留 90%，新信息写入 30%。细胞状态在逐步更新中。</span></div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"callout\" data-delay=\"200\">\n        <div class=\"callout-head\"><div class=\"callout-title\">推荐实验组合</div><span class=\"tag\">Try These</span></div>\n        <div class=\"callout-body\">\n          <ul>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(52,211,153,.2);border-color:rgba(52,211,153,.3);\">A</span><span><span class=\"hl hl-green\">f=1.0, i=0.0</span>：完全保留旧记忆，不写入任何新信息。适用于：遇到不重要的输入时\"暂停更新\"</span></li>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(248,113,113,.2);border-color:rgba(248,113,113,.3);\">B</span><span><span class=\"hl hl-red\">f=0.0, i=1.0</span>：完全清空旧记忆，用新信息替换。适用于：话题切换时\"重置记忆\"</span></li>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(251,191,36,.2);border-color:rgba(251,191,36,.3);\">C</span><span><span class=\"hl hl-amber\">f=0.9, i=0.8</span>：保留大部分旧记忆，同时写入大量新信息。适用于：信息累积场景</span></li>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(167,139,250,.2);border-color:rgba(167,139,250,.3);\">D</span><span><span class=\"hl hl-purple\">f=0.2, i=0.2</span>：旧记忆丢失，新信息也很少写入。结果：记忆被稀释，接近\"遗忘\"</span></li>\n          </ul>\n        </div>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"300\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">建立了对门控机制的直觉后，让我们回到最初的问题：LSTM 是<span class=\"em em-purple\">如何解决 \"cat...was\" 这种长距离依赖</span>的？</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-lstm-example",
      "page": 9,
      "kind": "section",
      "accent": "purple",
      "dataTitle": "实际例子",
      "dataSub": "cat...was 怎么处理",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"The cat ... was — 跨越7个词的依赖\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 09</span>\n      <h2 class=\"section-title\">实例分析：\"cat...was\" 问题的 LSTM 解法</h2>\n      <div class=\"prose\">\n        <p>让我们回到最初提出的长距离依赖问题，看看 LSTM 的门控机制是如何逐步处理这个句子的。</p>\n      </div>\n\n      <div class=\"math-block\" data-delay=\"50\">\n        <div class=\"math-title\">门控值的语言学意义</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">句子:</span>\n          \"The cat which was sitting on the mat <span class=\"math-var\">___</span>\"\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">依赖距离:</span>\n          \"cat\" 与谓语相隔 <span class=\"math-num\">7</span> 个词\n          <span class=\"math-comment\">// which, was, sitting, on, the, mat</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">关键信息:</span>\n          \"cat\" 是<span class=\"math-var\">单数</span>名词\n          <span class=\"math-comment\">// 决定谓语用 was 而非 were</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">LSTM 策略:</span>\n          在读到 \"cat\" 时，<span class=\"math-var\">i<sub>t</sub></span> ↑ 写入单数特征；\n          接下来 7 步，<span class=\"math-var\">f<sub>t</sub></span> ≈ <span class=\"math-num\">1</span> 保护该信息。\n        </div>\n        <div class=\"math-result\">\n          关键洞察：遗忘门不是\"遗忘\"的意思，而是\"保护\"的意思。f = 1 意味着完全保留。\n        </div>\n      </div>\n\n      <div class=\"timeline\" data-delay=\"100\">\n        <div class=\"timeline-item\" data-delay=\"0\">\n          <h4 class=\"timeline-title\">Step 1: 处理 \"The\"</h4>\n          <p class=\"timeline-text\">定冠词，语法功能词，语义信息量较小。LSTM 的响应：<span class=\"hl hl-amber\">输入门 i 较低（约 0.2）</span>，少量写入；<span class=\"hl hl-green\">遗忘门 f 较高（约 0.9）</span>，保留已有状态。</p>\n        </div>\n        <div class=\"timeline-item\" data-delay=\"100\">\n          <h4 class=\"timeline-title\">Step 2: 处理 \"cat\" [关键]</h4>\n          <p class=\"timeline-text\">核心主语，且携带关键语法特征：单数名词。LSTM 识别到这是重要信息，<span class=\"hl hl-cyan\">输入门 i 升高（约 0.8）</span>，将\"单数主语\"这一特征强力写入细胞状态 c<sub>t</sub>。</p>\n        </div>\n        <div class=\"timeline-item\" data-delay=\"200\">\n          <h4 class=\"timeline-title\">Step 3-8: 处理 \"which was sitting on the mat\"</h4>\n          <p class=\"timeline-text\">定语从句，对主句谓语的语法约束没有影响。LSTM 的策略：<span class=\"hl hl-green\">遗忘门 f 保持高位（约 0.95）</span>，\"单数主语\"信息被<span class=\"em em-green\">保护性地传递</span>；<span class=\"hl hl-amber\">输入门 i 较低</span>，避免定语从句的内容覆盖主句信息。</p>\n        </div>\n        <div class=\"timeline-item\" data-delay=\"300\">\n          <h4 class=\"timeline-title\">Step 9: 预测谓语动词 [关键]</h4>\n          <p class=\"timeline-text\">需要根据主语决定动词形式。此时<span class=\"hl hl-pink\">输出门 o 升高（约 0.9）</span>，将细胞状态中存储的\"单数主语\"信息取出，用于预测。最终正确预测：<span class=\"em em-purple\">\"was\"</span>（单数形式），而非 \"were\"。</p>\n        </div>\n      </div>\n\n      <div class=\"keyline\" data-delay=\"400\">\n        <div class=\"kdot\">*</div>\n        <div class=\"ktext\">核心机制：遗忘门在中间 6 个时间步保持接近 1，使得\"单数主语\"信息<span class=\"em em-green\">几乎无损地穿越定语从句</span>。输出门则在需要时精确地提取这一信息。</div>\n      </div>\n\n      <div class=\"callout\" data-delay=\"500\">\n        <div class=\"callout-head\"><div class=\"callout-title\">LSTM 的局限性</div><span class=\"tag\">Limitations</span></div>\n        <div class=\"callout-body\">\n          <ul>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(248,113,113,.2);border-color:rgba(248,113,113,.3);\">1</span><span><span class=\"hl hl-red\">顺序处理限制</span>：必须按时间顺序逐个处理 token，无法并行计算，训练效率受限</span></li>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(251,191,36,.2);border-color:rgba(251,191,36,.3);\">2</span><span><span class=\"hl hl-amber\">超长依赖仍有困难</span>：虽然比 RNN 好很多，但对于 1000+ token 的依赖，LSTM 仍然力不从心</span></li>\n            <li><span class=\"callout-bullet\" style=\"background:rgba(167,139,250,.2);border-color:rgba(167,139,250,.3);\">3</span><span><span class=\"hl hl-purple\">信息瓶颈</span>：所有历史信息最终仍压缩在固定维度的 c<sub>t</sub> 向量中，存在容量上限</span></li>\n          </ul>\n          <p style=\"margin-top:12px;\">这些问题后来分别被 <span class=\"em em-cyan\">Attention 机制</span>（解决信息瓶颈）和 <span class=\"em em-pink\">Transformer 架构</span>（解决并行计算）所解决。</p>\n        </div>\n      </div>\n\n      <div class=\"page-transition\" data-delay=\"600\">\n        <div class=\"page-transition-icon\">></div>\n        <div class=\"page-transition-text\">恭喜你完成了从 RNN 到 LSTM 的完整学习旅程。最后让我们<span class=\"em em-amber\">回顾整条推导链</span>，巩固所学内容。</div>\n      </div>\n    </div>"
    },
    {
      "id": "p-summary",
      "page": 10,
      "kind": "section",
      "accent": "amber",
      "dataTitle": "总结",
      "dataSub": "完整的推导链条",
      "className": "",
      "rawHtml": "<div class=\"page-inner\">\n      <nav class=\"page-chapters-nav\"></nav>\n      <div class=\"page-intro\" data-delay=\"0\">\n        <span class=\"page-intro-text\"><span class=\"typing-text\" data-text=\"从问题到解决方案的完整推导\"></span><span class=\"typing-cursor\"></span></span>\n      </div>\n      <span class=\"section-label\">CHAPTER 10</span>\n      <h2 class=\"section-title\">课程总结：完整的逻辑链条</h2>\n      <div class=\"prose\">\n        <p>让我们回顾从问题出发到解决方案的完整推导过程，这条逻辑链将帮助你真正理解 LSTM 的设计必然性。</p>\n      </div>\n\n      <div class=\"math-block\" data-delay=\"50\">\n        <div class=\"math-title\">核心公式回顾与对比</div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">RNN:</span>\n          $h_t = \\tanh(W_{hh} h_{t-1} + W_{xh} x_t)$\n          <span class=\"math-comment\">// 乘法传递，梯度消失</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">LSTM 细胞:</span>\n          $c_t = f_t \\odot c_{t-1}$ <span style=\"color:#6ee7b7;font-weight:bold;\">$+$</span> $i_t \\odot \\tilde{c}_t$\n          <span class=\"math-comment\">// 加法传递，梯度保持</span>\n        </div>\n        <div class=\"math-row\">\n          <span class=\"math-step\">梯度对比:</span>\n          RNN: $\\frac{\\partial h_t}{\\partial h_1} \\approx 0.9^t \\to 0$；\n          LSTM: $\\frac{\\partial c_t}{\\partial c_1} = \\prod f_k$，当 $f \\approx 1$ 时 $\\to 1$\n        </div>\n        <div class=\"math-result\">\n          设计哲学：不改变网络的表达能力，而是改变梯度的传播方式。\n        </div>\n      </div>\n\n      <!-- SVG: Learning Journey Diagram -->\n      <div class=\"diagram-container\" data-delay=\"80\">\n        <svg viewBox=\"0 0 800 140\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <defs>\n            <linearGradient id=\"journeyGrad1\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#667eea\"/><stop offset=\"100%\" stop-color=\"#764ba2\"/>\n            </linearGradient>\n            <linearGradient id=\"journeyGrad2\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#f093fb\"/><stop offset=\"100%\" stop-color=\"#f5576c\"/>\n            </linearGradient>\n            <linearGradient id=\"journeyGrad3\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stop-color=\"#34d399\"/><stop offset=\"100%\" stop-color=\"#4facfe\"/>\n            </linearGradient>\n            <marker id=\"journeyArrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"9\" refY=\"3\" orient=\"auto\" markerUnits=\"strokeWidth\">\n              <path d=\"M0,0 L0,6 L9,3 z\" fill=\"rgba(255,255,255,0.4)\"/>\n            </marker>\n          </defs>\n          <!-- Step 1: Problem -->\n          <g class=\"svg-fade d1\">\n            <rect x=\"30\" y=\"35\" width=\"140\" height=\"70\" rx=\"12\" fill=\"rgba(102,126,234,0.15)\" stroke=\"url(#journeyGrad1)\" stroke-width=\"2\"/>\n            <text x=\"100\" y=\"60\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"11\" font-weight=\"600\">序列三约束</text>\n            <text x=\"100\" y=\"80\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.6)\" font-size=\"9\">变长 · 顺序 · 远依赖</text>\n            <text x=\"100\" y=\"25\" text-anchor=\"middle\" fill=\"#a5b4fc\" font-size=\"10\">问题</text>\n          </g>\n          <!-- Arrow 1 -->\n          <path d=\"M170 70 L220 70\" stroke=\"rgba(255,255,255,0.3)\" stroke-width=\"2\" marker-end=\"url(#journeyArrow)\" class=\"svg-path d1\"/>\n          <!-- Step 2: RNN -->\n          <g class=\"svg-fade d2\">\n            <rect x=\"230\" y=\"35\" width=\"140\" height=\"70\" rx=\"12\" fill=\"rgba(240,147,251,0.15)\" stroke=\"url(#journeyGrad2)\" stroke-width=\"2\"/>\n            <text x=\"300\" y=\"55\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"11\" font-weight=\"600\">RNN 递归</text>\n            <text x=\"300\" y=\"75\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"9\">✓ 变长 ✓ 顺序</text>\n            <text x=\"300\" y=\"92\" text-anchor=\"middle\" fill=\"#f87171\" font-size=\"9\">✗ 梯度消失</text>\n            <text x=\"300\" y=\"25\" text-anchor=\"middle\" fill=\"#f9a8d4\" font-size=\"10\">突破</text>\n          </g>\n          <!-- Arrow 2 -->\n          <path d=\"M370 70 L420 70\" stroke=\"rgba(255,255,255,0.3)\" stroke-width=\"2\" marker-end=\"url(#journeyArrow)\" class=\"svg-path d2\"/>\n          <!-- Step 3: LSTM -->\n          <g class=\"svg-fade d3\">\n            <rect x=\"430\" y=\"35\" width=\"140\" height=\"70\" rx=\"12\" fill=\"rgba(52,211,153,0.15)\" stroke=\"url(#journeyGrad3)\" stroke-width=\"2\"/>\n            <text x=\"500\" y=\"55\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"11\" font-weight=\"600\">LSTM 加法门控</text>\n            <text x=\"500\" y=\"75\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"9\">✓ 变长 ✓ 顺序 ✓ 长依赖</text>\n            <text x=\"500\" y=\"92\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"9\">c<tspan baseline-shift=\"sub\" font-size=\"7\">t</tspan> = f·c<tspan baseline-shift=\"sub\" font-size=\"7\">t-1</tspan> + i·c̃</text>\n            <text x=\"500\" y=\"25\" text-anchor=\"middle\" fill=\"#6ee7b7\" font-size=\"10\">解决</text>\n          </g>\n          <!-- Arrow 3 -->\n          <path d=\"M570 70 L620 70\" stroke=\"rgba(255,255,255,0.3)\" stroke-width=\"2\" marker-end=\"url(#journeyArrow)\" class=\"svg-path d3\"/>\n          <!-- Future -->\n          <g class=\"svg-fade d4\">\n            <rect x=\"630\" y=\"35\" width=\"140\" height=\"70\" rx=\"12\" fill=\"rgba(255,255,255,0.03)\" stroke=\"rgba(255,255,255,0.15)\" stroke-width=\"1.5\" stroke-dasharray=\"4,3\"/>\n            <text x=\"700\" y=\"60\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.5)\" font-size=\"11\">Attention</text>\n            <text x=\"700\" y=\"80\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"9\">Transformer</text>\n            <text x=\"700\" y=\"25\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"10\">下一步</text>\n          </g>\n          <!-- Bottom annotation -->\n          <g class=\"svg-fade d5\">\n            <text x=\"400\" y=\"125\" text-anchor=\"middle\" fill=\"rgba(255,255,255,0.4)\" font-size=\"10\">从问题出发 → 理解失败 → 设计解决方案 → 持续演进</text>\n          </g>\n        </svg>\n      </div>\n\n      <div class=\"cards-grid\">\n        <div class=\"glass-card\" data-delay=\"0\">\n          <div class=\"card-icon purple\">1</div>\n          <h3 class=\"card-title\">第一幕：发现问题</h3>\n          <p class=\"card-text\">序列数据是个\"难搞的家伙\" 😤：长度不固定、顺序很敏感、还有超远距离的依赖关系。传统方法全都<span class=\"hl hl-purple\">败下阵来</span>。</p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"100\">\n          <div class=\"card-icon pink\">2</div>\n          <h3 class=\"card-title\">第二幕：英雄登场...然后倒下</h3>\n          <p class=\"card-text\">RNN 出场解决了变长和顺序问题，全场欢呼 🥳！但悲剧的是，它患上了<span class=\"hl hl-pink\">\"短期记忆症\"</span>——100步之前的事情，全忘了 😢</p>\n        </div>\n        <div class=\"glass-card\" data-delay=\"200\">\n          <div class=\"card-icon green\">3</div>\n          <h3 class=\"card-title\">第三幕：LSTM 王者归来</h3>\n          <p class=\"card-text\">关键洞察：× 变成 <span class=\"hl hl-green\">+</span> ！给神经网络修一条\"高速公路\"，信息可以无损通行，配合智能\"收费站\"（门控），完美收官 😎</p>\n        </div>\n      </div>\n\n      <div class=\"quote-box\" data-delay=\"300\">\n        <p class=\"quote-text\">🤔 \"理解一个模型，不在于背诵它的公式，而在于理解它<span class=\"em em-cyan\">解决了什么问题</span>、<span class=\"em em-amber\">为什么这样解决</span>、以及<span class=\"em em-pink\">还有什么问题没解决</span>。\"</p>\n        <p class=\"quote-author\">—— 深度学习研究方法论</p>\n      </div>\n\n      <div class=\"sticky-note orange\" data-delay=\"400\">\n        <div class=\"sticky-title\">😮 下一站：Attention 机制</div>\n        <p class=\"sticky-text\">LSTM 虽然解决了\"失忆症\"，但还是要一步一步走。想象一下，如果可以\"瞬移\"直接跳到任意位置呢？这就是 <b>Attention</b> 的魔法，也是 Transformer 的核心秘密！</p>\n      </div>\n\n      <div class=\"keyline\" data-delay=\"500\">\n        <div class=\"kdot\">+</div>\n        <div class=\"ktext\">恭喜你完成学习 🥳！现在你不仅知道 LSTM 的公式是什么，更重要的是理解了<span class=\"em em-amber\">为什么必须这样设计</span>。这种\"从问题出发推导解决方案\"的思维方式，是通往 AI 大师之路的关键 😎</div>\n      </div>\n    </div>"
    }
  ],
  "metadata": {
    "source": "chapter1.5html.html",
    "mode": "rawHtml-inner"
  }
}