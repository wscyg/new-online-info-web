<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿®å¤åçš„æœ¬åœ°åº“æµ‹è¯•</title>
    <!-- ç›´æ¥ä½¿ç”¨æœ¬åœ°åº“ï¼Œä¼˜å…ˆåŠ è½½CSS -->
    <link rel="stylesheet" href="/lib/katex/katex.min.css">
    <link rel="stylesheet" href="/lib/highlightjs/github-dark.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #f1f5f9;
            padding: 2rem;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            background: #1e293b;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #334155;
        }
        .status {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin: 0.5rem 0;
            font-weight: bold;
            display: inline-block;
        }
        .success { background: #22c55e; color: white; }
        .error { background: #ef4444; color: white; }
        .warning { background: #f59e0b; color: white; }
        .info { background: #06b6d4; color: white; }
        
        .interactive-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }
        .interactive-button:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .animation-test {
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            margin: 1rem auto;
            animation: spin 2s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .math-demo {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
        }

        .counter {
            font-size: 2rem;
            font-weight: bold;
            color: #06b6d4;
            text-align: center;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª ä¿®å¤åçš„æœ¬åœ°åº“åŠŸèƒ½æµ‹è¯•</h1>
        <p>ä¿®å¤äº†KaTeXå­—ä½“è·¯å¾„é—®é¢˜åçš„æµ‹è¯•é¡µé¢</p>

        <!-- 1. CSSåŠ¨ç”»æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ¨ 1. CSSåŠ¨ç”»æµ‹è¯•</h2>
            <p>å¦‚æœä½ çœ‹åˆ°ä¸‹é¢çš„åœ†åœˆåœ¨æ—‹è½¬ï¼Œè¯´æ˜CSSåŠ¨ç”»å·¥ä½œæ­£å¸¸ï¼š</p>
            <div class="animation-test"></div>
            <div id="css-status" class="status success">âœ… CSSåŠ¨ç”»æ­£å¸¸å·¥ä½œ</div>
        </div>

        <!-- 2. JavaScriptäº¤äº’æµ‹è¯• -->
        <div class="test-section">
            <h2>âš¡ 2. JavaScriptäº¤äº’æµ‹è¯•</h2>
            <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•JavaScriptäº¤äº’ï¼š</p>
            <button class="interactive-button" onclick="testInteraction()">ç‚¹å‡»æµ‹è¯•äº¤äº’</button>
            <button class="interactive-button" onclick="incrementCounter()">ç‚¹å‡»è®¡æ•°å™¨</button>
            <div class="counter" id="click-counter">0</div>
            <div id="interaction-result" style="margin-top: 1rem;"></div>
        </div>

        <!-- 3. ä»£ç é«˜äº®æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ¯ 3. ä»£ç é«˜äº®æµ‹è¯• (highlight.js)</h2>
            <div id="highlight-status" class="status info">æ­£åœ¨æµ‹è¯•...</div>
            <pre><code class="language-javascript" id="test-code">
function multiHeadAttention(query, key, value) {
    const numHeads = 8;
    const dModel = 512;
    const dK = dModel / numHeads;
    
    // åˆ†å¤´å¤„ç†
    const heads = [];
    for (let i = 0; i < numHeads; i++) {
        const head = attention(
            query.slice(i * dK, (i + 1) * dK),
            key.slice(i * dK, (i + 1) * dK),
            value.slice(i * dK, (i + 1) * dK)
        );
        heads.push(head);
    }
    
    // æ‹¼æ¥å¤šå¤´ç»“æœ
    return concat(heads).matmul(WO);
}
            </code></pre>
        </div>

        <!-- 4. æ•°å­¦å…¬å¼æµ‹è¯• -->
        <div class="test-section">
            <h2>ğŸ“ 4. æ•°å­¦å…¬å¼æµ‹è¯• (KaTeX)</h2>
            <div id="katex-status" class="status info">æ­£åœ¨æµ‹è¯•...</div>
            <div class="math-demo">
                <p>å¤šå¤´æ³¨æ„åŠ›å…¬å¼ï¼š</p>
                <div id="math-formula">
                    MultiHead(Q,K,V) = Concat(head_1, ..., head_h)W^O
                </div>
                <div id="math-formula-2">
                    head_i = Attention(QW_i^Q, KW_i^K, VW_i^V)
                </div>
            </div>
        </div>

        <!-- 5. ç»¼åˆæµ‹è¯•ç»“æœ -->
        <div class="test-section">
            <h2>ğŸ“Š 5. æµ‹è¯•æ€»ç»“</h2>
            <div id="test-summary"></div>
        </div>
    </div>

    <!-- JavaScriptåº“åŠ è½½ - é¡ºåºå¾ˆé‡è¦ -->
    <script src="/lib/highlightjs/highlight.min.js"></script>
    <script src="/lib/katex/katex.min.js"></script>
    <script src="/lib/katex/auto-render.min.js"></script>

    <script>
        // å…¨å±€å˜é‡
        let clickCount = 0;
        let testResults = {
            css: true, // CSSå·²ç»æ˜¾ç¤ºæ­£å¸¸
            javascript: false,
            highlight: false,
            katex: false
        };

        // JavaScriptäº¤äº’æµ‹è¯•
        function testInteraction() {
            const resultDiv = document.getElementById('interaction-result');
            try {
                resultDiv.innerHTML = '<div class="status success">âœ… JavaScriptäº¤äº’æ­£å¸¸ï¼ç‚¹å‡»æˆåŠŸ</div>';
                testResults.javascript = true;
                updateSummary();
                console.log('âœ… JavaScriptäº¤äº’æµ‹è¯•æˆåŠŸ');
            } catch (error) {
                resultDiv.innerHTML = '<div class="status error">âŒ JavaScriptäº¤äº’å¤±è´¥</div>';
                console.error('âŒ JavaScriptäº¤äº’æµ‹è¯•å¤±è´¥:', error);
            }
        }

        // è®¡æ•°å™¨æµ‹è¯•
        function incrementCounter() {
            try {
                clickCount++;
                document.getElementById('click-counter').textContent = clickCount;
                if (!testResults.javascript) {
                    testResults.javascript = true;
                    updateSummary();
                }
                console.log('âœ… è®¡æ•°å™¨åŠŸèƒ½æ­£å¸¸ï¼Œå½“å‰è®¡æ•°:', clickCount);
            } catch (error) {
                console.error('âŒ è®¡æ•°å™¨åŠŸèƒ½å¤±è´¥:', error);
            }
        }

        // æµ‹è¯•ä»£ç é«˜äº®
        function testHighlight() {
            const statusDiv = document.getElementById('highlight-status');
            
            try {
                if (typeof hljs !== 'undefined') {
                    hljs.highlightAll();
                    statusDiv.className = 'status success';
                    statusDiv.textContent = 'âœ… ä»£ç é«˜äº®æ­£å¸¸å·¥ä½œ';
                    testResults.highlight = true;
                    console.log('âœ… highlight.js å·¥ä½œæ­£å¸¸');
                } else {
                    throw new Error('hljs æœªå®šä¹‰');
                }
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = 'âŒ ä»£ç é«˜äº®å‡ºé”™: ' + error.message;
                console.error('âŒ highlight.js æµ‹è¯•å¤±è´¥:', error);
            }
            updateSummary();
        }

        // æµ‹è¯•æ•°å­¦å…¬å¼æ¸²æŸ“
        function testKaTeX() {
            const statusDiv = document.getElementById('katex-status');
            
            try {
                if (typeof katex !== 'undefined') {
                    // æ¸²æŸ“ç¬¬ä¸€ä¸ªå…¬å¼
                    katex.render('\\text{MultiHead}(Q,K,V) = \\text{Concat}(\\text{head}_1, \\ldots, \\text{head}_h)W^O', 
                                document.getElementById('math-formula'));
                    
                    // æ¸²æŸ“ç¬¬äºŒä¸ªå…¬å¼
                    katex.render('\\text{head}_i = \\text{Attention}(QW_i^Q, KW_i^K, VW_i^V)', 
                                document.getElementById('math-formula-2'));
                    
                    statusDiv.className = 'status success';
                    statusDiv.textContent = 'âœ… æ•°å­¦å…¬å¼æ¸²æŸ“æ­£å¸¸';
                    testResults.katex = true;
                    console.log('âœ… KaTeX å·¥ä½œæ­£å¸¸');
                } else {
                    throw new Error('katex æœªå®šä¹‰');
                }
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = 'âŒ KaTeX æ¸²æŸ“å‡ºé”™: ' + error.message;
                console.error('âŒ KaTeX æµ‹è¯•å¤±è´¥:', error);
            }
            updateSummary();
        }

        // æ›´æ–°æµ‹è¯•æ€»ç»“
        function updateSummary() {
            const summaryDiv = document.getElementById('test-summary');
            const total = Object.keys(testResults).length;
            const passed = Object.values(testResults).filter(r => r).length;
            
            let html = `<h3>æµ‹è¯•ç»“æœï¼š${passed}/${total} é¡¹é€šè¿‡</h3>`;
            
            const testNames = {
                css: 'CSSæ ·å¼å’ŒåŠ¨ç”»',
                javascript: 'JavaScriptäº¤äº’',
                highlight: 'ä»£ç é«˜äº® (highlight.js)',
                katex: 'æ•°å­¦å…¬å¼ (KaTeX)'
            };

            for (const [test, result] of Object.entries(testResults)) {
                const status = result ? 'success' : 'error';
                const icon = result ? 'âœ…' : 'âŒ';
                html += `<div class="status ${status}">${icon} ${testNames[test]}</div>`;
            }

            if (passed === total) {
                html += '<div class="status success" style="margin-top: 1rem;">ğŸ‰ æ‰€æœ‰åŠŸèƒ½æ­£å¸¸ï¼æœ¬åœ°åº“å·¥ä½œå®Œç¾ï¼</div>';
            } else {
                html += '<div class="status warning" style="margin-top: 1rem;">âš ï¸ éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥åº“æ–‡ä»¶å’Œå­—ä½“è·¯å¾„</div>';
            }

            summaryDiv.innerHTML = html;
        }

        // é”™è¯¯å¤„ç†
        window.addEventListener('error', function(event) {
            console.error('é¡µé¢é”™è¯¯:', event.message, 'at', event.filename + ':' + event.lineno);
        });

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œæµ‹è¯•
        window.addEventListener('load', function() {
            console.log('ğŸš€ é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹æµ‹è¯•...');
            
            setTimeout(() => {
                testHighlight();
                testKaTeX();
                
                // æ˜¾ç¤ºåº“åŠ è½½çŠ¶æ€
                console.log('åº“åŠ è½½çŠ¶æ€:');
                console.log('- hljs:', typeof hljs !== 'undefined' ? 'âœ… å·²åŠ è½½' : 'âŒ æœªåŠ è½½');
                console.log('- katex:', typeof katex !== 'undefined' ? 'âœ… å·²åŠ è½½' : 'âŒ æœªåŠ è½½');
                console.log('- renderMathInElement:', typeof renderMathInElement !== 'undefined' ? 'âœ… å·²åŠ è½½' : 'âŒ æœªåŠ è½½');
                
            }, 500);
        });
    </script>
</body>
</html>