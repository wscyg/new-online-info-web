<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScriptäº¤äº’è°ƒè¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #f1f5f9;
            padding: 2rem;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            background: #1e293b;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #334155;
        }
        .button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin: 0.5rem;
            transition: all 0.3s ease;
        }
        .button:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }
        .status {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin: 0.5rem 0;
            font-weight: bold;
            display: inline-block;
        }
        .success { background: #22c55e; color: white; }
        .error { background: #ef4444; color: white; }
        .warning { background: #f59e0b; color: white; }
        .info { background: #06b6d4; color: white; }
        
        .debug-log {
            background: #0f172a;
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .counter {
            font-size: 2rem;
            font-weight: bold;
            color: #06b6d4;
            text-align: center;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” JavaScriptäº¤äº’é—®é¢˜è°ƒè¯•</h1>
        
        <!-- åŸºç¡€JavaScriptæµ‹è¯• -->
        <div class="test-section">
            <h2>1. åŸºç¡€JavaScriptæµ‹è¯•</h2>
            <div id="basic-js-status"></div>
            <button class="button" onclick="testBasicJS()">æµ‹è¯•åŸºç¡€JS</button>
            <button class="button" onclick="testAlert()">æµ‹è¯•å¼¹çª—</button>
            <div id="basic-result"></div>
        </div>

        <!-- DOMæ“ä½œæµ‹è¯• -->
        <div class="test-section">
            <h2>2. DOMæ“ä½œæµ‹è¯•</h2>
            <div id="dom-status"></div>
            <button class="button" onclick="testDOM()">æµ‹è¯•DOMæ“ä½œ</button>
            <div id="dom-result">è¿™é‡Œçš„æ–‡å­—å°†ä¼šè¢«ä¿®æ”¹</div>
        </div>

        <!-- äº‹ä»¶å¤„ç†æµ‹è¯• -->
        <div class="test-section">
            <h2>3. äº‹ä»¶å¤„ç†æµ‹è¯•</h2>
            <div id="event-status"></div>
            <button class="button" id="event-test-btn">æµ‹è¯•äº‹ä»¶ç»‘å®š</button>
            <div class="counter" id="click-counter">0</div>
            <div>ç‚¹å‡»æ¬¡æ•°è®¡æ•°å™¨</div>
        </div>

        <!-- å¼‚æ­¥æ“ä½œæµ‹è¯• -->
        <div class="test-section">
            <h2>4. å¼‚æ­¥æ“ä½œæµ‹è¯•</h2>
            <div id="async-status"></div>
            <button class="button" onclick="testAsync()">æµ‹è¯•å¼‚æ­¥æ“ä½œ</button>
            <div id="async-result"></div>
        </div>

        <!-- åº“æ–‡ä»¶åŠ è½½æµ‹è¯• -->
        <div class="test-section">
            <h2>5. å¤–éƒ¨åº“åŠ è½½æµ‹è¯•</h2>
            <div id="lib-status"></div>
            <button class="button" onclick="testLibraries()">æ£€æŸ¥åº“çŠ¶æ€</button>
        </div>

        <!-- é”™è¯¯æ—¥å¿— -->
        <div class="test-section">
            <h2>6. é”™è¯¯æ—¥å¿—</h2>
            <div class="debug-log" id="error-log">ç­‰å¾…é”™è¯¯ä¿¡æ¯...</div>
            <button class="button" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
        </div>

        <!-- æµè§ˆå™¨ä¿¡æ¯ -->
        <div class="test-section">
            <h2>7. æµè§ˆå™¨ç¯å¢ƒä¿¡æ¯</h2>
            <div id="browser-info"></div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let clickCount = 0;
        let errorLog = [];

        // é”™è¯¯æ•è·
        window.addEventListener('error', function(event) {
            const errorMsg = `JSé”™è¯¯: ${event.message} (${event.filename}:${event.lineno})`;
            logError(errorMsg);
        });

        window.addEventListener('unhandledrejection', function(event) {
            const errorMsg = `æœªå¤„ç†çš„Promiseæ‹’ç»: ${event.reason}`;
            logError(errorMsg);
        });

        function logError(message) {
            errorLog.push(`[${new Date().toLocaleTimeString()}] ${message}`);
            updateErrorLog();
        }

        function updateErrorLog() {
            const logDiv = document.getElementById('error-log');
            if (errorLog.length === 0) {
                logDiv.textContent = 'æš‚æ— é”™è¯¯ä¿¡æ¯';
            } else {
                logDiv.textContent = errorLog.join('\n');
            }
        }

        function clearLog() {
            errorLog = [];
            updateErrorLog();
        }

        // æµ‹è¯•å‡½æ•°
        function testBasicJS() {
            const statusDiv = document.getElementById('basic-js-status');
            const resultDiv = document.getElementById('basic-result');
            
            try {
                // åŸºç¡€è¿ç®—
                const result = 2 + 2;
                statusDiv.innerHTML = '<div class="status success">âœ… åŸºç¡€JavaScriptè¿è¡Œæ­£å¸¸</div>';
                resultDiv.innerHTML = `<div class="status info">è®¡ç®—ç»“æœ: 2 + 2 = ${result}</div>`;
                return true;
            } catch (error) {
                statusDiv.innerHTML = '<div class="status error">âŒ åŸºç¡€JavaScriptå‡ºé”™</div>';
                logError('åŸºç¡€JSæµ‹è¯•å¤±è´¥: ' + error.message);
                return false;
            }
        }

        function testAlert() {
            try {
                alert('JavaScriptå¼¹çª—æµ‹è¯•æˆåŠŸï¼');
                document.getElementById('basic-js-status').innerHTML += '<div class="status success">âœ… å¼¹çª—åŠŸèƒ½æ­£å¸¸</div>';
            } catch (error) {
                logError('å¼¹çª—æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }

        function testDOM() {
            const statusDiv = document.getElementById('dom-status');
            const resultDiv = document.getElementById('dom-result');
            
            try {
                // ä¿®æ”¹DOMå†…å®¹
                resultDiv.textContent = `DOMæ“ä½œæˆåŠŸï¼æ—¶é—´: ${new Date().toLocaleTimeString()}`;
                resultDiv.style.color = '#22c55e';
                resultDiv.style.fontWeight = 'bold';
                
                statusDiv.innerHTML = '<div class="status success">âœ… DOMæ“ä½œæ­£å¸¸</div>';
                return true;
            } catch (error) {
                statusDiv.innerHTML = '<div class="status error">âŒ DOMæ“ä½œå¤±è´¥</div>';
                logError('DOMæµ‹è¯•å¤±è´¥: ' + error.message);
                return false;
            }
        }

        function testAsync() {
            const statusDiv = document.getElementById('async-status');
            const resultDiv = document.getElementById('async-result');
            
            statusDiv.innerHTML = '<div class="status info">â³ æ‰§è¡Œå¼‚æ­¥æ“ä½œ...</div>';
            
            setTimeout(() => {
                try {
                    resultDiv.innerHTML = '<div class="status success">âœ… å¼‚æ­¥æ“ä½œå®Œæˆï¼</div>';
                    statusDiv.innerHTML = '<div class="status success">âœ… å¼‚æ­¥æ“ä½œæ­£å¸¸</div>';
                } catch (error) {
                    statusDiv.innerHTML = '<div class="status error">âŒ å¼‚æ­¥æ“ä½œå¤±è´¥</div>';
                    logError('å¼‚æ­¥æµ‹è¯•å¤±è´¥: ' + error.message);
                }
            }, 1000);
        }

        function testLibraries() {
            const statusDiv = document.getElementById('lib-status');
            let html = '<h3>åº“åŠ è½½çŠ¶æ€:</h3>';

            // æ£€æŸ¥highlight.js
            if (typeof hljs !== 'undefined') {
                html += '<div class="status success">âœ… highlight.js å·²åŠ è½½</div>';
            } else {
                html += '<div class="status error">âŒ highlight.js æœªåŠ è½½</div>';
            }

            // æ£€æŸ¥KaTeX
            if (typeof katex !== 'undefined') {
                html += '<div class="status success">âœ… KaTeX å·²åŠ è½½</div>';
            } else {
                html += '<div class="status error">âŒ KaTeX æœªåŠ è½½</div>';
            }

            // æ£€æŸ¥auto-render
            if (typeof renderMathInElement !== 'undefined') {
                html += '<div class="status success">âœ… KaTeX auto-render å·²åŠ è½½</div>';
            } else {
                html += '<div class="status error">âŒ KaTeX auto-render æœªåŠ è½½</div>';
            }

            statusDiv.innerHTML = html;
        }

        // äº‹ä»¶ç»‘å®šæµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            const eventBtn = document.getElementById('event-test-btn');
            const counter = document.getElementById('click-counter');
            const statusDiv = document.getElementById('event-status');

            if (eventBtn && counter) {
                eventBtn.addEventListener('click', function() {
                    try {
                        clickCount++;
                        counter.textContent = clickCount;
                        statusDiv.innerHTML = '<div class="status success">âœ… äº‹ä»¶å¤„ç†æ­£å¸¸</div>';
                    } catch (error) {
                        statusDiv.innerHTML = '<div class="status error">âŒ äº‹ä»¶å¤„ç†å¤±è´¥</div>';
                        logError('äº‹ä»¶å¤„ç†å¤±è´¥: ' + error.message);
                    }
                });

                statusDiv.innerHTML = '<div class="status info">âœ… äº‹ä»¶ç›‘å¬å™¨å·²ç»‘å®šï¼Œç‚¹å‡»æŒ‰é’®æµ‹è¯•</div>';
            } else {
                statusDiv.innerHTML = '<div class="status error">âŒ æ— æ³•æ‰¾åˆ°æµ‹è¯•æŒ‰é’®</div>';
                logError('äº‹ä»¶ç»‘å®šå¤±è´¥ï¼šæ‰¾ä¸åˆ°æŒ‰é’®å…ƒç´ ');
            }

            // æ˜¾ç¤ºæµè§ˆå™¨ä¿¡æ¯
            showBrowserInfo();
            
            // è¿è¡Œåˆå§‹æµ‹è¯•
            testBasicJS();
        });

        function showBrowserInfo() {
            const infoDiv = document.getElementById('browser-info');
            const info = {
                userAgent: navigator.userAgent,
                language: navigator.language,
                platform: navigator.platform,
                cookieEnabled: navigator.cookieEnabled,
                javaEnabled: typeof navigator.javaEnabled === 'function' ? navigator.javaEnabled() : 'N/A',
                screen: `${screen.width}x${screen.height}`,
                colorDepth: screen.colorDepth,
                pixelDepth: screen.pixelDepth,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                jsEnabled: true
            };

            let html = '<table style="width: 100%; color: #f1f5f9;">';
            for (const [key, value] of Object.entries(info)) {
                html += `<tr><td style="padding: 0.5rem; border-bottom: 1px solid #374151;"><strong>${key}:</strong></td><td style="padding: 0.5rem; border-bottom: 1px solid #374151;">${value}</td></tr>`;
            }
            html += '</table>';

            infoDiv.innerHTML = html;
        }
    </script>

    <!-- å°è¯•åŠ è½½æœ¬åœ°åº“ -->
    <script src="/lib/highlightjs/highlight.min.js" onerror="logError('highlight.js åŠ è½½å¤±è´¥')"></script>
    <script src="/lib/katex/katex.min.js" onerror="logError('katex.js åŠ è½½å¤±è´¥')"></script>
    <script src="/lib/katex/auto-render.min.js" onerror="logError('auto-render.js åŠ è½½å¤±è´¥')"></script>
</body>
</html>